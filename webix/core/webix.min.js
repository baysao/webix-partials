define([],function webix_core(){return window.webix||(webix={}),webix.assert=function(e,t){e||webix.assert_error(t)},webix.assert_config=function(e){var t=e.cells||e.rows||e.elements||e.cols;if(t)for(var i=0;i<t.length;i++)null!==t[i]&&void 0!==t[i]||webix.assert_error("You have trailing comma or Null element in collection's configuration")},webix.assert_error=function(e){webix.log("error",e),webix.message&&"string"==typeof e&&webix.message({type:"debug",text:e,expire:-1}),webix.debug},webix.assert_core_ready=function(){window.webix_on_core_ready&&window.webix_on_core_ready()},webix.assert_level=0,webix.assert_level_in=function(){100==++webix.assert_level&&webix.assert_error("Attempt to copy object with self reference")},webix.assert_level_out=function(){webix.assert_level--},webix.version="4.4.5",webix.codebase="./",webix.name="core",webix.cdn="//cdn.webix.com",webix.clone=function(e){var t=webix.clone._function;return t.prototype=e,new t},webix.clone._function=function(){},webix.extend=function(e,t,i){if(webix.assert(e,"Invalid mixing target"),webix.assert(t,"Invalid mixing source"),e.$protoWait)return webix.PowerArray.insertAt.call(e.$protoWait,t,1),e;for(var n in t)n in e&&!i||(e[n]=t[n]);return t.defaults&&webix.extend(e.defaults,t.defaults),t.$init&&t.$init.call(e),e},webix.copy=function(e){webix.assert(e,"Invalid mixing target"),webix.assert_level_in();var t;arguments.length>1?(t=arguments[0],e=arguments[1]):t=webix.isArray(e)?[]:{};for(var i in e){var n=e[i];!n||"object"!=typeof n||n instanceof RegExp?t[i]=n:webix.isDate(n)?t[i]=new Date(n):(t[i]=webix.isArray(n)?[]:{},webix.copy(t[i],n))}return webix.assert_level_out(),t},webix.single=function(e){var t=null;return function(i){return t||(t=new e({})),t._reinit&&t._reinit.apply(t,arguments),t}},webix.protoUI=function(){webix.debug_proto&&webix.log("UI registered: "+arguments[0].name);var e=arguments,t=e[0].name,i=function(e){if(!i)return webix.ui[t].prototype;var n=i.$protoWait;if(n){for(var s=[n[0]],r=1;r<n.length;r++)s[r]=n[r],s[r].$protoWait&&(s[r]=s[r].call(webix,s[r].name)),s[r].prototype&&s[r].prototype.name&&(webix.ui[s[r].prototype.name]=s[r]);if(webix.ui[t]=webix.proto.apply(webix,s),i._webix_type_wait)for(var r=0;r<i._webix_type_wait.length;r++)webix.type(webix.ui[t],i._webix_type_wait[r]);i=n=null}return this!=webix?new webix.ui[t](e):webix.ui[t]};return i.$protoWait=Array.prototype.slice.call(arguments,0),webix.ui[t]=i},webix.proto=function(){webix.debug_proto&&webix.log("Proto chain:"+arguments[0].name+"["+arguments.length+"]");var e=arguments,t=e[0],i=!!t.$init,n=[];webix.assert(t,"Invalid mixing target");for(var s=e.length-1;s>0;s--){if(webix.assert(e[s],"Invalid mixing source"),"function"==typeof e[s]&&(e[s]=e[s].prototype),e[s].$init&&n.push(e[s].$init),e[s].defaults){var r=e[s].defaults;t.defaults||(t.defaults={});for(var a in r)webix.isUndefined(t.defaults[a])&&(t.defaults[a]=r[a])}if(e[s].type&&t.type)for(var a in e[s].type)t.type[a]||(t.type[a]=e[s].type[a]);for(var o in e[s])t[o]||!1===t[o]||(t[o]=e[s][o])}i&&n.push(t.$init),t.$init=function(){for(var e=0;e<n.length;e++)n[e].apply(this,arguments)},t.$skin&&t.$skin();var l=function(e){this.$ready=[],webix.assert(this.$init,"object without init method"),this.$init(e),this._parseSettings&&this._parseSettings(e,this.defaults);for(var t=0;t<this.$ready.length;t++)this.$ready[t].call(this)};return l.prototype=t,t=e=null,l},webix.bind=function(e,t){return function(){return e.apply(t,arguments)}},webix.require=function(e,t,i){var n=webix.promise.defer();if(t&&!0!==t&&(n=n.then(function(){t.call(i||this)})),webix.require.disabled)return n.resolve(),n;if("string"==typeof e){if(!0!==webix._modules[e]){var s=e;if(e.toString().match(/^([a-z]+\:)*\/\//i)||(s=webix.codebase+e),".css"==e.substr(e.length-4)){var r=webix.html.create("LINK",{type:"text/css",rel:"stylesheet",href:s});return document.getElementsByTagName("head")[0].appendChild(r),n.resolve(),n}!0===t?(webix.exec(webix.ajax().sync().get(s).responseText),webix._modules[e]=!0):webix._modules[e]?webix._modules[e].push(n):(webix._modules[e]=[n],webix.ajax(s,function(t){webix.exec(t);var i=webix._modules[e];webix._modules[e]=!0;for(var n=0;n<i.length;n++)i[n].resolve()}))}else n.resolve();return n}var a=e.length||0;if(a){var o=function(){a?(a--,webix.require(e[e.length-a-1],o,i)):n.resolve()};o()}else{for(var l in e)a++;var o=function(){0===--a&&n.resolve()};for(var l in e)webix.require(l,o,i)}},webix._modules={},webix.exec=function(e){window.execScript?window.execScript(e):window.eval(e)},webix.wrap=function(e,t){return e?function(){var i=e.apply(this,arguments);return t.apply(this,arguments),i}:t},webix.isUndefined=function(e){return void 0===e},webix.delay=function(e,t,i,n){return window.setTimeout(function(){if(!t||!t.$destructed){var n=e.apply(t,i||[]);return e=t=i=null,n}},n||1)},webix.once=function(e){var t=!0;return function(){t&&(t=!1,e.apply(this,arguments))}},webix.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),++this._seed},webix.toNode=function(e){return"string"==typeof e?document.getElementById(e):e},webix.toArray=function(e){return webix.extend(e||[],webix.PowerArray,!0)},webix.toFunctor=function(str,scope){if("string"==typeof str){var method=str.replace("()","");return scope&&scope[method]?scope[method]:window[method]||eval(str)}return str},webix.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},webix.isDate=function(e){return e instanceof Date},webix.stringify=function(e){var t=Date.prototype.toJSON;Date.prototype.toJSON=function(){return webix.i18n.parseFormatStr(this)};var i;return i=e instanceof Date?e.toJSON():JSON.stringify(e),Date.prototype.toJSON=t,i},webix._events={},webix._event=function(e,t,i,n){n=n||{},n.inner=!0,webix.event(e,t,i,n)},webix.event=function(e,t,i,n){n=n||{},e=webix.toNode(e),webix.assert(e,"Invalid node as target for webix.event");var s=n.id||webix.uid();n.bind&&(i=webix.bind(i,n.bind));var r=[e,t,i,n.capture];return n.inner||(webix._events[s]=r),e.addEventListener?e.addEventListener(t,i,!!n.capture):e.attachEvent&&e.attachEvent("on"+t,r[2]=function(){return i.apply(e,arguments)}),s},webix.eventRemove=function(e){if(e){webix.assert(this._events[e],"Removing non-existing event");var t=webix._events[e];t[0].removeEventListener?t[0].removeEventListener(t[1],t[2],!!t[3]):t[0].detachEvent&&t[0].detachEvent("on"+t[1],t[2]),delete this._events[e]}},webix.log=function(e,t,i){1==arguments.length&&(t=e,e="log"),window.console&&window.console.log&&(e=e.toLowerCase(),window.console[e]?window.console[e](t||"unknown error"):window.console.log(e+": "+t),i&&window.console.log(i))},webix.log_full_time=function(e){webix._start_time_log=new Date,webix.log("Timing start ["+e+"]"),window.setTimeout(function(){var t=new Date;webix.log("Timing end ["+e+"]:"+(t.valueOf()-webix._start_time_log.valueOf())/1e3+"s")},1)},webix.log_time=function(e){var t="_start_time_log"+e;if(webix[t]){var i=new Date;webix.log("Info","Timing end ["+e+"]:"+(i.valueOf()-webix[t].valueOf())/1e3+"s"),webix[t]=null}else webix[t]=new Date,webix.log("Info","Timing start ["+e+"]")},webix.debug_code=function(e){e.call(webix)},webix.EventSystem={$init:function(){this._evs_events||(this._evs_events={},this._evs_handlers={},this._evs_map={})},blockEvent:function(){this._evs_events._block=!0},unblockEvent:function(){this._evs_events._block=!1},mapEvent:function(e){webix.extend(this._evs_map,e,!0)},on_setter:function(e){if(e)for(var t in e){var i=webix.toFunctor(e[t],this.$scope),n=t.indexOf("->");-1!==n?this[t.substr(0,n)].attachEvent(t.substr(n+2),webix.bind(i,this)):this.attachEvent(t,i)}},callEvent:function(e,t){if(this._evs_events._block)return!0;e=e.toLowerCase();var i=this._evs_events[e.toLowerCase()],n=!0;if(webix.log&&(!webix.debug&&!this.debug||webix.debug_blacklist[e]||webix.log("info","["+this.name+"@"+(this._settings||{}).id+"] event:"+e,t)),i)for(var s=0;s<i.length;s++)!1===i[s].apply(this,t||[])&&(n=!1);if(this._evs_map[e]){var r=this._evs_map[e];r.$eventSource=this,r.callEvent(e,t)||(n=!1),r.$eventSource=null}return n},attachEvent:function(e,t,i){webix.assert(t,"Invalid event handler for "+e),e=e.toLowerCase(),i=i||webix.uid(),t=webix.toFunctor(t,this.$scope);var n=this._evs_events[e]||webix.toArray();return arguments[3]?n.unshift(t):n.push(t),this._evs_events[e]=n,this._evs_handlers[i]={f:t,t:e},i},detachEvent:function(e){if(!this._evs_handlers[e]){var t=(e+"").toLowerCase();return void(this._evs_events[t]&&(this._evs_events[t]=webix.toArray()))}var i=this._evs_handlers[e].t,n=this._evs_handlers[e].f;this._evs_events[i].remove(n),delete this._evs_handlers[e]},hasEvent:function(e){e=e.toLowerCase();var t=this._evs_events[e];if(t&&t.length)return!0;var i=this._evs_map[e];return!!i&&i.hasEvent(e)}},webix.extend(webix,webix.EventSystem,!0),webix.PowerArray={removeAt:function(e,t){e>=0&&this.splice(e,t||1)},remove:function(e){this.removeAt(this.find(e))},insertAt:function(e,t){if(t||0===t){var i=this.splice(t,this.length-t);this[t]=e,this.push.apply(this,i)}else this.push(e)},find:function(e){for(var t=0;t<this.length;t++)if(e==this[t])return t;return-1},each:function(e,t){for(var i=0;i<this.length;i++)e.call(t||this,this[i])},map:function(e,t){for(var i=0;i<this.length;i++)this[i]=e.call(t||this,this[i]);return this},filter:function(e,t){for(var i=0;i<this.length;i++)e.call(t||this,this[i])||(this.splice(i,1),i--);return this}},webix.env={},function(){webix.env.strict=!!window.webix_strict,webix.env.https="https:"===document.location.protocol;var e=navigator.userAgent;if(-1==e.indexOf("Mobile")&&-1==e.indexOf("Windows Phone")||(webix.env.mobile=!0),(webix.env.mobile||-1!=e.indexOf("iPad")||-1!=e.indexOf("Android"))&&(webix.env.touch=!0),-1!=e.indexOf("Opera"))webix.env.isOpera=!0;else{if(webix.env.isIE=!!document.all||-1!==e.indexOf("Trident"),webix.env.isIE){8==parseFloat(navigator.appVersion.split("MSIE")[1])&&(webix.env.isIE8=!0)}webix.env.isEdge=-1!=e.indexOf("Edge"),webix.env.isFF=-1!=e.indexOf("Firefox"),webix.env.isWebKit=-1!=e.indexOf("KHTML"),webix.env.isSafari=webix.env.isWebKit&&-1!=e.indexOf("Mac")&&-1==e.indexOf("Chrome"),(webix.env.isIE||webix.env.isEdge||webix.env.isFF)&&(webix.env.maxHTMLElementSize=1e7),webix.env.isSafari&&(webix.env.maxHTMLElementSize=1e8)}-1!=e.toLowerCase().indexOf("android")&&(webix.env.isAndroid=!0,e.toLowerCase().indexOf("trident")&&(webix.env.isAndroid=!1,webix.env.isIEMobile=!0)),webix.env.transform=!1,webix.env.transition=!1;for(var t=-1,i=["","webkit","Moz","O","ms"],n=["","-webkit-","-Moz-","-o-","-ms-"],s=document.createElement("DIV"),r=0;r<i.length;r++){var a=i[r]?i[r]+"Transform":"transform";if(void 0!==s.style[a]){t=r;break}}if(t>-1){webix.env.cssPrefix=n[t];var o=webix.env.jsPrefix=i[t];webix.env.transform=o?o+"Transform":"transform",webix.env.transition=o?o+"Transition":"transition",webix.env.transitionDuration=o?o+"TransitionDuration":"transitionDuration",s.style[webix.env.transform]="translate3d(0,0,0)",webix.env.translate=s.style[webix.env.transform]?"translate3d":"translate",webix.env.transitionEnd="-Moz-"==webix.env.cssPrefix?"transitionend":o?o+"TransitionEnd":"transitionend"}webix.env.pointerevents=!webix.env.isIE||null!==new RegExp("Trident/.*rv:11").exec(e)}(),webix.env.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}(),webix.env.svganimation=function(){return document.implementation.hasFeature("https://www.w3.org/TR/SVG11/feature#SVG-animation","1.1")}(),webix.html={_native_on_selectstart:0,_style_element:{},denySelect:function(){webix._native_on_selectstart||(webix._native_on_selectstart=document.onselectstart),document.onselectstart=webix.html.stopEvent},allowSelect:function(){0!==webix._native_on_selectstart&&(document.onselectstart=webix._native_on_selectstart||null),webix._native_on_selectstart=0},index:function(e){for(var t=0;e=e.previousSibling;)t++;return t},_style_cache:{},createCss:function(e,t){var i="";t=t||"";for(var n in e)i+=n+":"+e[n]+";";var s=this._style_cache[i+t];return s||(s="s"+webix.uid(),this.addStyle("."+s+(t||"")+"{"+i+"}"),this._style_cache[i+t]=s),s},addStyle:function(e,t){var i=t?this._style_element[t]:this._style_element.default;i||(i=document.createElement("style"),i.setAttribute("type","text/css"),i.setAttribute("media","screen,print"),document.getElementsByTagName("head")[0].appendChild(i),t?this._style_element[t]=i:this._style_element.default=i),i.styleSheet?i.styleSheet.cssText+=e:i.appendChild(document.createTextNode(e))},removeStyle:function(e){var t=this._style_element[e||"default"];t&&(t.innerHTML="")},create:function(e,t,i){t=t||{};var n=document.createElement(e);for(var s in t)n.setAttribute(s,t[s]);return t.style&&(n.style.cssText=t.style),t.class&&(n.className=t.class),i&&(n.innerHTML=i),n},getValue:function(e){return e=webix.toNode(e),e?webix.isUndefined(e.value)?e.innerHTML:e.value:""},remove:function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.remove(e[t]);else e&&e.parentNode&&e.parentNode.removeChild(e)},insertBefore:function(e,t,i){e&&(t&&t.parentNode?t.parentNode.insertBefore(e,t):i.appendChild(e))},locate:function(e,t){var i;for(e.tagName?i=e:(e=e||event,i=e.target||e.srcElement);i;){if(i.getAttribute){var n=i.getAttribute(t);if(n)return n}i=i.parentNode}return null},offset:function(e){if(e.getBoundingClientRect){var t=e.getBoundingClientRect(),i=document.body,n=document.documentElement,s=window.pageYOffset||n.scrollTop||i.scrollTop,r=window.pageXOffset||n.scrollLeft||i.scrollLeft,a=n.clientTop||i.clientTop||0,o=n.clientLeft||i.clientLeft||0,l=t.top+s-a,h=t.left+r-o;return{y:Math.round(l),x:Math.round(h),width:e.offsetWidth,height:e.offsetHeight}}for(var l=0,h=0;e;)l+=parseInt(e.offsetTop,10),h+=parseInt(e.offsetLeft,10),e=e.offsetParent;return{y:l,x:h,width:e.offsetHeight,height:e.offsetWidth}},posRelative:function(e){return e=e||event,webix.isUndefined(e.offsetX)?{x:e.layerX,y:e.layerY}:{x:e.offsetX,y:e.offsetY}},pos:function(e){if(e=e||event,e.touches&&e.touches[0]&&(e=e.touches[0]),e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};var t=webix.env.isIE&&"BackCompat"!=document.compatMode?document.documentElement:document.body;return{x:e.clientX+t.scrollLeft-t.clientLeft,y:e.clientY+t.scrollTop-t.clientTop}},preventEvent:function(e){return e&&e.preventDefault&&e.preventDefault(),e&&(e.returnValue=!1),webix.html.stopEvent(e)},stopEvent:function(e){return e=e||event,e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,!1},triggerEvent:function(e,t,i){if(document.createEventObject){var n=document.createEventObject();e.fireEvent&&e.fireEvent("on"+i,n)}else{var n=document.createEvent(t);n.initEvent(i,!0,!0),e.dispatchEvent&&e.dispatchEvent(n)}},addCss:function(e,t,i){i&&-1!==e.className.indexOf(t)||(e.className+=" "+t)},removeCss:function(e,t){e.className=e.className.replace(RegExp(" "+t,"g"),"")},getTextSize:function(e,t,i){var n=webix.html.create("DIV",{class:"webix_view webix_measure_size "+(t||"")},"");n.style.cssText="height:auto;visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;"+(i?"width:"+i+"px;":"width:auto;white-space:nowrap;"),document.body.appendChild(n);for(var s="object"!=typeof e?[e]:e,i=0,r=0,a=0;a<s.length;a++)n.innerHTML=s[a],i=Math.max(i,n.offsetWidth),r=Math.max(r,n.offsetHeight);return webix.html.remove(n),{width:i,height:r}},download:function(e,t){var i=!1;if("object"==typeof e){if(window.navigator.msSaveBlob)return window.navigator.msSaveBlob(e,t);e=window.URL.createObjectURL(e),i=!0}var n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),webix.delay(function(){i&&window.URL.revokeObjectURL(e),document.body.removeChild(n),n.remove()})},_getClassName:function(e){if(!e)return"";var t=e.className||"";return t.baseVal&&(t=t.baseVal),t.indexOf||(t=""),t},setSelectionRange:function(e,t,i){if(t=t||0,i=i||t,e.focus(),e.setSelectionRange)e.setSelectionRange(t,i);else{var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n.select()}},getSelectionRange:function(e){if("selectionStart"in e)return{start:e.selectionStart||0,end:e.selectionEnd||0};e.focus();var t=document.selection.createRange(),i=t.getBookmark(),n=e.createTextRange();n.moveToBookmark(i);var s=n.text.length;n.collapse(!0),n.moveStart("character",-e.value.length);var r=n.text.length;return{start:r,end:r+s}}},webix.ready=function(e){this._ready?e.call():this._ready_code.push(e)},webix.debug_ready=webix.ready,webix._ready_code=[],function(){var e=document.getElementsByTagName("SCRIPT");webix.assert(e.length,"Can't locate codebase"),e.length&&(e=(e[e.length-1].getAttribute("src")||"").split("/"),e.splice(e.length-1,1),webix.codebase=e.slice(0,e.length).join("/")+"/");var t=function(){webix.env.isIE&&(document.body.className+=" webix_ie"),webix.callEvent("onReady",[])},i=function(){webix._ready=!0,window.webix_ready&&webix.isArray(webix_ready)&&(webix._ready_code=webix_ready.concat(webix._ready_code));for(var e=0;e<webix._ready_code.length;e++)webix._ready_code[e].call();webix._ready_code=[]};webix.attachEvent("onReady",function(e){e?i():webix.delay(i)}),"complete"==document.readyState?t():webix.event(window,"load",t)}(),webix.locale=webix.locale||{},webix.assert_core_ready(),webix.ready(function(){webix.event(document.body,"click",function(e){webix.callEvent("onClick",[e||event])})}),webix.editStop=function(){webix.callEvent("onEditEnd",[])},webix.debug_blacklist={onmousemoving:1},webix.skin={},webix.skin.flat={topLayout:"space",barHeight:46,tabbarHeight:46,rowHeight:34,toolbarHeight:46,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:3,menuHeight:34,labelTopHeight:22,propertyItemHeight:28,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:10,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:17,accordion:0},tabMargin:4,tabOffset:0,tabBottomOffset:6,tabTopOffset:1,customCheckbox:!0,customRadio:!0,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:32},webix.skin.set=function(e){if(webix.assert(webix.skin[e],"Incorrect skin name: "+e),webix.skin.$active=webix.skin[e],webix.skin.$name=e,webix.ui)for(var t in webix.ui){var i=webix.ui[t];i&&i.prototype&&i.prototype.$skin&&i.prototype.$skin(i.prototype)}},webix.skin.set(window.webix_skin||"flat"),webix.Destruction={$init:function(){var e=this._destructor_handler={obj:this};webix.destructors.push(e)},destructor:function(){var e=this._settings;if(this._last_editor&&this.editCancel(),this.callEvent&&this.callEvent("onDestruct",[]),this.destructor=function(){},this._destructor_handler.obj=null,this.getChildViews){var t=this.getChildViews();if(t)for(var i=0;i<t.length;i++)t[i].destructor();if(this._destroy_with_me)for(var i=0;i<this._destroy_with_me.length;i++)this._destroy_with_me[i].destructor()}if(delete webix.ui.views[e.id],e.$id){var n=this.getTopParentView();n&&n._destroy_child&&n._destroy_child(e.$id)}this._htmlmap=null,this._htmlrows=null,this._html=null,this._contentobj&&(this._contentobj.innerHTML="",this._contentobj._htmlmap=null),this._viewobj&&this._viewobj.parentNode&&this._viewobj.parentNode.removeChild(this._viewobj),this.data&&this.data.destructor&&this.data.destructor(),this.unbind&&this.unbind(),this.data=null,this._viewobj=this.$view=this._contentobj=this._dataobj=null,this._evs_events=this._evs_handlers={},webix.UIManager._view==this&&(webix.UIManager._view=null);var s=e.url;s&&s.$proxy&&s.release&&s.release(),this.$scope=null,this.$destructed=!0}},webix.destructors=[],webix.event(window,"unload",function(){webix.callEvent("unload",[]),webix._final_destruction=!0;for(var e=0;e<webix.destructors.length;e++){var t=webix.destructors[e].obj;t&&t.destructor()}webix.destructors=[],webix.ui._popups=webix.toArray();for(var i in webix._events)webix.eventRemove(i)}),function(){var e={},t={},i=new RegExp("(\\r\\n|\\n)","g"),n=new RegExp('(\\")',"g"),s=new RegExp("(\\\\)","g"),r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=function(e){return r[e]||"&amp;"};webix.template=function(r){if("function"==typeof r)return r;if(e[r])return e[r];if(r=(r||"").toString(),-1!=r.indexOf("->")){var a=r.split("->");switch(a[0]){case"html":r=webix.html.getValue(a[1]);break;case"http":r=(new webix.ajax).sync().get(a[1],{uid:webix.uid()}).responseText}}if(r=(r||"").toString(),webix.env.strict){if(!t[r]){t[r]=[];var o=[];if(r.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,function(e,t,i,n,s){o.push({pos:s,str:e,fn:function(e,s){return e[t]?i:n}})}),r.replace(/\{common\.([^}\(]*)\}/g,function(e,t,i){o.push({pos:i,str:e,fn:function(e,i){return i[t]||""}})}),r.replace(/\{common\.([^\}\(]*)\(\)\}/g,function(e,t,i){o.push({pos:i,str:e,fn:function(e,i){return i[t]?i[t].apply(this,arguments):""}})}),r.replace(/\{obj\.([^:}]*)\}/g,function(e,t,i){o.push({pos:i,str:e,fn:function(e,i){return e[t]}})}),r.replace("{obj}",function(e,t,i){o.push({pos:i,str:e,fn:function(e,t){return e}})}),r.replace(/#([^#'";, ]+)#/gi,function(e,t,i){"!"==t.charAt(0)?(t=t.substr(1),o.push({pos:i,str:e,fn:function(e,i){return-1!=t.indexOf(".")&&(e=webix.CodeParser.collapseNames(e)),webix.template.escape(e[t])}})):o.push({pos:i,str:e,fn:function(e,i){return-1!=t.indexOf(".")&&(e=webix.CodeParser.collapseNames(e)),e[t]}})}),o.sort(function(e,t){return e.pos>t.pos?1:-1}),o.length){for(var l=0,h=function(e,i,n){t[e].push(function(){return e.slice(i,n)})},c=0;c<o.length;c++){var d=o[c].pos;h(r,l,d),t[r].push(o[c].fn),l=d+o[c].str.length}h(r,l,r.length)}else t[r].push(function(){return r})}return function(){for(var e="",i=0;i<t[r].length;i++)e+=t[r][i].apply(this,arguments);return e}}r=r.replace(s,"\\\\"),r=r.replace(i,"\\n"),r=r.replace(n,'\\"'),r=r.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,'"+(obj.$1?"$2":"$3")+"'),r=r.replace(/\{common\.([^}\(]*)\}/g,"\"+(common.$1||'')+\""),r=r.replace(/\{common\.([^\}\(]*)\(\)\}/g,'"+(common.$1?common.$1.apply(this, arguments):"")+"'),r=r.replace(/\{obj\.([^}]*)\}/g,'"+(obj.$1)+"'),r=r.replace("{obj}",'"+obj+"'),r=r.replace(/#([^#'";, ]+)#/gi,function(e,t){return"!"==t.charAt(0)?'"+webix.template.escape(obj.'+t.substr(1)+')+"':'"+(obj.'+t+')+"'});try{e[r]=Function("obj","common",'return "'+r+'";')}catch(e){webix.assert_error("Invalid template:"+r)}return e[r]},webix.template.escape=function(e){return e===webix.undefined||null===e?"":(e.toString()||"").replace(/[&<>"'`]/g,a)},webix.template.empty=function(){return""},webix.template.bind=function(e){return webix.bind(webix.template(e),this)},webix.type=function(e,t){if(e.$protoWait)return e._webix_type_wait||(e._webix_type_wait=[]),void e._webix_type_wait.push(t);"function"==typeof e&&(e=e.prototype),e.types||(e.types={default:e.type},e.type.name="default");var i=t.name,n=e.type;i&&(n=e.types[i]=webix.clone(t.baseType?e.types[t.baseType]:e.type));for(var s in t)0===s.indexOf("template")?n[s]=webix.template(t[s]):n[s]=t[s];return i}}(),webix.Settings={$init:function(){this._settings=this.config={}},define:function(e,t){return"object"==typeof e?this._parseSeetingColl(e):this._define(e,t)},_define:function(e,t){var i=this[e+"_setter"];return this._settings[e]=i?i.call(this,t,e):t},_parseSeetingColl:function(e){if(e)for(var t in e)this._define(t,e[t])},_parseSettings:function(e,t){var i={};t&&(i=webix.extend(i,t)),"object"!=typeof e||e.tagName||webix.extend(i,e,!0),this._parseSeetingColl(i)},_mergeSettings:function(e,t){for(var i in t)switch(typeof e[i]){case"object":e[i]=this._mergeSettings(e[i]||{},t[i]);break;case"undefined":e[i]=t[i]}return e}},webix.ajax=function(e,t,i){return 0!==arguments.length?(new webix.ajax).get(e,t,i):this.getXHR?this:new webix.ajax},webix.ajax.count=0,webix.ajax.prototype={master:null,getXHR:function(){return new XMLHttpRequest},stringify:function(e){return webix.stringify(e)},_send:function(e,t,i,n){var s;t&&(webix.isArray(t)||"function"==typeof(t.success||t.error||t))&&(s=i,i=t,t=null);var r=webix.promise.defer(),a=this.getXHR();webix.isArray(i)||(i=[i]),i.push({success:function(e,t){r.resolve(t)},error:function(e,t){r.reject(a)}});var o=this._header||{};if(webix.callEvent("onBeforeAjax",[n,e,t,a,o,null,r])){var l=!1;if("GET"!==n){var h=!1;for(var c in o)"content-type"==c.toString().toLowerCase()&&(h=!0,"application/json"==o[c]&&(l=!0));h||(o["Content-Type"]="application/x-www-form-urlencoded")}if("object"==typeof t&&!(window.FormData&&t instanceof window.FormData))if(l)t=this.stringify(t);else{var d=[];for(var u in t){var _=t[u];null!==_&&_!==webix.undefined||(_=""),"object"==typeof _&&(_=this.stringify(_)),d.push(u+"="+encodeURIComponent(_))}t=d.join("&")}t&&"GET"===n&&(e=e+(-1!=e.indexOf("?")?"&":"?")+t,t=null),a.open(n,e,!this._sync);var f=this._response;f&&(a.responseType=f);for(var c in o)a.setRequestHeader(c,o[c]);var b=this;return this.master=this.master||s,a.onreadystatechange=function(){if(!a.readyState||4==a.readyState){if(webix.debug_time&&webix.log_full_time("data_loading"),webix.ajax.count++,i&&b&&!a.aborted){if(-1!=webix._xhr_aborted.find(a))return webix._xhr_aborted.remove(a);var e,t,n=b.master||b,r=a.status>=400||0===a.status;"blob"==a.responseType||"arraybuffer"==a.responseType?(e="",t=a.response):(e=a.responseText||"",t=b._data(a)),webix.ajax.$callback(n,i,e,t,a,r)}b&&(b.master=null),i=b=s=null}},this._timeout&&(a.timeout=this._timeout),this._sync?a.send(t||null):setTimeout(function(){a.aborted||(-1!=webix._xhr_aborted.find(a)?webix._xhr_aborted.remove(a):a.send(t||null))},1),this.master&&this.master._ajax_queue&&this.master._ajax_queue.push(a),this._sync?a:r}},_data:function(e){return{xml:function(){try{return webix.DataDriver.xml.tagToObject(webix.DataDriver.xml.toObject(e.responseText,this))}catch(t){webix.log(e.responseText),webix.log(t.toString()),webix.assert_error("Invalid xml data for parsing")}},rawxml:function(){return window.XPathResult?e.responseXML:webix.DataDriver.xml.fromString(e.responseText)},text:function(){return e.responseText},json:function(){return webix.DataDriver.json.toObject(e.responseText,!1)}}},get:function(e,t,i){return this._send(e,t,i,"GET")},post:function(e,t,i){return this._send(e,t,i,"POST")},put:function(e,t,i){return this._send(e,t,i,"PUT")},del:function(e,t,i){return this._send(e,t,i,"DELETE")},patch:function(e,t,i){return this._send(e,t,i,"PATCH")},sync:function(){return this._sync=!0,this},timeout:function(e){return this._timeout=e,this},response:function(e){return this._response=e,this},header:function(e){return webix.assert(!1,"ajax.header is deprecated in favor of ajax.headers"),this._header=e,this},headers:function(e){return this._header=webix.extend(this._header||{},e),this},bind:function(e){return this.master=e,this}},webix.ajax.$callback=function(e,t,i,n,s,r){if(!e.$destructed){if(-1===s&&n&&"function"==typeof n.json&&(n=n.json()),r&&webix.callEvent("onAjaxError",[s]),webix.isArray(t)||(t=[t]),!r)for(var a=0;a<t.length;a++)if(t[a]){var o=t[a].before;o&&o.call(e,i,n,s)}for(var a=0;a<t.length;a++)if(t[a]){var l=t[a].success||t[a];r&&(l=t[a].error),l&&l.call&&l.call(e,i,n,s)}}},webix.send=function(e,t,i,n){var s=webix.html.create("FORM",{target:n||"_self",action:e,method:i||"POST"},"");for(var r in t){var a=webix.html.create("INPUT",{type:"hidden",name:r,value:t[r]},"");s.appendChild(a)}s.style.display="none",document.body.appendChild(s),s.submit(),document.body.removeChild(s)},webix.AtomDataLoader={$init:function(e){this.data={},this.waitData=webix.promise.defer(),e&&(this._settings.datatype=e.datatype||"json"),this.$ready.push(this._load_when_ready)},_load_when_ready:function(){this._ready_for_data=!0,this._settings.url&&this.url_setter(this._settings.url),this._settings.data&&this.data_setter(this._settings.data)},url_setter:function(e){return e=webix.proxy.$parse(e),this._ready_for_data?(this.load(e,this._settings.datatype),e):e},data_setter:function(e){return this._ready_for_data?(this.parse(e,this._settings.datatype),!0):e},load:function(e,t){var i=arguments[2]||null;if(!this.callEvent("onBeforeLoad",[]))return webix.promise.reject();"string"==typeof t?(this.data.driver=webix.DataDriver[t],t=arguments[2]):this.data.driver||(this.data.driver=webix.DataDriver.json);var n=[{success:this._onLoad,error:this._onLoadError}];return t&&(webix.isArray(t)?n.push.apply(n,t):n.push(t)),e=webix.proxy.$parse(e),e.$proxy&&e.load?e.load(this,n,i):"function"==typeof e?e(i).then(webix.bind(function(e){webix.ajax.$callback(this,n,"",e,-1)},this),webix.bind(function(e){webix.ajax.$callback(this,n,"",null,e,!0)},this)):webix.ajax(e,n,this)},parse:function(e,t){return e&&e.then&&"function"==typeof e.then?e.then(webix.bind(function(e){e&&"function"==typeof e.json&&(e=e.json()),this.parse(e,t)},this)):e&&e.sync&&this.sync?this._syncData(e):this.callEvent("onBeforeLoad",[])?(this.data.driver=webix.DataDriver[t||"json"],void this._onLoad(e,null)):webix.promise.reject()},_syncData:function(e){this.data&&this.data.attachEvent("onSyncApply",webix.bind(function(){this._call_onready&&this._call_onready()},this)),this.sync(e)},_parse:function(e){var t,i,n=this.data.driver;i=n.getRecords(e)[0],t=i?n.getDetails(i):{},this.setValues?this.setValues(t):this.data=t},_onLoadContinue:function(e,t,i,n){e?this.$onLoad&&this.$onLoad(e,this.data.driver)||(this.data&&this.data._parse?this.data._parse(e):this._parse(e)):this._onLoadError(t,i,n),this._call_onready&&this._call_onready(),this.callEvent("onAfterLoad",[]),this.waitData.resolve()},_onLoad:function(e,t,i){var n,s=this.data.driver;-1===i?n=s.toObject(t):(this._ajax_queue&&this._ajax_queue.remove(i),n=s.toObject(e,t)),n&&n.then?n.then&&"function"==typeof n.then&&n.then(webix.bind(this._onLoadContinue,this)):this._onLoadContinue(n)},_onLoadError:function(e,t,i){this.callEvent("onAfterLoad",[]),this.callEvent("onLoadError",arguments),webix.callEvent("onLoadError",[e,t,i,this])},_check_data_feed:function(e){if(!this._settings.dataFeed||this._ignore_feed||!e)return!0;var t=this._settings.dataFeed;return"function"==typeof t?t.call(this,e.id||e,e):(t=t+(-1==t.indexOf("?")?"?":"&")+"action=get&id="+encodeURIComponent(e.id||e),!!this.callEvent("onBeforeLoad",[])&&(webix.ajax(t,function(e,t,i){this._ignore_feed=!0;var n=webix.DataDriver.json,s=n.toObject(e,t);s?this.setValues(n.getDetails(n.getRecords(s)[0])):this._onLoadError(e,t,i),this._ignore_feed=!1,this.callEvent("onAfterLoad",[])},this),!1))}},webix.DataDriver={},webix.DataDriver.json={toObject:function(e){if(!e)return null;if("string"==typeof e)try{if(this.parseDates){var t=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d{1-3})?Z/;e=JSON.parse(e,function(e,i){return"string"==typeof i&&t.test(i)?new Date(i):i})}else e=JSON.parse(e)}catch(t){return webix.log(t),webix.log(e),webix.assert_error("Invalid JSON data for parsing"),null}return e},getRecords:function(e){return e&&e.data&&(e=e.data),e&&!webix.isArray(e)?[e]:e},getDetails:function(e){return"string"==typeof e?{id:e||webix.uid(),value:e}:e},getOptions:function(e){return e.collections},getInfo:function(e){return{size:e.total_count||0,from:e.pos||0,parent:e.parent||0,config:e.config,key:e.webix_security}},child:"data",parseDates:!1},webix.DataDriver.html={toObject:function(e){if("string"==typeof e){var t=null;return-1==e.indexOf("<")&&(t=webix.toNode(e)),t||(t=document.createElement("DIV"),t.innerHTML=e),t.firstChild}return e},getRecords:function(e){return e.getElementsByTagName(this.tag)},getDetails:function(e){return webix.DataDriver.xml.tagToObject(e)},getOptions:function(){return!1},getInfo:function(e){return{size:0,from:0}},tag:"LI"},webix.DataDriver.jsarray={toObject:function(e){return"string"==typeof e?JSON.parse(e):e},getRecords:function(e){return e&&e.data&&(e=e.data),e},getDetails:function(e){for(var t={},i=0;i<e.length;i++)t["data"+i]=e[i];return null!==this.idColumn&&(t.id=e[this.idColumn]),t},getOptions:function(){return!1},getInfo:function(e){return{size:0,from:0}},idColumn:null},
webix.DataDriver.csv={toObject:function(e){return e},getRecords:function(e){return e.split(this.row)},getDetails:function(e){e=this.stringToArray(e);for(var t={},i=0;i<e.length;i++)t["data"+i]=e[i];return null!==this.idColumn&&(t.id=e[this.idColumn]),t},getOptions:function(){return!1},getInfo:function(e){return{size:0,from:0}},stringToArray:function(e){e=e.split(this.cell);for(var t=0;t<e.length;t++)e[t]=e[t].replace(/^[ \t\n\r]*(\"|)/g,"").replace(/(\"|)[ \t\n\r]*$/g,"");return e},idColumn:null,row:"\n",cell:","},webix.DataDriver.xml={_isValidXML:function(e){return e&&e.documentElement?e.getElementsByTagName("parsererror").length?null:e:null},toObject:function(e,t){var i=t?t.rawxml?t.rawxml():t:null;return this._isValidXML(i)?i:(i="string"==typeof e?this.fromString(e.replace(/^[\s]+/,"")):e,this._isValidXML(i)?i:null)},getRecords:function(e){return this.xpath(e,this.records)},records:"/*/item",child:"item",config:"/*/config",getDetails:function(e){return this.tagToObject(e,{})},getOptions:function(){return!1},getInfo:function(e){var t=this.xpath(e,this.config);return t=t.length?this.assignTypes(this.tagToObject(t[0],{})):null,{size:e.documentElement.getAttribute("total_count")||0,from:e.documentElement.getAttribute("pos")||0,parent:e.documentElement.getAttribute("parent")||0,config:t,key:e.documentElement.getAttribute("webix_security")||null}},xpath:function(e,t){if(window.XPathResult){var i=e;-1==e.nodeName.indexOf("document")&&(e=e.ownerDocument);for(var n=[],s=e.evaluate(t,i,null,XPathResult.ANY_TYPE,null),r=s.iterateNext();r;)n.push(r),r=s.iterateNext();return n}var a=!0;try{void 0===e.selectNodes&&(a=!1)}catch(e){}if(a)return e.selectNodes(t);var o=t.split("/").pop();return e.getElementsByTagName(o)},assignTypes:function(e){for(var t in e){var i=e[t];if("object"==typeof i)this.assignTypes(i);else if("string"==typeof i){if(""===i)continue;"true"==i?e[t]=!0:"false"==i?e[t]=!1:i==1*i&&(e[t]=1*e[t])}}return e},tagToObject:function(e,t){var i=1==e.nodeType&&e.getAttribute("stack"),n=0;if(i){t=[];for(var s=e.childNodes,r=0;r<s.length;r++)1==s[r].nodeType&&t.push(this.tagToObject(s[r],{}))}else{t=t||{};var a=e.attributes;if(a&&a.length)for(var r=0;r<a.length;r++)t[a[r].name]=a[r].value,n=1;for(var s=e.childNodes,r=0;r<s.length;r++)if(1==s[r].nodeType){var o=s[r].tagName;t[o]?("function"!=typeof t[o].push&&(t[o]=[t[o]]),t[o].push(this.tagToObject(s[r],{}))):t[o]=this.tagToObject(s[r],{}),n=2}if(!n)return this.nodeValue(e);n<2&&(t.value=t.value||this.nodeValue(e))}return t},nodeValue:function(e){return e.firstChild?e.firstChild.wholeText||e.firstChild.data:""},fromString:function(e){try{if(window.DOMParser)return(new DOMParser).parseFromString(e,"text/xml");if(window.ActiveXObject){var t=new ActiveXObject("Microsoft.xmlDOM");return t.loadXML(e),t}}catch(e){return webix.assert_error(e),null}webix.assert_error("Load from xml string is not supported")}},webix.debug_code(function(){webix.debug_load_event=webix.attachEvent("onLoadError",function(e,t,i,n){e=e||"[EMPTY DATA]";var s="Data loading error, check console for details";if(0===e.indexOf("<?php")?s="PHP support missed":0===e.indexOf("WEBIX_ERROR:")&&(s=e.replace("WEBIX_ERROR:","")),webix.message&&webix.message({type:"debug",text:s,expire:-1}),window.console){var r=window.console;r.log("Data loading error"),r.log("Object:",n),r.log("Response:",e),r.log("XHTTP:",i)}}),webix.ready(function(){0===document.location.href.indexOf("file:")&&(webix.message?webix.message({type:"error",text:"Please open sample by http,<br>not as file://",expire:-1}):window.alert("Please open sample by http, not as file://"))})}),webix.BaseBind={bind:function(e,t,i){this.attachEvent||webix.extend(this,webix.EventSystem),"string"==typeof e&&(e=webix.$$(e)),e._initBindSource&&e._initBindSource(),this._initBindSource&&this._initBindSource(),e.getBindData||webix.extend(e,webix.BindSource),this._bind_ready(),e.addBind(this._settings.id,t,i),this._bind_source=e._settings.id,webix.debug_bind&&webix.log("[bind] "+this.name+"@"+this._settings.id+" <= "+e.name+"@"+e._settings.id);var n=this._settings.id;this._bind_refresh_handler=this.attachEvent(this.touchable?"onAfterRender":"onBindRequest",function(){return e.getBindData(n)}),this.refresh&&this.isVisible(this._settings.id)&&this.refresh()},unbind:function(){if(this._bind_source){var e=webix.$$(this._bind_source);e&&e.removeBind(this._settings.id),this.detachEvent(this._bind_refresh_handler),this._bind_source=null}},_bind_ready:function(){var e=this._settings;if(this.filter){var t=e.id;this.data._on_sync=webix.bind(function(){webix.$$(this._bind_source)._bind_updated[t]=!1},this)}var i=this.render;this.render=function(){if(!this._in_bind_processing){this._in_bind_processing=!0;var e=this.callEvent("onBindRequest");return this._in_bind_processing=!1,i.apply(this,!1===e?arguments:[])}},(this.getValue||this.getValues)&&(this.save=function(e){var t=webix.$$(this._bind_source);if(e)t.setBindData(e);else{if(this.validate&&!this.validate())return!1;var i=this.getValue?this.getValue:this.getValues();t.setBindData(i,this._settings.id),this.setDirty&&this.setDirty(!1)}}),this._bind_ready=function(){}}},webix.BindSource={$init:function(){this._bind_hash={},this._bind_updated={},this._ignore_binds={},this._bind_specific_rules(this)},saveBatch:function(e){this._do_not_update_binds=!0,e.call(this),this._do_not_update_binds=!1,this._update_binds()},setBindData:function(e,t){if(t&&(this._ignore_binds[t]=!0),webix.debug_bind&&webix.log("[bind:save] "+this.name+"@"+this._settings.id+" <= @"+t),this.setValue)this.setValue(e);else if(this.setValues)this.setValues(e);else{var i=this.getCursor();i?this.updateItem(i,e):this.add(e)}this.callEvent("onBindUpdate",[e,t]),this.save&&this.save(),t&&(this._ignore_binds[t]=!1)},getBindData:function(e,t){if(this._bind_updated[e])return!1;var i=webix.$$(e);i.isVisible(i._settings.id)&&(this._bind_updated[e]=!0,webix.debug_bind&&webix.log("[bind:request] "+this.name+"@"+this._settings.id+" => "+i.name+"@"+i._settings.id),this._bind_update(i,this._bind_hash[e][0],this._bind_hash[e][1]),t&&i.filter&&i.refresh())},addBind:function(e,t,i){this._bind_hash[e]=[t,i]},removeBind:function(e){delete this._bind_hash[e],delete this._bind_updated[e],delete this._ignore_binds[e]},_bind_specific_rules:function(e){e.filter?webix.extend(this,webix.CollectionBind):e.setValue?webix.extend(this,webix.ValueBind):webix.extend(this,webix.RecordBind)},_update_binds:function(){if(!this._do_not_update_binds)for(var e in this._bind_hash)this._ignore_binds[e]||(this._bind_updated[e]=!1,this.getBindData(e,!0))},_bind_update_common:function(e,t,i){e.setValue?e.setValue(i&&t?i[t]:i):e.filter?e.data.silent(function(){this.filter(t,i)}):!i&&e.clear?e.clear():e._check_data_feed(i)&&e.setValues(webix.clone(i)),e.callEvent("onBindApply",[i,t,this])}},webix.DataValue=webix.proto({name:"DataValue",isVisible:function(){return!0},$init:function(e){e&&!webix.isUndefined(e.value)||(this.data=e||"");var t=e&&e.id?e.id:webix.uid();this._settings={id:t},webix.ui.views[t]=this},setValue:function(e){this.data=e,this.callEvent("onChange",[e])},getValue:function(){return this.data},refresh:function(){this.callEvent("onBindRequest")}},webix.EventSystem,webix.BaseBind),webix.DataRecord=webix.proto({name:"DataRecord",isVisible:function(){return!0},$init:function(e){this.data=e||{};var t=e&&e.id?e.id:webix.uid();this._settings={id:t},webix.ui.views[t]=this},getValues:function(){return this.data},setValues:function(e,t){this.data=t?webix.extend(this.data,e,!0):e,this.callEvent("onChange",[e])},refresh:function(){this.callEvent("onBindRequest")}},webix.EventSystem,webix.BaseBind,webix.AtomDataLoader,webix.Settings),webix.ValueBind={$init:function(){this.attachEvent("onChange",this._update_binds)},_bind_update:function(e,t,i){t=t||"value";var n=this.getValue()||"";if(i&&(n=i(n)),e.setValue)e.setValue(n);else if(e.filter)e.data.silent(function(){this.filter(t,n)});else{var s={};s[t]=n,e._check_data_feed(n)&&e.setValues(s)}e.callEvent("onBindApply",[n,t,this])}},webix.RecordBind={$init:function(){this.attachEvent("onChange",this._update_binds)},_bind_update:function(e,t,i){var n=this.getValues()||null;i&&(n=i(n)),this._bind_update_common(e,t,n)}},webix.CollectionBind={$init:function(){this._cursor=null,this.attachEvent("onSelectChange",function(e){var t=this.getSelectedId();this.setCursor(t?t.id||t:null)}),this.attachEvent("onAfterCursorChange",this._update_binds),this.attachEvent("onAfterDelete",function(e){e==this.getCursor()&&this.setCursor(null)}),this.data.attachEvent("onStoreUpdated",webix.bind(function(e,t,i){e&&e==this.getCursor()&&"paint"!=i&&"delete"!=i&&this._update_binds()},this)),this.data.attachEvent("onClearAll",webix.bind(function(){this._cursor=null},this)),this.data.attachEvent("onIdChange",webix.bind(function(e,t){this._cursor==e&&(this._cursor=t,this._update_binds())},this))},refreshCursor:function(){this._cursor&&this.callEvent("onAfterCursorChange",[this._cursor])},setCursor:function(e){e==this._cursor||null!==e&&!this.getItem(e)||(this.callEvent("onBeforeCursorChange",[this._cursor]),this._cursor=e,this.callEvent("onAfterCursorChange",[e]))},getCursor:function(){return this._cursor},_bind_update:function(e,t,i){if("$level"==t&&this.data.getBranch)return(e.data||e).importData(this.data.getBranch(this.getCursor()));var n=this.getItem(this.getCursor())||this._settings.defaultData||null;"$data"==t?("function"==typeof i?i.call(e,n,this):e.data.importData(n?n[i]:[]),e.callEvent("onBindApply",[n,t,this])):(i&&(n=i(n)),this._bind_update_common(e,t,n))}},webix.AtomRender={_toHTML:function(e){return e.$empty?"":this._settings.template(e,this)},render:function(){var e=this._settings;return!!this.isVisible(e.id)&&(webix.debug_render&&webix.log("Render: "+this.name+"@"+e.id),this.callEvent&&!this.callEvent("onBeforeRender",[this.data])||(this.data&&!e.content&&(this._dataobj.innerHTML="",this._dataobj.innerHTML=this._toHTML(this.data)),this.callEvent&&this.callEvent("onAfterRender",[])),!0)},sync:function(e){this._backbone_sync=!1,"DataStore"!=e.name&&(e.data&&"DataStore"==e.name?e=e.data:this._backbone_sync=!0),this._backbone_sync?e.bind("change",webix.bind(function(e){e.id==this.data.id&&(this.data=e.attributes,this.refresh())},this)):e.attachEvent("onStoreUpdated",webix.bind(function(t){t&&t!=this.data.id||(this.data=e.pull[t],this.refresh())},this))},template_setter:webix.template},webix.SingleRender=webix.proto({template_setter:function(e){this.type.template=webix.template(e)},_toHTML:function(e){var t=this.type;return(t.templateStart?t.templateStart(e,t):"")+t.template(e,t)+(t.templateEnd?t.templateEnd(e,t):"")},customize:function(e){webix.type(this,e)}},webix.AtomRender),webix.UIManager={_view:null,_hotkeys:{},_focus_time:0,_controls:{enter:13,tab:9,esc:27,escape:27,up:38,down:40,left:37,right:39,pgdown:34,pagedown:34,pgup:33,pageup:33,end:35,home:36,insert:45,delete:46,backspace:8,space:32,meta:91,win:91,mac:91,multiply:106,add:107,subtract:109,decimal:110,divide:111,scrollock:145,pausebreak:19,numlock:144,"5numlocked":12,shift:16,capslock:20},_inputs:{input:1,button:1,textarea:1,select:1},_enable:function(){webix.event(document.body,"click",webix.bind(this._focus_click,this)),webix.event(document,"keydown",webix.bind(this._keypress,this)),document.body.addEventListener&&webix.event(document.body,"focus",this._focus_tab,{capture:!0,bind:this}),webix.destructors.push({obj:this})},destructor:function(){webix.UIManager._view=null},getFocus:function(){return this._view},_focus_action:function(e){this._focus_was_there=this._focus_was_there||e._settings.id},setFocus:function(e,t){return e=webix.$$(e),e&&!e.$view&&(e=null),this._focus_time=webix._focus_time=new Date,this._view===e||(this._view&&this._view.callEvent&&this._view.callEvent("onBlur",[this._view]),e&&e.callEvent&&e.callEvent("onFocus",[e,this._view]),webix.callEvent("onFocusChange",[e,this._view]),this._view&&this._view.blur&&!t&&this._view.blur(),this._view=e,e&&e.focus&&!t&&e.focus(),!0)},applyChanges:function(e){var t=this.getFocus();t&&t!=e&&t._applyChanges&&t._applyChanges(e)},hasFocus:function(e){return e===this._view},_focus:function(e,t){var i=webix.html.locate(e,"view_id")||this._focus_was_there;if(i=webix.$$(i),this._focus_was_there=null,webix._focus_time=new Date,i!=this._view)return t||(this._focus_was_there=null),i?(i=webix.$$(i),this.canFocus(i)&&(i.getNode&&i.getNode(e),this.setFocus(i))):t||this.setFocus(null),!0},_focus_click:function(e){return new Date-this._focus_time<100?(this._focus_was_there=null,!1):this._focus(e)},_focus_tab:function(e){return!!this._inputs[e.target.nodeName.toLowerCase()]&&this._focus(e,!0)},canFocus:function(e){return e.isVisible()&&e.isEnabled()},_moveChildFocus:function(e){var t=this.getFocus();if(e&&!this._is_child_of(e,t))return!1;this._focus_logic("getPrev",e)||(this._view=null)},_translation_table:{},_is_child_of:function(e,t){if(!e)return!1;if(!t)return!1;for(;t;){if(t===e)return!0;t=t.getParentView()}return!1},_keypress_timed:function(){this&&this.callEvent&&this.callEvent("onTimedKeyPress",[])},_isNumPad:function(e){return e<112&&e>105},_keypress:function(e){var t=e.which||e.keyCode;t>95&&t<106&&(t-=48),t=this._translation_table[t]||t;var i=e.ctrlKey,n=e.shiftKey,s=e.altKey,r=e.metaKey,a=this._keycode(t,i,n,s,r),o=this.getFocus();o&&o.callEvent&&(!1===o.callEvent("onKeyPress",[t,e])&&webix.html.preventEvent(e),o.hasEvent("onTimedKeyPress")&&(clearTimeout(o._key_press_timeout),o._key_press_timeout=webix.delay(this._keypress_timed,o,[],o._settings.keyPressTimeout||250))),this._isNumPad(t)||(a=this._keycode(String.fromCharCode(t),i,n,s,r));var l=!i&&!s&&!r&&9!=t&&27!=t&&13!=t;if(!1===this._check_keycode(a,l,e))return webix.html.preventEvent(e),!1},_focus_logic:function(e){if(!this.getFocus())return null;e=e||"getNext";for(var t=this.getFocus(),i=t,n=webix.uid();;){if((t=this[e](t))&&this.canFocus(t))return this.setFocus(t);if(t===i||t.$fmarker==n)return null;t.$fmarker=n}},_tab_logic:function(e,t){var i=!t.shiftKey;if(webix.UIManager._tab_time=new Date,e&&e._custom_tab_handler&&!e._custom_tab_handler(i,t))return!1;if(e&&e._in_edit_mode){if(e.editNext)return e.editNext(i);if(e.editStop)return e.editStop(),!0}else webix.delay(function(){webix.UIManager.setFocus(webix.$$(document.activeElement),!0)},1)},getTop:function(e){for(var t,i=webix.$$(e);i&&(t=i.getParentView());)i=t;return i},getNext:function(e,t){var i=e.getChildViews();if(i.length&&!t)return i[0];var n=e.getParentView();if(!n)return e;var s=n.getChildViews();if(s.length)for(var r=webix.PowerArray.find.call(s,e)+1;r<s.length;){if(this.canFocus(s[r]))return s[r];r++}return this.getNext(n,!0)},getPrev:function(e,t){var i=e.getChildViews();if(i.length&&t)return this.getPrev(i[i.length-1],!0);if(t)return e;var n=e.getParentView();if(!n)return this.getPrev(e,!0);var s=n.getChildViews();if(s)for(var r=webix.PowerArray.find.call(s,e)-1;r>=0;){if(this.canFocus(s[r]))return this.getPrev(s[r],!0);r--}return n},addHotKey:function(e,t,i){webix.assert(t,"Hot key handler is not defined");var n=this._parse_keys(e);webix.assert(n.letter,"Unknown key code"),i||(i=null),n.handler=t,n.view=i;var s=this._keycode(n.letter,n.ctrl,n.shift,n.alt,n.meta);return this._hotkeys[s]||(this._hotkeys[s]=[]),this._hotkeys[s].push(n),e},removeHotKey:function(e,t,i){var n=this._parse_keys(e),s=this._keycode(n.letter,n.ctrl,n.shift,n.alt,n.meta);if(t||i){var r=this._hotkeys[s];if(r){for(var a=r.length-1;a>=0;a--)i&&r[a].view!==i||t&&r[a].handler!==t||r.splice(a,1);r.length||delete this._hotkeys[s]}}else delete this._hotkeys[s]},_keycode:function(e,t,i,n,s){return e+"_"+["",t?"1":"0",i?"1":"0",n?"1":"0",s?"1":"0"].join("")},_check_keycode:function(e,t,i){var n=this.getFocus();return this._hotkeys[e]?this._process_calls(this._hotkeys[e],n,i):!t||!this._hotkeys.ANY_0000||this._process_calls(this._hotkeys.ANY_0000,n,i)},_process_calls:function(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];if(null===s.view||t===s.view||"string"==typeof s.view&&t&&t.name===s.view){var r=s.handler(t,i);if(!!r===r)return r}}return!0},_parse_keys:function(e){var t,i,n,s,r=this._controls,a=e.toLowerCase().split(/[\+\-_]/);t=i=n=s=0;for(var o="",l=0;l<a.length;l++)if("ctrl"===a[l])t=1;else if("shift"===a[l])i=1;else if("alt"===a[l])n=1;else if("command"===a[l])s=1;else if(r[a[l]]){var h=r[a[l]];o=this._isNumPad(h)?h.toString():String.fromCharCode(h)}else o=a[l];return{letter:o.toUpperCase(),ctrl:t,shift:i,alt:n,meta:s,debug:e}}},webix.ready(function(){webix.UIManager._enable(),webix.UIManager.addHotKey("enter",function(e,t){if(e&&e.editStop&&e._in_edit_mode)return e.editStop(),!0;if(e&&e.touchable){var i=e.getFormView();i&&!e._skipSubmit&&i.callEvent("onSubmit",[e,t])}}),webix.UIManager.addHotKey("esc",function(e){if(e){if(e.editCancel&&e._in_edit_mode)return e.editCancel(),!0;var t=e.getTopParentView();t&&t.setPosition&&t._hide()}}),webix.UIManager.addHotKey("shift+tab",webix.UIManager._tab_logic),webix.UIManager.addHotKey("tab",webix.UIManager._tab_logic)}),webix.IdSpace={$init:function(){this._elements={},this._translate_ids={},this.getTopParentView=this._get_self=webix.bind(function(){return this},this),this._run_inner_init_logic(),this.$ready.push(this._run_after_inner_init_logic)},$$:function(e){return this._elements[e]},innerId:function(e){return this._translate_ids[e]},_run_inner_init_logic:function(e){this._prev_global_col=webix._global_collection,webix._global_collection=this},_run_after_inner_init_logic:function(e){for(var t in this._elements){var i=this._elements[t];this.callEvent&&i.mapEvent&&!i._evs_map.onitemclick&&i.mapEvent({onitemclick:this}),i.getTopParentView=this._get_self}webix._global_collection=this._prev_global_col,this._prev_global_col=0},_destroy_child:function(e){delete this._elements[e]},ui:function(){this._run_inner_init_logic();var e=webix.ui.apply(webix,arguments);return this._run_after_inner_init_logic(),e}},function(){var e=[],t=webix.ui;if(!webix.ui){t=webix.ui=function(e,s,r){webix._ui_creation=!0;var a=webix.isArray(e),o=webix.toNode(e.container||s||document.body);o._settings&&(r=n(o,a,r));var l,h=o==document.body;if(e._settings||o&&a?l=e:(o&&h&&(e.$topView=!0),e._inner||(e._inner={}),l=t._view(e)),!h||l.setPosition||l.$apiOnly||webix.ui._fixHeight(),l._settings&&l._settings._hidden&&!o.$view)l._settings._container=o;else if(!l.$apiOnly)if(o.appendChild)i(o,l,e);else if(o.destructor){var c=o;if(r||0===r||webix.isArray(l)||(r=o,o=o.getParentView()),o&&o._replace)l.getParentView&&l.getParentView()&&l.getParentView()._remove(l),o._replace(l,r);else{var s=c.$view.parentNode;c.destructor(),i(s,l,e)}}else webix.assert_error("Not existing parent:"+e.container);return webix._ui_creation=!1,l};var i=function(t,i,n){t.appendChild(i._viewobj),((!i.setPosition||i._settings.fullscreen)&&t==document.body||i._settings.position)&&e.push(i._destructor_handler),n.skipResize||i.adjust()},n=function(e,t,i){var n=[e];if(t)n=e.getChildViews();else if(e._body_cell)n=[e._body_cell];else{if("number"==typeof i)return i;if(i)return n=[webix.$$(i)],s(n),n[0].config.id}return s(n),i},s=function(e){for(var t=e.length-1;t>=0;t--)delete webix.ui.views[e[t].config.id],e[t].config.id="x"+webix.uid(),webix.ui.views[e[t].config.id]=e[t],s(e[t].getChildViews())}}webix.ui.animate=function(e,t,i){var n=webix.$$(t);if(n){var s=i||{type:"slide",direction:"left"},r=n._viewobj.cloneNode(!0),a=webix.ui(e,t);a._viewobj.parentNode.appendChild(r);var o=webix.animate.formLine(a._viewobj,r,s);return s.callback=function(){webix.animate.breakLine(o)},webix.animate(o,s),a}},webix.ui.animateView=function(e,t,i){if(e=webix.$$(e)){i=i||{type:"slide",direction:"left"};for(var n=function(e){var t=e._viewobj,i=t.className,n=t.innerHTML;return"<div class='"+i+"' style='width:"+t.offsetWidth+"px;height:"+t.offsetHeight+"px;'>"+n+"</div>"},s=[],r=0;r<e._viewobj.childNodes.length;r++){var a=e._viewobj.childNodes[r],o=a.currentStyle?a.currentStyle.display:getComputedStyle(a,null).display;s.push(o||"")}var l=n(e);"function"==typeof t&&t.call(this);for(var h=n(e),c=e._viewobj.insertBefore(webix.html.create("DIV",{class:"webix_view_animate",style:"width:"+e._viewobj.offsetWidth+"px;height:"+e._viewobj.offsetHeight+"px;"},h+l),e._viewobj.firstChild),r=1;r<e._viewobj.childNodes.length;r++)e._viewobj.childNodes[r].style.display="none";var d=webix.animate.formLine(c.childNodes[0],c.childNodes[1],i);return i.callback=function(){if(c){e._viewobj.removeChild(c),c=null;for(var t=0;t<e._viewobj.childNodes.length;t++)e._viewobj.childNodes[t].style.display=s[t]}},webix.animate(d,i),e}},webix.ui._detectScrollSize=function(){var e=webix.html.create("div");e.className="webix_skin_mark",e.style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth,i={110:"air",120:"aircompact",130:"clouds",140:"web",150:"terrace",160:"metro",170:"light",180:"glamour",190:"touch",200:"flat",210:"compact",220:"material",230:"contrast"}[10*Math.floor(e.offsetHeight/10)];if(document.body.removeChild(e),i){var n=webix.skin[i];n&&n!=webix.skin.$active&&webix.skin.set(i)}return webix.env.$customScroll?0:t},webix.ui.scrollSize=webix.env.touch||webix.env.$customScroll?0:17,webix.ready(function(){var e=webix.ui._detectScrollSize();webix.ui.scrollSize=webix.env.touch?0:e}),webix.ui._uid=function(e){return"$"+e+(this._namecount[e]=(this._namecount[e]||0)+1)},webix.ui._namecount={},webix.ui._fixHeight=function(){webix.html.addStyle("html, body{ height:100%; }"),document.body.className+=" webix_full_screen",webix.ui._fixHeight=function(){},webix.Touch.limit(!1)},webix.ui.resize=function(){if(webix.UIManager.applyChanges(),webix.callEvent("onClick",[]),!webix.ui.$freeze)for(var t=e.length-1;t>=0;t--)e[t].obj&&e[t].obj.adjust()},webix.ui.each=function(e,t,i,n){if(e)for(var s=n?[e]:e.getChildViews(),r=0;r<s.length;r++)!1!==t.call(i||webix,s[r])&&webix.ui.each(s[r],t,i)},webix.event(window,"resize",function(){if(webix.env.touch&&(webix.edit_open_time&&new Date-webix.edit_open_time<750||webix._focus_time&&new Date-webix._focus_time<750)){if(webix.env.isWebKit&&document.activeElement){var e=webix.$$(document.activeElement);e&&e.getInputNode&&document.activeElement.scrollIntoView&&document.activeElement.scrollIntoView()}}else webix.ui.resize()}),t._delays={},t.delay=function(e){webix.ui._delays[e.id]=e},t.hasMethod=function(e,t){var i=webix.ui[e];return!!i&&(i.$protoWait&&(i=i.call(webix)),!!webix.ui[e].prototype[t])},webix.ui.zIndex=function(){return webix.ui.zIndexBase++},webix.ui.zIndexBase=100,t._view=function(e){if(webix.assert_config(e),e.view){var i=e.view;return webix.assert(t[i],"unknown view:"+i),new t[i](e)}if(e.rows||e.cols){for(var n=e.rows||e.cols,s=!1,r=0;r<n.length;r++)!n[r].body||n[r].view||n[r].align||(s=!0);return s?new t.headerlayout(e):new t.layout(e)}return e.cells?new t.multiview(e):e.template||e.content?new t.template(e):e.align&&e.body?new t.align(e):new t.spacer(e)},t.views={},webix.$$=function(e){if(!e)return null;if(t.views[e])return t.views[e];if(t._delays[e])return webix.ui(t._delays[e]);var i=e;if("object"==typeof e){if(e._settings)return e;i=e.target||e.srcElement||e}return t.views[webix.html.locate({target:webix.toNode(i)},"view_id")]},webix.isUndefined(window.$$)&&(window.$$=webix.$$),webix.UIExtension=window.webix_view||{},webix.protoUI({name:"baseview",$init:function(e){e.id||(e.id=webix.ui._uid(this.name)),this._parent_cell=webix._parent_cell,webix._parent_cell=null,this.$scope=e.$scope||(this._parent_cell?this._parent_cell.$scope:null),this._viewobj||(this._contentobj=this._viewobj=webix.html.create("DIV",{class:"webix_view"}),this.$view=this._viewobj)},$skin:!1,defaults:{width:0,height:0,gravity:1},getNode:function(){return this._viewobj},getParentView:function(){return this._parent_cell||null},getTopParentView:function(){var e=this.getParentView();return e?e.getTopParentView():this},getFormView:function(){var e=this.getParentView();return!e||e.setValues?e:e.getFormView()},getChildViews:function(){return[]},isVisible:function(e,t){if(this._settings.hidden)return e&&(this._hidden_render||(this._hidden_render=[],this._hidden_hash={}),this._hidden_hash[e]||(this._hidden_hash[e]=!0,this._hidden_render.push(e))),!1;var i=this.getParentView();return!i||i.isVisible(e,this._settings.id)},isEnabled:function(){if(this._disable_cover)return!1;var e=this.getParentView();return!e||e.isEnabled()},disable:function(){webix.html.remove(this._disable_cover),this._settings.disabled=!0,this._disable_cover=webix.html.create("div",{class:"webix_disabled"}),window.getComputedStyle&&(this._disabled_view_pos=window.getComputedStyle(this._viewobj,null).getPropertyValue("position")),"absolute"!=this._disabled_view_pos&&(this._viewobj.style.position="relative"),this._viewobj.appendChild(this._disable_cover),this._viewobj.setAttribute("aria-disabled","true"),webix.html.addCss(this._viewobj,"webix_disabled_view",!0),webix.UIManager._moveChildFocus(this)},enable:function(){this._settings.disabled=!1,this._disable_cover&&(webix.html.remove(this._disable_cover),webix.html.removeCss(this._viewobj,"webix_disabled_view"),this._viewobj.removeAttribute("aria-disabled"),this._disable_cover=null,this._disabled_view_pos&&(this._viewobj.style.position=this._disabled_view_pos))},disabled_setter:function(e){return e?this.disable():this.enable(),e},container_setter:function(e){return webix.assert(webix.toNode(e),"Invalid container"),!0},css_setter:function(e){return"object"==typeof e&&(e=webix.html.createCss(e)),this._viewobj.className+=" "+e,e},id_setter:function(e){if(webix._global_collection&&(webix._global_collection!=this||this._prev_global_col)){var t=this.config.$id=e;(this._prev_global_col||webix._global_collection)._elements[e]=this,e=webix.ui._uid(this.name),(this._prev_global_col||webix._global_collection)._translate_ids[e]=t}return webix.assert(!webix.ui.views[e],"Non unique view id: "+e),webix.ui.views[e]=this,this._viewobj.setAttribute("view_id",e),e},$setSize:function(e,t){var i=this._last_size;return i&&i[0]==e&&i[1]==t?(webix.debug_size_box(this,[e,t,"not changed"]),!1):(webix.debug_size_box(this,[e,t]),this._last_size=[e,t],this.$width=this._content_width=e-(this._scroll_y?webix.ui.scrollSize:0),this.$height=this._content_height=t-(this._scroll_x?webix.ui.scrollSize:0),this._settings.flex||(this._viewobj.style.width=e+"px",this._viewobj.style.height=t+"px"),!0)},$getSize:function(e,t){var i=this._settings,n=[1*(i.width||i.minWidth||0),1*(i.width||i.maxWidth||1e5),1*(i.height||i.minHeight||0),1*(i.height||i.maxHeight||1e5),i.gravity];if(webix.assert){(isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3]))&&(webix.assert(!1,"Size is not a number "+this._settings.id),i.width=i.height=i.maxWidth=i.maxHeight=i.minWidth=i.minHeight=0,n=[0,0,1e5,1e5,1])}return n[0]+=e,n[1]+=e,n[2]+=t,n[3]+=t,n},show:function(e,t){var i=this.getParentView(),n=!arguments[2];if(i)!t&&!1!==t&&this._settings.animate&&i._settings.animate&&(t=webix.extend(i._settings.animate?webix.extend({},i._settings.animate):{},this._settings.animate,!0)),(n?i._show:i._hide)&&(n?i._show:i._hide).call(i,this,t),n&&this._render_hidden_views(),e&&n&&i.show(!i.$$&&e);else if(this._settings.hidden){if(n){var s=webix.toNode(this._settings._container||document.body);s.appendChild(this._viewobj),this._settings.hidden=!1,this.adjust(),this._render_hidden_views()}}else n||(this._settings.hidden=this._settings._hidden=!0,this._viewobj&&(this._settings._container=this._viewobj.parentNode,webix.html.remove(this._viewobj)))},_render_hidden_views:function(){if(this._hidden_render){for(var e=0;e<this._hidden_render.length;e++){var t=webix.$$(this._hidden_render[e]);t&&t.render()}this._hidden_render=[],this._hidden_hash={}}},_onKeyPress:function(e,t){var i=t.srcElement||t.target,n=i.getAttribute("role");13!==e&&32!==e||"button"!=n||this._settings.disabled||(webix.html.triggerEvent(i,"MouseEvents","click"),webix.html.preventEvent(t))},hidden_setter:function(e){return e&&this.hide(),this._settings.hidden},hide:function(){this.show(null,null,!0),webix.UIManager._moveChildFocus(this)},adjust:function(){if(!this._viewobj.parentNode)return!1;var e=this._viewobj.parentNode.clientWidth||0,t=this._viewobj.parentNode.clientHeight||0,i=this.$getSize(0,0),n=this._viewobj.parentNode==document.body&&!this.setPosition;i[0]>e&&(e=i[0]),i[2]>t&&(t=i[2]),(!n||this._settings.width)&&e>i[1]&&(e=i[1]),(!n||this._settings.height)&&t>i[3]&&(t=i[3]),this.$setSize(e,t),webix._responsive_exception&&(webix._responsive_exception=!1,this.adjust())},resize:function(e){if(!(webix._child_sizing_active||webix.ui.$freeze||webix._responsive_tinkery)){var t=this.getParentView();t?t.resizeChildren?t.resizeChildren():t.resize():(this.adjust(),webix.callEvent("onResize",[]))}}},webix.Settings,webix.Destruction,webix.BaseBind,webix.UIExtension),webix.protoUI({name:"view",$init:function(e){this._set_inner(e)},_set_inner:function(e){var t=webix.isUndefined(e.borderless);t&&!this.setPosition&&e.$topView&&(e.borderless=!0,t=!1),t&&this.defaults.borderless||e.borderless?e._inner={top:!0,left:!0,bottom:!0,right:!0}:(e._inner||(e._inner={}),this._contentobj.style.borderWidth="1px")},$getSize:function(e,t){var i=this._settings._inner;i&&(e+=(i.left?0:1)+(i.right?0:1),t+=(i.top?0:1)+(i.bottom?0:1));var n=webix.ui.baseview.prototype.$getSize.call(this,e,t);return webix.debug_size_box(this,n,!0),n},$setSize:function(e,t){webix.debug_size_box(this,[e,t]);var i=this._settings._inner;return i&&(e-=(i.left?0:1)+(i.right?0:1),t-=(i.top?0:1)+(i.bottom?0:1)),webix.ui.baseview.prototype.$setSize.call(this,e,t)}},webix.ui.baseview)}(),webix.ui.view.call(webix),webix.debug_size_indent=0,webix.debug_size_step=function(){for(var e="",t=0;t<webix.debug_size_indent;t++)e+="|  ";return e},webix.debug_size_box_start=function(e,t){webix.debug_size&&(webix.debug_size_indent||webix.log(t?"--- get sizes ---":"--- set sizes ---"),webix.log(webix.debug_size_step()+e.name+"@"+e.config.id),webix.debug_size_indent++)},webix.debug_size_box_end=function(e,t){webix.debug_size&&(webix.debug_size_indent--,webix.log(webix.debug_size_step()+t.join(",")))},webix.debug_size_box=function(e,t,i){webix.debug_size&&(webix.debug_size_indent||webix.log(i?"--- get sizes ---":"--- set sizes ---"),webix.log(webix.debug_size_step()+e.name+"@"+e.config.id+" "+t.join(",")))},webix.FlexLayout={$init:function(){this.$view.className+=" webix_flexlayout"},_fix_vertical_layout:function(){},_beforeResetBorders:function(){},_afterResetBorders:function(){},$getSize:function(e,t){webix.debug_size_box_start(this,!0);var i=0,n=0,s=this._settings.gravity;this._sizes=[];for(var r=0;r<this._cells.length;r++){var a=this._cells[r].$getSize(0,0);this._sizes.push(a),i=Math.max(i,a[0]),n=Math.max(n,a[2])}i+=2*(this._paddingX||0),n+=2*(this._paddingY||0),this._settings.width&&(i=Math.max(i,this._settings.width)),this._settings.height&&(n=Math.max(n,this._settings.height));var o=[i,1e5,n,1e5,s];return webix.debug_size_box_end(this,o),o},_set_child_size:function(e,t){var i=this.$view.style,n=Math.round(this._margin/2);i.paddingTop=i.paddingBottom=this._paddingY-n+"px",i.paddingLeft=i.paddingRight=this._paddingX-n+"px";for(var s=0;s<this._cells.length;s++)if(!this._cells[s]._settings.hidden){var r=this._cells[s].$view,a=this._sizes[s],o=this._cells[s]._settings;r&&(r.style.minWidth=a[0]+"px",a[1]<1e5&&a[1]!=a[0]&&(r.style.maxWidth=a[1]+"px"),r.style.flexBasis=o.flexBasis||a[0]+"px",r.style.flexGrow=o.flexGrow||(a[1]!=a[0]?a[4]:0),r.style.height=a[3]!=a[2]?"auto":a[2]+"px",r.style.minHeight=a[2]+"px",a[3]<1e5&&a[3]!=a[2]&&(r.style.maxHeight=a[3]+"px"),r.style.margin=n+"px")}for(var l=[],s=0;s<this._cells.length;s++)if(!this._cells[s]._settings.hidden){var r=this._cells[s].$view;l[s]=[r.offsetWidth,r.offsetHeight]}for(var s=0;s<this._cells.length;s++)if(!this._cells[s]._settings.hidden){var h=this._cells[s],r=h.$view;if(r){h._settings.flex=!0
;var a=this._sizes[s],c=a[2]==a[3]?a[2]:l[s][1];h.$setSize(l[s][0],c),h._settings.flex=!1}}this.$height=this._content_height=this.$view.scrollHeight,this.$view.style.height=this._content_height+"px"}},webix.DataMove={copy:function(e,t,i,n){n=n||{};var s=n.newId||e;i=i||this;var r=this.getItem(e);return webix.assert(r,"Incorrect ID in DataMove::copy"),i&&(r=i._externalData(r)),i.data.add(i._externalData(r,s),t,n.parent||0)},_next_move_index:function(e,t,i){if(t&&e){var n=this.getIndexById(e);return n+(i==this&&i.getIndexById(t)<n?0:1)}},move:function(e,t,i,n){n=n||{};var s=n.newId||e;if(i=i||this,webix.assert(i.data,"moving attempt to component without datastore"),i.data){if(webix.isArray(e)){e.length>3&&(this.$blockRender=i.$blockRender=!0);for(var r=0;r<e.length;r++){var a=this.move(e[r],t,i,n);t=i._next_move_index(a,e[r+1],this)}return this.$blockRender=i.$blockRender=!1,void(e.length>3&&(this.refresh(),i!=this&&i.refresh()))}var a=e,o=this.getItem(e);return webix.assert(o,"Incorrect ID in DataMove::move"),i&&i!=this?(a=i.data.add(i._externalData(o,s),t,n.parent||0),this.data.remove(e)):(t<0&&(t=this.data.order.length-1),this.data.move(this.getIndexById(e),t),this.data.callEvent("onDataMove",[e,t,null,this.data.order[t+1]])),a}},moveUp:function(e,t){return this.move(e,this.getIndexById(e)-(t||1))},moveDown:function(e,t){return this.moveUp(e,-1*(t||1))},moveTop:function(e){return this.move(e,0)},moveBottom:function(e){return this.move(e,this.data.count()-1)},_externalData:function(e,t){var i=webix.extend({},e);return i.id=!t||this.data.pull[t]?webix.uid():t,i.$template=null,this._settings.externalData&&(i=this._settings.externalData.call(this,i,t,e)),i}},webix.Movable={move_setter:function(e){return e&&(this._move_admin=webix.clone(this._move_admin),this._move_admin.master=this,webix.DragControl.addDrag(this._headobj,this._move_admin)),e},_move_admin:{$dragCreate:function(e,t){if(this.master.config.move){var i=webix.html.offset(e),n=webix.html.pos(t);return webix.DragControl.top=i.y-n.y,webix.DragControl.left=i.x-n.x,webix.toNode(this.master._viewobj)}},$dragDestroy:function(e,t){var i=this.master;i._settings&&(i._settings.top=parseInt(t.style.top,10),i._settings.left=parseInt(t.style.left,10)),webix.DragControl.top=webix.DragControl.left=5,this.master.callEvent("onViewMoveEnd",[])},$dragPos:function(e,t){this.master.callEvent("onViewMove",[e,t])}}},webix.Modality={_modal_set:function(e){if(e){if(!this._modal_cover){this._modal_cover=webix.html.create("div",{class:"webix_modal"});var t=this._settings.zIndex||webix.ui.zIndex();this._previous_modality=webix._modality,webix._modality=t,this._modal_cover.style.zIndex=t-1,this._viewobj.style.zIndex=t,document.body.appendChild(this._modal_cover),document.body.style.overflow="hidden",webix._event(this._modal_cover,"click",webix.bind(this._ignore_clicks,this))}}else if(this._modal_cover){webix.html.remove(this._modal_cover),document.body.style.overflow="visible";var i=this._previous_modality;setTimeout(function(){webix._modality=i},1),this._modal_cover=null}return e}},webix.ui._popups=webix.toArray(),webix.HTMLOptions={$init:function(e){(webix.skin.$active.customRadio||this.addOption)&&webix._event(this.$view,"keydown",this._moveSelection,{bind:this})},_focus:function(){var e=this._getInputNode();if(e)for(var t=0;t<e.length;t++)"0"==e[t].getAttribute("tabindex")&&e[t].focus()},_blur:function(){var e=this._getInputNode();if(e)for(var t=0;t<e.length;t++)"0"==e[t].getAttribute("tabindex")&&e[t].blur()},_moveSelection:function(e){var t=e.which||e.keyCode;if(t>(this.addOption?34:36)&&t<41){webix.html.preventEvent(e);var i,n=this._getInputNode();if(35==t)i=n.length-1;else if(36===t)i=0;else for(var s=37===t||38===t?-1:1,r=0;r<n.length;r++)if("0"==n[r].getAttribute("tabindex")){i=r+s,i<0?i=n.length-1:i>=n.length&&(i=0);break}if(!webix.isUndefined(i)){var a=this.addOption?n[i].getAttribute("button_id"):n[i].value;webix.skin.$active.customRadio&&!this.addOption&&(n=this.$view.getElementsByTagName("BUTTON")),this.setValue(a),n[i].focus()}}}},webix.attachEvent("onClick",function(e){var t=webix.$$(e);if(t&&t.touchable){webix.UIManager.applyChanges(t),t.getNode(e);var i=e.target||e.srcElement;if("webix_disabled"==i.className)return;var n="";if(i.className&&0===i.className.toString().indexOf("webix_view"))return;for(t&&webix.UIManager._focus_action(t);i&&i.parentNode;){if(i.getAttribute){if(i.getAttribute("view_id"))break;if(n=i.className){n=n.toString().split(" ");for(var s=0;s<n.length;s++)if(t.on_click[n[s]]){var r=t.on_click[n[s]].call(t,e,t._settings.id,i);if(!1===r)return}}}i=i.parentNode}if(t._settings.click){var a=webix.toFunctor(t._settings.click,t.$scope);a&&a.call&&a.call(t,t._settings.id,e)}var o=t._settings.popup;if(t._settings.popup&&!t._settings.readonly){"object"!=typeof o||o.name||(o=t._settings.popup=webix.ui(o)._settings.id);var o=webix.$$(o);webix.assert(o,"Unknown popup"),o.isVisible()||(o._settings.master=t._settings.id,o.show(t.getInputNode()||t.getNode(),null,!0))}t.callEvent("onItemClick",[t._settings.id,e])}}),webix.RenderStack={$init:function(){webix.assert(this.data,"RenderStack :: Component doesn't have DataStore"),webix.assert(webix.template,"webix.template :: webix.template is not accessible"),this._html=document.createElement("DIV"),this.data.attachEvent("onIdChange",webix.bind(this._render_change_id,this)),this.attachEvent("onItemClick",this._call_onclick),this.types||(this.types={default:this.type},this.type.name="default"),this.type=webix.clone(this.type)},customize:function(e){webix.type(this,e)},item_setter:function(e){return this.type_setter(e)},type_setter:function(e){return this.types[e]?(this.type=webix.clone(this.types[e]),this.type.css&&(this._contentobj.className+=" "+this.type.css)):this.customize(e),this.type.on_click&&webix.extend(this.on_click,this.type.on_click),e},template_setter:function(e){this.type.template=webix.template(e)},_toHTML:function(e){var t=this.data._marks[e.id];return webix.assert(!e.$template||this.type["template"+e.$template],"RenderStack :: Unknown template: "+e.$template),this.callEvent("onItemRender",[e]),this.type.templateStart(e,this.type,t)+(e.$template?this.type["template"+e.$template]:this.type.template)(e,this.type,t)+this.type.templateEnd(e,this.type,t)},_toHTMLObject:function(e){return this._html.innerHTML=this._toHTML(e),this._html.firstChild},_render_change_id:function(e,t){var i=this.getItemNode(e);i&&(i.setAttribute(this._id,t),this._htmlmap[t]=this._htmlmap[e],delete this._htmlmap[e])},_call_onclick:function(){if(this._settings.click){var e=webix.toFunctor(this._settings.click,this.$scope);e&&e.call&&e.apply(this,arguments)}},getItemNode:function(e){if(this._htmlmap)return this._htmlmap[e];this._htmlmap={};for(var t=this._dataobj.childNodes,i=0;i<t.length;i++){var n=t[i].getAttribute(this._id);n&&(this._htmlmap[n]=t[i])}return this.getItemNode(e)},locate:function(e){return webix.html.locate(e,this._id)},showItem:function(e){var t=this.getItemNode(e);if(t&&this.scrollTo){var i=Math.abs(this._contentobj.offsetLeft-t.offsetLeft),n=i+t.offsetWidth,s=Math.abs(this._contentobj.offsetTop-t.offsetTop),r=s+t.offsetHeight,a=this.getScrollState(),o=a.x;(o>i||o+this._content_width<n)&&(o=i);var l=a.y;(l>s||l+this._content_height<r)&&(l=s-5),this.scrollTo(o,l),this._setItemActive&&this._setItemActive(e)}},render:function(e,t,i){if(this.isVisible(this._settings.id)&&!this.$blockRender)if(webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id+", mode:"+(i||"#")+", item:"+(e||"#")),e){var n=this.getItemNode(e);switch(i){case"paint":case"update":if(!n)return;var s=this._htmlmap[e]=this._toHTMLObject(t);webix.html.insertBefore(s,n),webix.html.remove(n);break;case"delete":if(!n)return;webix.html.remove(n),delete this._htmlmap[e];break;case"add":var s=this._htmlmap[e]=this._toHTMLObject(t);webix.html.insertBefore(s,this.getItemNode(this.data.getNextId(e)),this._dataobj);break;case"move":webix.html.insertBefore(this.getItemNode(e),this.getItemNode(this.data.getNextId(e)),this._dataobj);break;default:webix.assert_error("Unknown render command: "+i)}}else if(this.callEvent("onBeforeRender",[this.data])){(this._renderobj||this._dataobj).innerHTML=this.data.getRange().map(this._toHTML,this).join(""),this._htmlmap=null,this.callEvent("onAfterRender",[]);var s=this._dataobj.offsetHeight}}},webix.ValidateData={$init:function(){this._events&&this.attachEvent("onChange",this.clearValidation)},clearValidation:function(){if(this.elements)for(var e in this.elements)this._clear_invalid(e)},validate:function(e,t){webix.assert(this.callEvent,"using validate for eventless object"),this.callEvent("onBeforeValidate",[]);var i=this._validate_details={},n=!0,s=this._settings.rules,r=this.isVisible&&!this.isVisible(),a=e&&e.hidden,o=e&&e.disabled,l={},h={};for(var c in this.elements){var d=this.elements[c].config.name;(r||this.elements[c].isVisible()||a)&&(this.elements[c].isEnabled()||o)?l[d]=this.elements[c]:h[d]=!0}if((s||l)&&!t&&this.getValues&&(t=this.getValues()),s){s.$obj&&(n=this._validate(s.$obj,t,t,"")&&n);var u=s.$all,_=t;if(this._settings.complexData&&(_=webix.CodeParser.collapseNames(t)),u)for(var f in t)if(!h[f]){var b=this._validate(u,_[f],t,f);b||(i[f]=!0),n=b&&n}for(var f in s)if(!h[f]&&0!==f.indexOf("$")&&!i[f]){webix.assert(s[f],"Invalid rule for:"+f);var b=this._validate(s[f],_[f],t,f);b||(i[f]=!0),n=b&&n}}if(l)for(var f in l)if(!i[f]){var v=l[f];if(v.validate){var b=v.validate();n=b&&n,b||(i[f]=!0)}else{var p=v._settings;if(p){var g=p.validate;if(!g&&p.required&&(g=webix.rules.isNotEmpty),g){var b=this._validate(g,t[f],t,f);b||(i[f]=!0),n=b&&n}}}}return this.callEvent("onAfterValidation",[n,this._validate_details]),n},_validate:function(e,t,i,n){return"string"==typeof e&&(e=webix.rules[e]),e.call(this,t,i,n)?(this.callEvent("onValidationSuccess",[n,i])&&this._clear_invalid&&this._clear_invalid(n),!0):(this.callEvent("onValidationError",[n,i])&&this._mark_invalid&&this._mark_invalid(n),!1)}},webix.ValidateCollection={_validate_init_once:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(e,t,i){!e||"add"!=i&&"update"!=i||this.validate(e)},this)),this.data.attachEvent("onClearAll",webix.bind(this.clearValidation,this)),this._validate_init_once=function(){}},rules_setter:function(e){return e&&this._validate_init_once(),e},clearValidation:function(){this.data.clearMark("webix_invalid",!0)},validate:function(e){var t=!0;if(e){this._validate_details={};var i=this.getItem(e);t=webix.ValidateData.validate.call(this,null,i),t?this.callEvent("onValidationSuccess",[e,i])&&this._clear_invalid(e):this.callEvent("onValidationError",[e,i,this._validate_details])&&this._mark_invalid(e,this._validate_details)}else for(var n in this.data.pull)var t=this.validate(n)&&t;return t},_validate:function(e,t,i,n){"string"==typeof e&&(e=webix.rules[e]);var s=e.call(this,t,i,n);return s||(this._validate_details[n]=!0),s},_clear_invalid:function(e){this.data.removeMark(e,"webix_invalid",!0)},_mark_invalid:function(e,t){this.data.addMark(e,"webix_invalid",!0)}},webix.rules={isEmail:function(e){return/\S+@[^@\s]+\.[^@\s]+$/.test((e||"").toString())},isNumber:function(e){return parseFloat(e)==e},isChecked:function(e){return!!e||"0"===e},isNotEmpty:function(e){return 0===e||e}},webix.MapCollection={$init:function(){this.$ready.push(this._create_scheme_init),this.attachEvent("onStructureUpdate",this._create_scheme_init),this.attachEvent("onStructureLoad",function(){this._scheme_init_order.length||this._create_scheme_init()})},_create_scheme_init:function(e){var e=this._scheme_init_order=[],t=this._settings;if(t.columns&&this._build_data_map(t.columns),this._settings.map&&this._process_field_map(t.map),this._scheme_init_order.length)try{this.data._scheme_init=Function("obj",e.join("\n"))}catch(t){webix.assert_error("Invalid data map:"+e.join("\n"))}},_process_field_map:function(e){for(var t in e)this._scheme_init_order.push(this._process_single_map(t,e[t]))},_process_single_map:function(e,t,i){var n="",s="";return 0===t.indexOf("(date)")?(n="webix.i18n.parseFormatDate(",s=")",i&&!i.format&&(i.format=webix.i18n.dateFormatStr),t=t.replace("(date)","")):0===t.indexOf("(number)")&&(n="(",s=")*1",t=t.replace("(number)","")),""!==t?(t=t.replace(/\{obj\.([^}]*)\}/g,"\"+(obj.$1||'')+\""),t=t.replace(/#([^#'";, ]+)#/gi,"\"+(obj.$1||'')+\"")):t='"+(obj.'+e+"||'')+\"","obj."+e+" = "+n+'"'+t+'"'+s+";"},_build_data_map:function(e){for(var t=0;t<e.length;t++){var i=e[t].map,n=e[t].id;n||(n=e[t].id="i"+webix.uid(),e[t].header||(e[t].header="")),i&&this._scheme_init_order.push(this._process_single_map(n,i,e[t])),this._map_options(e[t])}},_map_options:function(e){var t=e.options||e.collection;if(t)if("string"==typeof t){var i=webix.$$(t);i||(i=new webix.DataCollection({url:t}),this._destroy_with_me.push(i)),i.getBody&&(i=i.getBody()),this._bind_collection(i,e)}else if(t.loadNext)this._bind_collection(t,e);else if(t[0]&&"object"==typeof t[0])t=new webix.DataCollection({data:t}),this._bind_collection(t,e),this._destroy_with_me.push(t);else{if(webix.isArray(t)){for(var n={},s=0;s<t.length;s++)n[t[s]]=t[s];e.options=t=n}e.template=e.template||this._collection_accesser(t,e.id,e.optionslist)}},_bind_collection:function(e,t){if(t){delete t.options,t.collection=e,t.template=t.template||this._bind_accesser(e,t.id,t.optionslist);var i=e.data.attachEvent("onStoreUpdated",webix.bind(function(){this.refresh(),this.refreshFilter&&this.refreshFilter(t.id)},this));this.attachEvent("onDestruct",function(){e.$destructed||e.data.detachEvent(i)})}},_collection_accesser:function(e,t,i){if(i){var n="string"==typeof i?i:",";return function(i,s){var r=i[t]||i.value;if(!r)return"";for(var a=r.split(n),o=0;o<a.length;o++)a[o]=e[a[o]]||"";return a.join(", ")}}return function(i,n){return e[i[t]]||i.value||""}},_bind_accesser:function(e,t,i){if(i){var n="string"==typeof i?i:",";return function(i,s){var r=i[t]||i.value;if(!r)return"";for(var a=r.split(n),o=0;o<a.length;o++){var l=e.data.pull[a[o]];a[o]=l?l.value||"":""}return a.join(", ")}}return function(i,n){var s=i[t]||i.value,r=e.data.pull[s];return r&&(r.value||0===r.value)?r.value:""}}},webix.Undo={$init:function(){this._undoHistory=webix.extend([],webix.PowerArray,!0),this._undoCursor=-1},undo_setter:function(e){return e&&(this._init_undo(),this._init_undo=function(){}),e},_init_undo:function(){var e=this;this.attachEvent("onBeforeDrop",function(t){if(t.from==t.to){var i=e._draggedItem=webix.copy(this.getItem(t.start));this.data.branch?i.$index=this.getBranchIndex(i.id):i.$index=this.getIndexById(i.id)}}),this.data.attachEvent("onDataMove",function(t){if(e._draggedItem&&e._draggedItem.id==t){var i=e._draggedItem;e._draggedItem=null,e._addToHistory(t,i,"move")}}),this.data.attachEvent("onBeforeDelete",function(t){if(this.getItem(t)){var i=e._deletedItem=webix.copy(this.getItem(t));this.branch?(i.$index=this.getBranchIndex(t),this.branch[t]&&(i.$branch=webix.copy(this.serialize(t)))):i.$index=this.getIndexById(t)}}),this.data.attachEvent("onDataUpdate",function(t,i,n){e._addToHistory(t+"",n,"update")}),this.data.attachEvent("onStoreUpdated",function(t,i,n){var s=null;t&&("add"==n?s=webix.copy(i):"delete"==n&&(s=e._deletedItem),s&&e._addToHistory(t,s,n))}),this.data.attachEvent("onIdChange",function(t,i){"object"==typeof t&&(t=t.row);for(var n=0;n<e._undoHistory.length;n++)e._undoHistory[n].id==t&&(e._undoHistory[n].id=i)})},_addToHistory:function(e,t,i){!this._skipHistory&&this._settings.undo&&(this._undoHistory.push({id:e,action:i,data:t}),20==this._undoHistory.length&&this._undoHistory.splice(0,1),this._skipCursorInc||(this._undoCursor=this._undoHistory.length-1))},ignoreUndo:function(e,t){this._skipHistory=!0,e.call(t||this),this._skipHistory=!1},removeUndo:function(e){for(var t=this._undoHistory.length-1;t>=0;t--)this._undoHistory[t].id==e&&("id"==this._undoHistory[t].action&&(e=this._undoHistory[t].data),this._undoHistory.removeAt(t));this._undoCursor=this._undoHistory.length-1},undo:function(e){if(e)this.ignoreUndo(function(){var t,i;for(i=this._undoHistory.length-1;!t&&i>=0;i--)this._undoHistory[i].id==e&&(t=this._undoHistory[i]);t&&(this._undoAction(t),this._undoHistory.removeAt(i+1),this._undoCursor=this._undoHistory.length-1)});else{var t=this._undoHistory[this._undoCursor];t&&(this.ignoreUndo(function(){this._undoAction(t),this._undoHistory.removeAt(this._undoCursor)}),this._undoCursor--)}},_undoAction:function(e){if("delete"==e.action){var t=null,i=e.data.$parent;e.data.$branch&&(t={parent:e.id,data:webix.copy(e.data.$branch)},delete e.data.$branch,i&&!this.data.branch[i]&&(i=0)),this.add(e.data,e.data.$index,i),t&&this.parse(t)}else"add"==e.action?this.remove(e.id):"update"==e.action?this.updateItem(e.id,e.data):"move"==e.action&&(e.data.$parent?this.getItem(e.data.$parent)&&this.move(e.id,e.data.$index,null,{parent:e.data.$parent}):this.move(e.id,e.data.$index))}},webix.DataLoader=webix.proto({$init:function(e){e=e||"",this._ajax_queue=webix.toArray(),this._feed_last={},this.data=new webix.DataStore,this.data.attachEvent("onClearAll",webix.bind(this._call_onclearall,this)),this.data.attachEvent("onServerConfig",webix.bind(this._call_on_config,this)),this.attachEvent("onDestruct",this._call_onclearall),this.data.feed=this._feed,this.data.owner=e.id},_feed:function(e,t,i){if(this._load_count)return this._load_count=[e,t,i];this._load_count=!0,this._feed_last.from=e,this._feed_last.count=t,this._feed_common.call(this,e,t,i)},_feed_common:function(e,t,i,n,s){var r=null,n=n||this.data.url,a=[{success:this._feed_callback,error:this._feed_callback},i];if(e<0&&(e=0),s||(s={start:e,count:t}),this.count()&&(s.continue="true"),this.getState&&(r=this.getState()),n&&"string"!=typeof n)r&&(r.sort&&(s.sort=r.sort),r.filter&&(s.filter=r.filter)),this.load(n,a,s);else{n+=-1==n.indexOf("?")?"?":"&";var o=[];for(var l in s)o.push(l+"="+s[l]);if(r&&(r.sort&&o.push("sort["+r.sort.id+"]="+encodeURIComponent(r.sort.dir)),r.filter))for(var h in r.filter){var c=r.filter[h];"object"==typeof c&&(c=webix.ajax().stringify(c)),o.push("filter["+h+"]="+encodeURIComponent(c))}n+=o.join("&"),this._feed_last.url!==n?(this._feed_last.url=n,this.load(n,a)):this._load_count=!1}},_feed_callback:function(){var e=this._load_count;this._load_count=!1,"object"==typeof e&&this.data.feed.apply(this,e)},load:function(e,t){var e=webix.proxy.$parse(e),i=webix.AtomDataLoader.load.apply(this,arguments);return this.data.url||(this.data.url=e),i},loadNext:function(e,t,i,n,s){var r=this._settings;if(r.datathrottle&&!s)return this._throttle_request&&window.clearTimeout(this._throttle_request),void(this._throttle_request=webix.delay(function(){this.loadNext(e,t,i,n,!0)},this,0,r.datathrottle));t||0===t||(t=this.count()),e||(e=r.datafetch||this.count()),this.data.url=this.data.url||n,this.callEvent("onDataRequest",[t,e,i,n])&&this.data.url&&this.data.feed.call(this,t,e,i)},_maybe_loading_already:function(e,t){var i=this._feed_last;return!!(this._load_count&&i.url&&i.from<=t&&i.count+i.from>=e+t)},removeMissed_setter:function(e){return this.data._removeMissed=e},_init_dataprocessor:function(){var e=this._settings.save;!0===e&&(e=this._settings.save=this._settings.url);var t={master:this};e&&e.url?webix.extend(t,e):t.url=e,webix.dp(t)},save_setter:function(e){return e&&this.$ready.push(this._init_dataprocessor),e},scheme_setter:function(e){this.data.scheme(e)},dataFeed_setter:function(e){return e=webix.proxy.$parse(e),this.data.attachEvent("onBeforeFilter",webix.bind(function(e,t){if("function"==typeof e)return!0;if(this._settings.dataFeed&&(e||t)){e=e||"id",t&&"object"==typeof t&&(t=t.id),this.clearAll();var i=this._settings.dataFeed;if("function"==typeof i){var n={};n[e]=t,i.call(this,t,n)}else if(i.$proxy){if(i.load){var s={};s[e]=t,i.load(this,{success:this._onLoad,error:this._onLoadError},{filter:s})}}else{var r="filter["+e+"]="+encodeURIComponent(t);this.load(i+(i.indexOf("?")<0?"?":"&")+r,this._settings.datatype)}return!1}},this)),e},_call_onready:function(){if(this._settings.ready&&!this._ready_was_used){var e=webix.toFunctor(this._settings.ready,this.$scope);e&&webix.delay(e,this,arguments),this.callEvent&&webix.delay(this.callEvent,this,["onReady",[]]),this._ready_was_used=!0}},_call_onclearall:function(e){for(var t=0;t<this._ajax_queue.length;t++){var i=this._ajax_queue[t];try{i.aborted=!0}catch(e){webix._xhr_aborted.push(i)}i.abort()}e||(this._load_count=!1,this._feed_last={},this._ajax_queue=webix.toArray(),this.waitData=webix.promise.defer())},_call_on_config:function(e){this._parseSeetingColl(e)}},webix.AtomDataLoader),webix._xhr_aborted=webix.toArray(),webix.DataMarks={addCss:function(e,t,i){if(!this.addRowCss&&!i&&!this.hasCss(e,t)){var n=this.getItemNode(e);n&&(n.className+=" "+t,i=!0)}return this.data.addMark(e,t,1,1,i)},removeCss:function(e,t,i){if(!this.addRowCss&&!i&&this.hasCss(e,t)){var n=this.getItemNode(e);n&&(n.className=n.className.replace(t,"").replace("  "," "),i=!0)}return this.data.removeMark(e,t,1,i)},hasCss:function(e,t){return this.data.getMark(e,t)},clearCss:function(e,t){return this.data.clearMark(e,1,t)}},webix.DataStore=function(){this.name="DataStore",webix.extend(this,webix.EventSystem),this.setDriver("json"),this.pull={},this.order=webix.toArray(),this._marks={}},webix.DataStore.prototype={setDriver:function(e){webix.assert(webix.DataDriver[e],"incorrect DataDriver"),this.driver=webix.DataDriver[e]},_parse:function(e,t){this.callEvent("onParse",[this.driver,e]),this._filter_order&&this.filter();var i=this.driver.getInfo(e);i.key&&(webix.securityKey=i.key),i.config&&this.callEvent("onServerConfig",[i.config]);var n=this.driver.getOptions(e);n&&this.callEvent("onServerOptions",[n]);var s=this.driver.getRecords(e);this._inner_parse(i,s),this._scheme_group&&this._group_processing&&!this._not_grouped_order&&this._group_processing(this._scheme_group),this._scheme_sort&&(this.blockEvent(),this.sort(this._scheme_sort),this.unblockEvent()),this.callEvent("onStoreLoad",[this.driver,e]),this.refresh()},_inner_parse:function(e,t){var i=1*(e.from||0),n=!0,s=!1;if(0===i&&this.order[0]&&this.order[this.order.length-1]){if(this._removeMissed){s={};for(var r=0;r<this.order.length;r++)s[this.order[r]]=!0}n=!1,i=this.order.length}for(var a=0,r=0;r<t.length;r++){var o=this.driver.getDetails(t[r]),l=this.id(o);this.pull[l]?n&&this.order[a+i]&&a++:(this.order[a+i]=l,a++),this.pull[l]?(webix.extend(this.pull[l],o,!0),this._scheme_update&&this._scheme_update(this.pull[l]),s&&delete s[l]):(this.pull[l]=o,this._scheme_init&&this._scheme_init(o))}if(s){this.blockEvent();for(var h in s)this.remove(h);this.unblockEvent()}this.order[e.size-1]||(this.order[e.size-1]=webix.undefined)},id:function(e){return e.id||(e.id=webix.uid())},changeId:function(e,t){this.pull[e]&&(this.pull[t]=this.pull[e]),this.pull[t].id=t,this.order[this.order.find(e)]=t,this._filter_order&&(this._filter_order[this._filter_order.find(e)]=t),this._marks[e]&&(this._marks[t]=this._marks[e],delete this._marks[e]),this.callEvent("onIdChange",[e,t]),this._render_change_id&&this._render_change_id(e,t),delete this.pull[e]},getItem:function(e){return this.pull[e]},updateItem:function(e,t,i){var n=this.getItem(e),s=null,r=this.hasEvent("onDataUpdate");webix.assert(n,"Ivalid ID for updateItem"),webix.assert(!t||!t.id||t.id==e,"Attempt to change ID in updateItem"),webix.isUndefined(t)||n===t||(r&&(s=webix.copy(n)),e=n.id,webix.extend(n,t,!0),n.id=e),this._scheme_update&&this._scheme_update(n),this.callEvent("onStoreUpdated",[e.toString(),n,i||"update"]),r&&this.callEvent("onDataUpdate",[e,n,s])},refresh:function(e){this._skip_refresh||(e?this.exists(e)&&this.callEvent("onStoreUpdated",[e,this.pull[e],"paint"]):this.callEvent("onStoreUpdated",[null,null,null]))},silent:function(e,t){this._skip_refresh=!0,e.call(t||this),this._skip_refresh=!1},getRange:function(e,t){if(e=e?this.getIndexById(e):this.$min||this.startOffset||0,t?t=this.getIndexById(t):(t=0===this.$max?0:Math.min(this.$max?this.$max-1:this.endOffset||1/0,this.count()-1))<0&&(t=0),e>t){var i=t;t=e,e=i}return this.getIndexRange(e,t)},getIndexRange:function(e,t){t=Math.min(0===t?0:t||1/0,this.count()-1);for(var i=webix.toArray(),n=e||0;n<=t;n++)i.push(this.getItem(this.order[n]));return i},count:function(){return this.order.length},exists:function(e){return!!this.pull[e]},move:function(e,t){if(webix.assert(e>=0&&t>=0,"DataStore::move","Incorrect indexes"),e!=t){var i=this.getIdByIndex(e),n=this.getItem(i);this._filter_order&&this._move_inner(this._filter_order,0,0,this.getIdByIndex(e),this.getIdByIndex(t)),this._move_inner(this.order,e,t),this.callEvent("onStoreUpdated",[i,n,"move"])}},_move_inner:function(e,t,i,n,s){if(n||s){t=i=-1;for(var r=0;r<e.length;r++)e[r]==n&&t<0&&(t=r),e[r]==s&&i<0&&(i=r)}var a=e[t];e.removeAt(t),e.insertAt(a,Math.min(e.length,i))},scheme:function(e){this._scheme={},this._scheme_save=e.$save,this._scheme_init=e.$init||e.$change,this._scheme_update=e.$update||e.$change,this._scheme_serialize=e.$serialize,this._scheme_group=e.$group,this._scheme_sort=e.$sort;for(var t in e)"$"!=t.substr(0,1)&&(this._scheme[t]=e[t])},importData:function(e,t){var i=e?e.data||e:[];if(this._filter_order=null,"function"==typeof i.serialize){if(this.order=webix.toArray([].concat(i.order)),this._make_full_copy){this._make_full_copy=!1,this.pull={};for(var n in i.pull)this.pull[n]=webix.copy(i.pull[n])}else this.pull=i.pull;i.branch&&this.branch&&(this.branch=webix.copy(i.branch),this._filter_branch=null)}else{this.order=webix.toArray(),this.pull={};var s,r;if(webix.isArray(e))for(var n=0;n<e.length;n++)r=s=e[n],"object"==typeof r?r.id=r.id||webix.uid():r={id:s,value:s},this.order.push(r.id),this._scheme_init&&this._scheme_init(r),this.pull[r.id]=r;else for(var n in i)this.order.push(n),this.pull[n]={id:n,value:i[n]}}if(this._extraParser&&!i.branch){this.branch={0:[]},this._datadriver_child||this._set_child_scheme("data");for(var a=0;a<this.order.length;a++){var n=this.order[a];this._extraParser(this.pull[n],0,0,!1)}}this.callEvent("onStoreLoad",[]),t||this.callEvent("onStoreUpdated",[])},sync:function(e,t,i){this.unsync();var n=typeof e;if("string"==n&&(e=webix.$$("source")),"function"!=n&&"object"!=n&&(i=t,t=null),webix.debug_bind&&(this.debug_sync_master=e,webix.log("[sync] "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id+" <= "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id)),"DataStore"!=e.name){if(!e.data||"DataStore"!==e.data.name&&"TreeStore"!==e.data.name)return this._sync_source=e,webix.callEvent("onSyncUnknown",[this,e,t]);e=e.data}var s=webix.bind(function(n,s,r){this._skip_next_sync||(t&&this.branch&&(this._make_full_copy=!0),this.importData(e,!0),t&&this.silent(t),this._on_sync&&this._on_sync(),this._make_full_copy,webix.debug_bind&&webix.log("[sync:request] "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id+" <= "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id),this.callEvent("onSyncApply",[]),i?i=!1:this.refresh())},this);this._sync_events=[e.attachEvent("onStoreUpdated",s),e.attachEvent("onIdChange",webix.bind(function(e,t){this.changeId(e,t),this.refresh(t)},this))],this._sync_source=e,this._back_sync_handler=this.attachEvent("onStoreUpdated",function(t,i,n){"update"!=n&&"save"!=n||(this._skip_next_sync=1,e.updateItem(t,i),this._skip_next_sync=0)}),s()},unsync:function(){if(this._sync_source){var e=this._sync_source;if("DataStore"==e.name||e.data&&"DataStore"==e.data.name){for(var t=0;t<this._sync_events.length;t++)e.detachEvent(this._sync_events[t]);this.detachEvent(this._back_sync_handler)}else webix.callEvent("onUnSyncUnknown",[this,e]);this._sync_source=null}},destructor:function(){this.unsync(),this.pull=this.order=this._marks=null,this._evs_events=this._evs_handlers={}},add:function(e,t){if(this._scheme)for(var i in this._scheme)webix.isUndefined(e[i])&&(e[i]=this._scheme[i]);this._scheme_init&&this._scheme_init(e);var n=this.id(e),s=arguments[2]||this.order,r=s.length;if((webix.isUndefined(t)||t<0)&&(t=r),t>r&&(webix.log("Warning","DataStore:add","Index of out of bounds"),t=Math.min(s.length,t)),!1===this.callEvent("onBeforeAdd",[n,e,t]))return!1;if(webix.assert(!this.exists(n),"Not unique ID"),this.pull[n]=e,s.insertAt(n,t),this._filter_order){var a=this._filter_order.length;this.order.length&&(a=Math.min(t||0,a)),this._filter_order.insertAt(n,a)}return this.callEvent("onStoreUpdated",[n,e,"add"]),this.callEvent("onAfterAdd",[n,t]),e.id},remove:function(e){if(webix.isArray(e))for(var t=0;t<e.length;t++)this.remove(e[t]);else{if(!1===this.callEvent("onBeforeDelete",[e]))return!1;webix.assert(this.exists(e),"Not existing ID in remove command"+e);var i=this.getItem(e);this.order.remove(e),this._filter_order&&this._filter_order.remove(e),delete this.pull[e],this._marks[e]&&delete this._marks[e],this.callEvent("onStoreUpdated",[e,i,"delete"]),this.callEvent("onAfterDelete",[e])}},clearAll:function(e){this.pull={},this._marks={},this.order=webix.toArray(),this._filter_order=null,e||(this.url=null),this.callEvent("onClearAll",[e]),this.refresh()},getIdByIndex:function(e){return webix.assert(e>=0,"DataStore::getIdByIndex Incorrect index"),this.order[e]},getIndexById:function(e){var t=this.order.find(e);return this.pull[e]?t:-1},getNextId:function(e,t){return this.order[this.getIndexById(e)+(t||1)]},getFirstId:function(){return this.order[0]},getLastId:function(){return this.order[this.order.length-1]},getPrevId:function(e,t){return this.order[this.getIndexById(e)-(t||1)]},sort:function(e,t,i){var n=e;"function"==typeof e?n={as:e,dir:t}:"string"==typeof e&&(n={by:e.replace(/#/g,""),dir:t,as:i});var s=[n.by,n.dir,n.as,n];this.callEvent("onBeforeSort",s)&&(this.order=this._sort_core(n,this.order),this._filter_order&&this._filter_order.length!=this.order.length&&(this._filter_order=this._sort_core(n,this._filter_order)),this.refresh(),this.callEvent("onAfterSort",s))},_sort_core:function(e,t){var i=this.sorting.create(e);if(this.order.length){for(var n=t.splice(0,this.$freeze),s=webix.toArray(),r=t.length-1;r>=0;r--)s[r]=this.pull[t[r]];return s.sort(i),webix.toArray(n.concat(s.map(function(e){return webix.assert(e,"Client sorting can't be used with dynamic loading"),this.id(e)},this)))}return t},_filter_reset:function(e){this._filter_order&&!e&&(this.order=this._filter_order,delete this._filter_order)},_filter_core:function(e,t,i){for(var n=webix.toArray(),s=this.$freeze||0,r=0;r<this.order.length;r++){var a=this.order[r];(r<s||e(this.getItem(a),t))&&n.push(a)}i&&this._filter_order||(this._filter_order=this.order),this.order=n},find:function(e,t){var i=[];for(var n in this.pull){var s=this.pull[n],r=!0;if("object"==typeof e){for(var a in e)if(s[a]!=e[a]){r=!1;break}}else e(s)||(r=!1);if(r&&i.push(s),t&&i.length)return i[0]}return i},filter:function(e,t,i){if((e||this._filter_order||this._filter_branch)&&this.callEvent("onBeforeFilter",[e,t])&&(this._filter_reset(i),this.order.length)){if(e){var n=e;t=t||"","string"==typeof e&&(e=e.replace(/#/g,""),"function"==typeof t?n=function(i){return t(i[e])}:(t=t.toString().toLowerCase(),n=function(t,i){return webix.assert(t,"Client side filtering can't be used with dynamic loading"),-1!=(t[e]||"").toString().toLowerCase().indexOf(i)})),this._filter_core(n,t,i,this._filterMode)}this.refresh(),this.callEvent("onAfterFilter",[])}},_obj_array:function(){for(var e=[],t=this.order.length-1;t>=0;t--)e[t]=this.pull[this.order[t]];return e},each:function(e,t,i){var n=this.order;i&&(n=this._filter_order||n);for(var s=0;s<n.length;s++)e.call(t||this,this.getItem(n[s]),s)},_methodPush:function(e,t){return function(){return e[t].apply(e,arguments)}},provideApi:function(e,t){this.debug_bind_master=e,t&&this.mapEvent({onbeforesort:e,onaftersort:e,onbeforeadd:e,onafteradd:e,onbeforedelete:e,onafterdelete:e,ondataupdate:e})
;for(var i=["sort","add","remove","exists","getIdByIndex","getIndexById","getItem","updateItem","refresh","count","filter","find","getNextId","getPrevId","clearAll","getFirstId","getLastId","serialize","sync"],n=0;n<i.length;n++)e[i[n]]=this._methodPush(this,i[n])},addMark:function(e,t,i,n,s){var r=this._marks[e]||{};if(this._marks[e]=r,!r[t]){if(r[t]=n||!0,i){var a=r.$css||"";r.$css=a+" "+t}s||this.refresh(e)}return r[t]},removeMark:function(e,t,i,n){var s=this._marks[e];if(s){if(s[t]&&delete s[t],i){var r=s.$css;r&&(s.$css=r.replace(t,"").replace("  "," "))}n||this.refresh(e)}},getMark:function(e,t){var i=this._marks[e];return!!i&&i[t]},clearMark:function(e,t,i){for(var n in this._marks){var s=this._marks[n];s[e]&&(delete s[e],t&&s.$css&&(s.$css=s.$css.replace(e,"").replace("  "," ")),i||this.refresh(n))}},serialize:function(e){var t=this.order;e&&this._filter_order&&(t=this._filter_order);for(var i=[],n=0;n<t.length;n++){var s=this.pull[t[n]];this._scheme_serialize&&!1===(s=this._scheme_serialize(s))||i.push(s)}return i},sorting:{create:function(e){return this._dir(e.dir,this._by(e.by,e.as))},as:{server:function(){return!1},date:function(e,t){return e-=0,t-=0,e>t?1:e<t?-1:0},int:function(e,t){return e*=1,t*=1,e>t?1:e<t?-1:0},string_strict:function(e,t){return e=e.toString(),t=t.toString(),e>t?1:e<t?-1:0},string:function(e,t){return t?e?(e=e.toString().toLowerCase(),t=t.toString().toLowerCase(),e>t?1:e<t?-1:0):-1:1},raw:function(e,t){return e>t?1:e<t?-1:0}},_by:function(e,t){return e?("function"!=typeof t&&(t=this.as[t||"string"]),webix.assert(t,"Invalid sorting method"),function(i,n){return t(i[e],n[e])}):t},_dir:function(e,t){return"asc"!=e&&e?function(e,i){return-1*t(e,i)}:t}}},webix.DataCollection=webix.proto({name:"DataCollection",isVisible:function(){return!!(this.data.order.length||this.data._filter_order||this._settings.dataFeed)},$init:function(e){this.data.provideApi(this,!0);var t=e&&e.id?e.id:webix.uid();this._settings.id=t,webix.ui.views[t]=this,this.data.attachEvent("onStoreLoad",webix.bind(function(){this.callEvent("onBindRequest",[])},this))},refresh:function(){this.callEvent("onBindRequest",[])}},webix.DataMove,webix.CollectionBind,webix.BindSource,webix.ValidateCollection,webix.DataLoader,webix.MapCollection,webix.EventSystem,webix.BaseBind,webix.Destruction,webix.Settings),webix.Scrollable={$init:function(e){if(e&&!e.scroll&&this._one_time_scroll)return this._dataobj=this._dataobj||this._contentobj;(this._dataobj||this._contentobj).appendChild(webix.html.create("DIV",{class:"webix_scroll_cont"},"")),this._dataobj=(this._dataobj||this._contentobj).firstChild,webix.env.touch||webix._event(this._viewobj,"scroll",webix.bind(function(e){this.callEvent&&webix.delay(function(){this.callEvent("onAfterScroll",[])},this)},this))},scroll_setter:function(e){if(!e)return!1;var t="x"==e?"x":"xy"==e?"xy":"a"==e?"xy":"y";if(webix.Touch&&webix.Touch.$active)this._dataobj.setAttribute("touch_scroll",t),this.attachEvent&&this.attachEvent("onAfterRender",webix.bind(this._refresh_scroll,this)),this._touch_scroll=!0;else if(webix.env.$customScroll)webix.CustomScroll.enable(this,t);else{var i=this._dataobj.parentNode.style;-1!=e.toString().indexOf("a")?i.overflowX=i.overflowY="auto":(-1!=t.indexOf("x")&&(this._scroll_x=!0,i.overflowX="scroll"),-1!=t.indexOf("y")&&(this._scroll_y=!0,i.overflowY="scroll"))}return t},_onoff_scroll:function(e){if(!!this._settings.scroll!=!!e){if(!webix.env.$customScroll){var t=this._dataobj.parentNode.style;t.overflowX=t.overflowY=e?"auto":"hidden"}this._scroll_x=this._scroll_y=!!e,this._settings.scroll=!!e}},getScrollState:function(){if(webix.Touch&&webix.Touch.$active){var e=webix.Touch._get_matrix(this._dataobj);return{x:-e.e,y:-e.f}}return{x:this._dataobj.parentNode.scrollLeft,y:this._dataobj.parentNode.scrollTop}},scrollTo:function(e,t){webix.Touch&&webix.Touch.$active?(t=Math.max(0,Math.min(t,this._dataobj.offsetHeight-this._content_height)),e=Math.max(0,Math.min(e,this._dataobj.offsetWidth-this._content_width)),webix.Touch._set_matrix(this._dataobj,-e,-t,this._settings.scrollSpeed||"100ms")):(this._dataobj.parentNode.scrollLeft=e,this._dataobj.parentNode.scrollTop=t)},_refresh_scroll:function(){if(-1!=this._settings.scroll.toString().indexOf("x")){var e=this._dataobj.scrollWidth;e&&(this._dataobj.style.width="100%",this._dataobj.style.width=this._dataobj.scrollWidth+"px")}if(webix.Touch&&webix.Touch.$active&&this._touch_scroll){webix.Touch._clear_artefacts(),webix.Touch._scroll_end();var t=this.getScrollState(),i=this._dataobj.offsetWidth-this.$width-t.x,n=this._dataobj.offsetHeight-this.$height-t.y;if(i<0||n<0){var e=i<0?Math.min(-i-t.x,0):-t.x,s=n<0?Math.min(-n-t.y,0):-t.y;webix.Touch._set_matrix(this._dataobj,e,s,0)}}}},webix.locale.pager={first:" &lt;&lt; ",last:" &gt;&gt; ",next:" &gt; ",prev:" &lt; "},webix.PagingAbility={pager_setter:function(e){function t(i){if(e.config.autosize&&this.getVisibleCount){var n=this.getVisibleCount();isNaN(n)?(e.config.size=1,webix.delay(t,this,[!0])):n!=e.config.size&&(e.config.size=n,e.refresh(),!0===i&&this.refresh())}var s=this._settings.pager;return-1!=s.page&&(this.data.$min=this._count_pager_index(0,s.page*s.size),this.data.$max=this._count_pager_index(this.data.$min,s.size),this.data.$pagesize=this.data.$max-this.data.$min,!0)}if("string"==typeof e){var i=webix.$$(e);if(!i)return this.$blockRender=!0,webix.delay(function(){var t=webix.$$(e);this._settings.pager=this.pager_setter(t);var i=t._settings;i.count=this.data._count_pager_total(i.level),t.refresh(),this.$blockRender=!1,this.render()},this),null;e=i}return this.attachEvent("onBeforeRender",t),e.$view||(e.view="pager",e=webix.ui(e)),this._pager=e,e.$master=this,this.data.attachEvent("onStoreUpdated",function(){var t=e._settings;t.count=this._count_pager_total(t.level),e.refresh()}),this.data._count_pager_total=this._count_pager_total,e._settings},_count_pager_total:function(e){if(e&&0!==e){var t=0;return this.each(function(i){i.$level==e&&t++}),t}return this.count()},_count_pager_index:function(e,t){var i=this._settings.pager;if(i.level&&0!==i.level){var n=e,s=this.data.order.length;if(t)for(;n<s;){if(this.data.getItem(this.data.order[n]).$level==i.level){if(0===t)break;t--}n++}return n}return e+t},setPage:function(e){this._pager&&this._pager.select(e)},getPage:function(){return this._pager._settings.page},getPager:function(){return this._pager}},webix.AutoTooltip={tooltip_setter:function(e){if(e){"function"==typeof e&&(e={template:e});var t=!e.template,i=new webix.ui.tooltip(e);this._enable_mouse_move();var n=this.attachEvent("onMouseMove",function(e,n){if(this._mouseEventX=n.clientX,this._mouseEventY=n.clientY,this.getColumnConfig){var s=i.type.column=this.getColumnConfig(e.column);if(t){if(!s.tooltip&&s.tooltip!=webix.undefined)return;var r=n.target||n.srcElements;if(r.getAttribute("webix_area")&&s.tooltip){var a=r.getAttribute("webix_area");i.type.template=function(e,t){var i=e[t.column.id];return webix.template(s.tooltip).call(this,e,t,i[a],a)}}else if(s.tooltip)i.type.template=s.tooltip=webix.template(s.tooltip);else{var o=this.getText(e.row,e.column);i.type.template=function(){return o}}}}webix.DragControl.active||i.show(this.getItem(e),webix.html.pos(n))}),s=webix.event(document.body,"mousemove",webix.bind(function(e){e=e||event,this._mouseEventX==e.clientX&&this._mouseEventY==e.clientY||i.hide()},this));return this.attachEvent("onDestruct",function(){this.config.tooltip&&this.config.tooltip.destructor()}),this.attachEvent("onAfterScroll",function(){i.hide()}),i.attachEvent("onDestruct",webix.bind(function(){this.detachEvent(n),webix.eventRemove(s)},this)),i}}},webix.protoUI({name:"proto",$init:function(){this.data.provideApi(this,!0),this._dataobj=this._dataobj||this._contentobj,this.data.attachEvent("onStoreUpdated",webix.bind(function(){this.render.apply(this,arguments)},this))},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,arguments)&&this.render()},_id:"webix_item",on_mouse_move:{},type:{}},webix.PagingAbility,webix.DataMarks,webix.AutoTooltip,webix.ValidateCollection,webix.RenderStack,webix.DataLoader,webix.ui.view,webix.EventSystem,webix.Settings),webix.CodeParser={collapseNames:function(e,t,i){if(i=i||{},t=t||"",!e||"object"!=typeof e)return null;for(var n in e)!e[n]||"object"!=typeof e[n]||webix.isDate(e[n])||webix.isArray(e[n])?i[t+n]=e[n]:webix.CodeParser.collapseNames(e[n],t+n+".",i);return i},expandNames:function(e){var t,i,n,s,r,a={};for(r in e){for(n=r.split("."),i=n.length-1,s=a,t=0;t<i;t++)s[n[t]]||(s[n[t]]={}),s=s[n[t]];s[n[i]]=e[r]}return a}},webix.Values={$init:function(){this.elements={}},focus:function(e){if(e)webix.assert(this.elements[e],"unknown input name: "+e),this._focus(this.elements[e]);else for(var t in this.elements)if(this._focus(this.elements[t]))return!0},_focus:function(e){if(e&&e.focus)return e.focus(),!0},setValues:function(e,t){this._settings.complexData&&(e=webix.CodeParser.collapseNames(e)),this._inner_setValues(e,t)},_inner_setValues:function(e,t){this._is_form_dirty=t,this.blockEvent(),t&&this._values||(this._values={}),webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id);for(var i in e)this.elements[i]||(this._values[i]=e[i]);for(var i in this.elements){var n=this.elements[i];n&&(webix.isUndefined(e[i])?!t&&n._allowsClear&&n.setValue(""):n.setValue(e[i]),this._values[i]=n.getValue())}this.unblockEvent(),this.callEvent("onValues",[])},isDirty:function(){return!!this._is_form_dirty||1===this.getDirtyValues(1)},setDirty:function(e){this._is_form_dirty=e,e||(this._values=this._inner_getValues())},getDirtyValues:function(){var e={};if(this._values)for(var t in this.elements){var i=this.elements[t].getValue();if(this._values[t]!=i&&(e[t]=i,arguments[0]))return 1}return e},getCleanValues:function(){return this._values},getValues:function(e){var t=this._inner_getValues(e);return this._settings.complexData&&(t=webix.CodeParser.expandNames(t)),t},_inner_getValues:function(e){var t,i=null,n=this._values?webix.copy(this._values):{};for(var s in this.elements)i=this.elements[s],t=!0,e&&("object"==typeof e?(!1===e.hidden&&(t=i.isVisible()),t&&!1===e.disabled&&(t=i.isEnabled())):t=e.call(this,i)),t?n[s]=i.getValue():delete n[s];return n},clear:function(){this._is_form_dirty=!1;var e={};for(var t in this.elements)this.elements[t]._allowsClear&&(e[t]=this.elements[t]._settings.defaultValue||"");this._inner_setValues(e)},markInvalid:function(e,t){if(!1===t)this._clear_invalid(e);else{if("string"==typeof t){var i=this.elements[e];i&&(i._settings.invalidMessage=t)}this._mark_invalid(e)}},_mark_invalid:function(e){var t=this.elements[e];if(e&&t){this._clear_invalid(e,!0),webix.html.addCss(t._viewobj,"webix_invalid"),t._settings.invalid=!0;"string"==typeof t._settings.invalidMessage&&t.setBottomText&&t.setBottomText()}},_clear_invalid:function(e,t){var i=this.elements[e];if(e&&i&&i.$view&&i._settings.invalid){webix.html.removeCss(i._viewobj,"webix_invalid"),i._settings.invalid=!1;"string"==typeof i._settings.invalidMessage&&!t&&i.setBottomText&&i.setBottomText()}}},webix.OverlayBox={showOverlay:function(e){this._overlay?this._overlay.innerHTML=e:(this._overlay=webix.html.create("DIV",{class:"webix_overlay"},e||""),webix.html.insertBefore(this._overlay,this._viewobj.firstChild,this._viewobj),this._viewobj.style.position="relative")},hideOverlay:function(){this._overlay&&(webix.html.remove(this._overlay),this._overlay=null)}},webix.TreeRenderStack={$init:function(){webix.assert(this.render,"TreeRenderStack :: Object must use RenderStack first")},_toHTMLItem:function(e){var t=this.data._marks[e.id];return this.callEvent("onItemRender",[e]),this.type.templateStart(e,this.type,t)+(e.$template?this.type["template"+e.$template](e,this.type,t):this.type.template(e,this.type,t))+this.type.templateEnd()},_toHTMLItemObject:function(e){return this._html.innerHTML=this._toHTMLItem(e),this._html.firstChild},_toHTML:function(e){webix.assert(!e.$template||this.type["template"+e.$template],"RenderStack :: Unknown template: "+e.$template);var t="<div role='presentation' class='webix_tree_branch_"+e.$level+"'>"+this._toHTMLItem(e);return e.open&&(t+=this._toHTMLLevel(e.id)),t+="</div>"},_toHTMLLevel:function(e){var t="",i=this.data.branch[e];if(i){t+="<div role='presentation' class='webix_tree_leaves'>";for(var n=i.length-1,s=0;s<=n;s++){var r=this.getItem(i[s]);this.type._tree_branch_render_state[r.$level]=s==n,t+=this._toHTML(r)}t+="</div>"}return t},render:function(e,t,i){if(webix.TreeRenderStack._obj=this,this.isVisible(this._settings.id)&&!this.$blockRender){if(webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id),e){var n,s=this.getItem(e);if("add"!=i&&!(n=this.getItemNode(e)))return;switch(i){case"branch":var r=n.parentNode,a=this._toHTMLObject(s);webix.html.insertBefore(a,r),webix.html.remove(r),this._htmlmap=null;break;case"paint":case"update":var a=this._htmlmap[e]=this._toHTMLItemObject(s);webix.html.insertBefore(a,n),webix.html.remove(n);break;case"delete":webix.html.remove(n.parentNode);break;case"add":var o;if(0==s.$parent)o=this._dataobj.firstChild;else if(this.getItem(s.$parent).open&&(o=this.getItemNode(s.$parent))){if(!o.nextSibling){var l=webix.html.create("DIV",{class:"webix_tree_leaves"},"");o.parentNode.appendChild(l)}o=o.nextSibling}if(o){var h=this.data.getNextSiblingId(e);h=this.getItemNode(h),h&&(h=h.parentNode);var a=this._toHTMLObject(s);this._htmlmap[e]=a.firstChild,webix.html.insertBefore(a,h,o)}break;default:return!1}this.callEvent("onPartialRender",[e,t,i])}else this.callEvent("onBeforeRender",[this.data])&&(this.type._tree_branch_render_state=[],this._dataobj.innerHTML=this._toHTMLLevel(0),this._htmlmap=null,this.callEvent("onAfterRender",[]));return this.type._tree_branch_render_state=0,webix.TreeRenderStack._obj=null,!0}},getItemNode:function(e){if(this._htmlmap)return this._htmlmap[e];this._htmlmap={};for(var t=this._dataobj.getElementsByTagName("DIV"),i=0;i<t.length;i++){var n=t[i].getAttribute(this._id);n&&(this._htmlmap[n]=t[i])}return this.getItemNode(e)},_branch_render_supported:1},webix.SelectionModel={$init:function(){this._selected=webix.toArray(),webix.assert(this.data,"SelectionModel :: Component doesn't have DataStore"),this.data.attachEvent("onStoreUpdated",webix.bind(this._data_updated,this)),this.data.attachEvent("onStoreLoad",webix.bind(this._data_loaded,this)),this.data.attachEvent("onAfterFilter",webix.bind(this._data_filtered,this)),this.data.attachEvent("onSyncApply",webix.bind(this._select_check,this)),this.data.attachEvent("onIdChange",webix.bind(this._id_changed,this)),this.$ready.push(this._set_noselect)},_set_noselect:function(){("multiselect"==this._settings.select||this._settings.multiselect)&&webix._event(this.$view,"mousedown",function(e){(e||event).shiftKey&&(webix._noselect_element=this,webix.html.addCss(this,"webix_noselect",1))})},_id_changed:function(e,t){for(var i=this._selected.length-1;i>=0;i--)this._selected[i]==e&&(this._selected[i]=t)},_data_filtered:function(){for(var e=this._selected.length-1;e>=0;e--)if(this.data.getIndexById(this._selected[e])<0){var t=this._selected[e];this.removeCss(t,"webix_selected",!0),this._selected.splice(e,1),this.callEvent("onSelectChange",[t])}},_data_updated:function(e,t,i){"delete"==i?this.loadBranch?this._select_check():this._selected.remove(e):e||this.data.count()||this.data._filter_order||(this._selected=webix.toArray())},_data_loaded:function(){this._settings.select&&this.data.each(function(e){e&&e.$selected&&this.select(e.id)},this)},_select_check:function(){for(var e=this._selected.length-1;e>=0;e--)this.exists(this._selected[e])||this._selected.splice(e,1)},_select_mark:function(e,t,i,n){var s=t?"onBeforeSelect":"onBeforeUnSelect";if(!this.callEvent(s,[e,t]))return!1;n&&(this._silent_selection=!0,this.unselectAll(),this._silent_selection=!1),t?this.addCss(e,"webix_selected",!0):this.removeCss(e,"webix_selected",!0),i?i.push(e):(t?this._selected.push(e):this._selected.remove(e),this._refresh_selection(e));var s=t?"onAfterSelect":"onAfterUnSelect";return this.callEvent(s,[e]),!0},select:function(e,t){var i=arguments[2],n=arguments[3];if(!e)return this.selectAll();if(webix.isArray(e))for(var s=0;s<e.length;s++)this.select(e[s],s?1:t,i,n);else{if(webix.assert(this.data.exists(e),"Incorrect id in select command: "+e),n&&this._selected.length)return this.selectAll(this._selected[this._selected.length-1],e);var r=!1;if(i||t||1==this._selected.length&&this._selected[0]==e||(r=!0),!r&&this.isSelected(e))return void(i&&this.unselect(e));this._select_mark(e,!0,null,r)}},unselect:function(e){if(!e)return this.unselectAll();this.isSelected(e)&&this._select_mark(e,!1)},selectAll:function(e,t){var i,n=[];i=e||t?this.data.getRange(e||null,t||null):this.data.getRange(),i.each(function(e){this.data.getMark(e.id,"webix_selected")||(this._selected.push(e.id),this._select_mark(e.id,!0,n))},this),this._refresh_selection(n)},unselectAll:function(){var e=[];this._selected.each(function(t){this._select_mark(t,!1,e)},this),this._selected=webix.toArray(),this._refresh_selection(e)},isSelected:function(e){return-1!=this._selected.find(e)},getSelectedId:function(e){switch(this._selected.length){case 0:return e?[]:"";case 1:return e?[this._selected[0]]:this._selected[0];default:return[].concat(this._selected)}},getSelectedItem:function(e){var t=this.getSelectedId(!0);if(t.length>1||e){for(var i=t.length-1;i>=0;i--)t[i]=this.getItem(t[i]);return t}if(t.length)return this.getItem(t[0])},_is_mass_selection:function(e){return e.length>100||e.length>this.data.count/2},_refresh_selection:function(e){if("object"!=typeof e&&(e=[e]),e.length){if(this._is_mass_selection(e))this.data.refresh();else for(var t=0;t<e.length;t++)this.render(e[t],this.data.getItem(e[t]),"update");this._silent_selection||this.callEvent("onSelectChange",[e])}}},webix.ready(function(){webix.event(document.body,"mouseup",function(e){webix._noselect_element&&(webix.html.removeCss(webix._noselect_element,"webix_noselect"),webix._noselect_element=null)})}),webix.TreeDataMove={$init:function(){webix.assert(this.data,"DataMove :: Component doesn't have DataStore")},copy:function(e,t,i,n){return n=n||{},n.copy=!0,this.move(e,t,i,n)},_next_move_index:function(e,t,i){if(t&&e){var n=this.getBranchIndex(e);return n+(i==this&&i.getBranchIndex(t)<n?0:1)}},_check_branch_child:function(e,t){var i=this.data.branch[e];if(i&&i.length)for(var n=0;n<i.length;n++){if(i[n]==t)return!0;if(this._check_branch_child(i[n],t))return!0}return!1},move:function(e,t,i,n){n=n||{},t=t||0;var s=n.newId||e,r=n.parent||0;if(i=i||this,webix.assert(i.data,"moving attempt to component without datastore"),i.data){if(!webix.isArray(e)){if(this!=i||n.copy){if(s=i.data.add(i._externalData(this.getItem(e),s),t,r||0),this.data.branch[e]&&i.getBranchIndex){var a=this.data._scheme_serialize;this.data._scheme_serialize=function(e){var t=webix.copy(e);return delete t.$parent,delete t.$level,delete t.$child,i.data.pull[t.id]&&(t.id=webix.uid()),t};var o={data:this.serialize(e,!0),parent:s};this.data._scheme_serialize=a,i.parse(o)}n.copy||this.data.remove(e)}else{if(e==r||this._check_branch_child(e,r))return;var l=this.getItem(e),h=this.data.branch[r];h||(h=this.data.branch[r]=[]);var c=this.data.branch[l.$parent],d=webix.PowerArray.find.call(c,e);if(t<0&&(t=Math.max(h.length-1,0)),c===h&&t===d)return;if(webix.PowerArray.removeAt.call(c,d),webix.PowerArray.insertAt.call(h,e,Math.min(h.length,t)),c.length||delete this.data.branch[l.$parent],l.$parent&&"0"!=l.$parent&&this.getItem(l.$parent).$count--,r&&"0"!=r){var u=i.getItem(r);u.$count++,this._set_level_rec(l,u.$level+1)}else this._set_level_rec(l,1);l.$parent=r,i.data.callEvent("onDataMove",[e,t,r,h[t+1]])}return this.refresh(),s}for(var _=0;_<e.length;_++){var f=this.move(e[_],t,i,n);t=i._next_move_index(f,e[_+1],this)}}},_set_level_rec:function(e,t){e.$level=t;var i=this.data.branch[e.id];if(i)for(var n=0;n<i.length;n++)this._set_level_rec(this.getItem(i[n]),t+1)},_drag_pause:function(e){e&&!e.header&&this.open(e)},$dropAllow:function(e){if(e.from!=e.to)return!0;for(var t=0;t<e.source.length;t++)if(e.source==e.target||this._check_branch_child(e.source,e.target))return!1;return!0},_externalData:function(e,t){var i=webix.DataMove._externalData.call(this,e,t);return delete i.open,i}},webix.TreeDataLoader={$init:function(){this.data.attachEvent("onStoreUpdated",webix.bind(this._sync_hierarchy,this),null,!0),this._feed_common=this._feed_commonA},_feed_commonA:function(e,t,i,n){var s=0===t?{parent:encodeURIComponent(e)}:null;webix.DataLoader.prototype._feed_common.call(this,e,t,i,n,s)},loadBranch:function(e,t,i){e=e||0,this.data.url=i||this.data.url,this.callEvent("onDataRequest",[e,t,this.data.url])&&this.data.url&&this.data.feed.call(this,e,0,t,i)},_sync_hierarchy:function(e,t,i){i&&"add"!=i&&"delete"!=i&&"branch"!=i||this.data._sync_to_order(this)}},webix.TreeStore={name:"TreeStore",$init:function(){this._filterMode={showSubItems:!0},this.branch={0:[]},this.attachEvent("onParse",function(e,t){this._set_child_scheme(e.child);e.getInfo(t).parent}),this.attachEvent("onClearAll",webix.bind(function(){this._filter_branch=null},this))},filterMode_setter:function(e){return webix.extend(this._filterMode,e,!0)},_filter_reset:function(e){if(this._filter_branch&&!e){this.branch=this._filter_branch,this.order=webix.toArray(webix.copy(this.branch[0]));for(var t in this.branch)"0"!=t&&(this.getItem(t).$count=this.branch[t].length);delete this._filter_branch}},_filter_core:function(e,t,i,n){i&&this._filter_branch||(this._filter_branch=this.branch,this.branch=webix.clone(this.branch)),this.branch[0]=this._filter_branch_rec(e,t,this.branch[0],1,n||{})},_filter_branch_rec:function(e,t,i,n,s){for(var r=[],a=s.level&&s.level!=n,o=0;o<i.length;o++){var l=i[o],h=this.getItem(l),c=!1,d=this.branch[l];if(a)c=!0;else if(e(this.getItem(l),t)){if(r.push(l),!1!==s.openParents)for(var u=this.getParentId(l);u&&"0"!=u;)this.getItem(u).open=1,u=this.getParentId(u);if(s.level||s.showSubItems)continue}else c=!0;if((a||!s.level)&&d){var _=this.branch[l]=this._filter_branch_rec(e,t,d,n+1,s);h.$count=_.length,c&&_.length&&r.push(l)}}return r},count:function(){if(this.order.length)return this.order.length;var e=0;return this.eachOpen(function(){e++}),e},changeId:function(e,t){if(this.branch[e]){for(var i=this.branch[t]=this.branch[e],n=0;n<i.length;n++)this.getItem(i[n]).$parent=t;delete this.branch[e]}var s=this.getItem(e).$parent;if(this.branch[s]){var r=webix.PowerArray.find.call(this.branch[s],e);this.branch[s][r]=t}return webix.DataStore.prototype.changeId.call(this,e,t)},clearAll:function(e){this.branch={0:[]},webix.DataStore.prototype.clearAll.call(this,e)},getPrevSiblingId:function(e){var t=this.branch[this.getItem(e).$parent],i=webix.PowerArray.find.call(t,e)-1;return i>=0?t[i]:null},getNextSiblingId:function(e){var t=this.branch[this.getItem(e).$parent],i=webix.PowerArray.find.call(t,e)+1;return i<t.length?t[i]:null},getParentId:function(e){return this.getItem(e).$parent},getFirstChildId:function(e){var t=this.branch[e];return t&&t.length?t[0]:null},isBranch:function(e){return!!this.branch[e]},getBranchIndex:function(e){var t=this.branch[this.pull[e].$parent];return webix.PowerArray.find.call(t,e)},_set_child_scheme:function(e){this._datadriver_child="string"==typeof e?function(t){var i=t[e];return i&&delete t[e],i}:e},_inner_parse:function(e,t){for(var i=e.parent||0,n=0;n<t.length;n++){var s=this.driver.getDetails(t[n]),r=this.id(s),a=!!this.pull[r];a?(s=webix.extend(this.pull[r],s,!0),this._scheme_update&&this._scheme_update(s)):(this._scheme_init&&this._scheme_init(s),this.pull[r]=s),this._extraParser(s,i,0,a,e.from?1*e.from+n:0)}var o=this.pull[i]||{},l=this.branch[i]||[];o.$count=l.length,delete o.webix_kids,e.size&&e.size!=l.length&&(l[e.size]=null)},_extraParser:function(e,t,i,n,s){e.$count=0,e.$parent="0"!=t?t:0,e.$level=i||("0"!=t?this.pull[t].$level+1:1);var r=this.branch[e.$parent];if(r||(r=this.branch[e.$parent]=[]),this._filter_branch&&(this._filter_branch[e.$parent]=r),!n){r[s||r.length]=e.id}var a=this._datadriver_child(e);if(e.webix_kids)return e.$count=-1;if(!a)return e.$count=0;webix.isArray(a)||(a=[a]);for(var o=0;o<a.length;o++){var l=webix.DataDriver.json.getDetails(a[o]),h=this.id(l);n=!!this.pull[h],n?(l=webix.extend(this.pull[h],l,!0),this._scheme_update&&this._scheme_update(l)):(this._scheme_init&&this._scheme_init(l),this.pull[h]=l),this._extraParser(l,e.id,e.$level+1,n)}var c=this.branch[e.id];c&&(e.$count=c.length)},_sync_to_order:function(e){this.order=webix.toArray(),this._sync_each_child(0,e)},_sync_each_child:function(e,t){for(var i=this.branch[e],n=0;n<i.length;n++){var s=i[n];this.order.push(s);var r=this.pull[s];r&&r.open&&(-1==r.$count?t.loadBranch(s):r.$count&&this._sync_each_child(s,t))}},provideApi:function(e,t){for(var i=["getPrevSiblingId","getNextSiblingId","getParentId","getFirstChildId","isBranch","getBranchIndex","filterMode_setter"],n=0;n<i.length;n++)e[i[n]]=this._methodPush(this,i[n]);e.getIndexById||webix.DataStore.prototype.provideApi.call(this,e,t)},getTopRange:function(){return webix.toArray([].concat(this.branch[0])).map(function(e){return this.getItem(e)},this)},eachChild:function(e,t,i,n){var s=this.branch;n&&this._filter_branch&&(s=this._filter_branch);var r=s[e];if(r)for(var a=0;a<r.length;a++)t.call(i||this,this.getItem(r[a]))},each:function(e,t,i,n){this.eachChild(n||0,function(n){var s=this.branch;e.call(t||this,n),i&&this._filter_branch&&(s=this._filter_branch),n&&s[n.id]&&this.each(e,t,i,n.id)},this,i)},eachOpen:function(e,t,i){this.eachChild(i||0,function(i){e.call(t||this,i),this.branch[i.id]&&i.open&&this.eachOpen(e,t,i.id)})},eachSubItem:function(e,t){var i=this.branch[e||0];if(i)for(var n=0;n<i.length;n++){var s=i[n];this.branch[s]?(t.call(this,this.getItem(s),!0),this.eachSubItem(s,t)):t.call(this,this.getItem(s),!1)}},eachLeaf:function(e,t){var i=this.branch[e||0];if(i)for(var n=0;n<i.length;n++){var s=i[n];this.branch[s]?this.eachLeaf(s,t):t.call(this,this.getItem(s),!1)}},_sort_core:function(e,t){var i=this.sorting.create(e);for(var n in this.branch){for(var s=this.branch[n],r=[],a=0;a<s.length;a++)r.push(this.pull[s[a]]);r.sort(i);for(var a=0;a<s.length;a++)r[a]=r[a].id;this.branch[n]=r}return t},add:function(e,t,i){var n=!1,s=this.getItem(i||0);if(s&&(this.branch[s.id]||(n=!0),++s.$count||(s.$count=1)),this.branch[i||0]=this.order=webix.toArray(this.branch[i||0]),e.$count=0,e.$level=s?s.$level+1:1,e.$parent=s?s.id:0,this._filter_branch){var r=this._filter_branch[i||0];if(r||(r=this._filter_branch[i]=this.order),this.order!==r){var a=r.length;!t&&this.branch[i||0].length&&(a=0),r=webix.toArray(r),r.insertAt(e.id,a)}}var o=webix.DataStore.prototype.add.call(this,e,t);return n&&this.refresh(i),o},_rec_remove:function(e,t){var i=this.pull[e];if(this.branch[i.id]&&this.branch[i.id].length>0)for(var n=this.branch[e],s=0;s<n.length;s++)this._rec_remove(n[s],!0);delete this.branch[e],this._filter_branch&&delete this._filter_branch[e],delete this.pull[e],this._marks[e]&&delete this._marks[e]},_filter_removed:function(e,t,i){var n=e[t];1==n.length&&n[0]==i&&t?delete e[t]:webix.toArray(n).remove(i)},remove:function(e){if(webix.isArray(e))for(var t=0;t<e.length;t++)this.remove(e[t]);else{webix.assert(this.exists(e),"Not existing ID in remove command"+e);var i=this.pull[e],n=i.$parent||0;if(!1===this.callEvent("onBeforeDelete",[e]))return!1;this._rec_remove(e),this.callEvent("onAfterDelete",[e]);var s=this.pull[n];this._filter_removed(this.branch,n,e),this._filter_branch&&this._filter_removed(this._filter_branch,n,e);var r=0;s&&--s.$count<=0&&(s.$count=0,s.open=0,r=1),this.callEvent("onStoreUpdated",[e,i,"delete"]),r&&this.refresh(s.id)}},getBranch:function(e){var t=[],i=(this._filter_branch||this.branch)[e];if(i)for(var n=0;n<i.length;n++)t[n]=this.pull[i[n]];return t},serialize:function(e,t){this.branch;t&&this._filter_branch&&this._filter_branch;for(var i=this.branch[e||0],n=[],s=0;s<i.length;s++){var r,a=this.pull[i[s]];if(this._scheme_serialize){if(!1===(r=this._scheme_serialize(a)))continue}else r=webix.copy(a);this.branch[a.id]&&(r.data=this.serialize(a.id,t)),n.push(r)}return n}},webix.TreeTableClick={},webix.TreeTablePaste={insert:function(e){for(var t=this.getSelectedId(!0,!0),i=0;i<e.length;i++){for(var n={},s=0;s<this._settings.columns.length;s++)n[this._settings.columns[s].id]=e[i][s]||"";!webix.isUndefined(n.id)&&this.exists(n.id)&&(n.id=webix.uid()),this.add(n,null,t[0])}}},webix.TreeType={space:function(e,t){for(var i="",n=1;n<e.$level;n++)i+="<div class='webix_tree_none'></div>";return i},icon:function(e,t){return e.$count?e.open?"<div class='webix_tree_open'></div>":"<div class='webix_tree_close'></div>":"<div class='webix_tree_none'></div>"},checkbox:function(e,t){return e.nocheckbox?"":"<input type='checkbox' class='webix_tree_checkbox' "+(e.checked?"checked":"")+(e.disabled?" disabled":"")+">"},folder:function(e,t){return e.icon?"<div class='webix_tree_file webix_tree_"+e.icon+"'></div>":e.$count?e.open?"<div class='webix_tree_folder_open'></div>":"<div class='webix_tree_folder'></div>":"<div class='webix_tree_file'></div>"}},webix.TreeAPI={open:function(e,t){if(e){var i=this.getItem(e);i.$count&&!i.open&&(this.callEvent("onBeforeOpen",[e])&&(i.open=!0,this.data.callEvent("onStoreUpdated",[e,0,"branch"]),this.callEvent("onAfterOpen",[e])),t&&"0"!=e&&this.open(this.getParentId(e),t))}},close:function(e){if(e){var t=this.getItem(e);t.open&&this.callEvent("onBeforeClose",[e])&&(t.open=!1,this.data.callEvent("onStoreUpdated",[e,0,"branch"]),this.callEvent("onAfterClose",[e]))}},openAll:function(e){this.data.eachSubItem(e||0,function(e,t){t&&(e.open=!0)}),this.data.refresh()},closeAll:function(e){this.data.eachSubItem(e||0,function(e,t){t&&(e.open=!1)}),this.data.refresh()},_tree_check_uncheck:function(e,t,i){if(this._settings.threeState)return this._tree_check_uncheck_3(e,null!==t?t:"");var n,s=this.getItem(e),r=i?i.target||i.srcElement:null;n=r&&"checkbox"==r.type?!!r.checked:null!==t?t:!s.checked,s.checked=n,this.callEvent("onItemCheck",[e,s.checked,i])},isBranchOpen:function(e){if("0"==e)return!0;var t=this.getItem(e);return!!t.open&&this.isBranchOpen(t.$parent)},getOpenItems:function(){var e=[];for(var t in this.data.branch)this.exists(t)&&this.getItem(t).open&&e.push(t);return e},getState:function(){return{open:this.getOpenItems(),select:this.getSelectedId(!0)}},_repeat_set_state:function(e,t){var i=this.data.attachEvent("onStoreLoad",function(){e.setState.call(e,t),e.data.detachEvent(i),e=null})},setState:function(e){if(e.open){this.closeAll();for(var t=e.open,i=0;i<t.length;i++){var n=this.getItem(t[i]);if(n&&n.$count&&(n.open=!0,-1==n.$count))return this._repeat_set_state(this,e),this.refresh(),0}this.refresh()}if(e.select&&this.select){var s=e.select;this.unselect();for(var i=0;i<s.length;i++)this.exists(s[i])&&this.select(s[i],!0)}return 1}},webix.TreeClick={webix_tree_open:function(e,t){return this.close(t),!1},webix_tree_close:function(e,t){return this.open(t),!1},webix_tree_checkbox:function(e,t){return this._tree_check_uncheck(t,null,e),!1}},webix.TreeCollection=webix.proto({name:"TreeCollection",$init:function(){webix.extend(this.data,webix.TreeStore,!0),this.data.provideApi(this,!0),webix.extend(this,webix.TreeDataMove,!0)}},webix.TreeDataLoader,webix.DataCollection),webix.AutoScroll={_auto_scroll:function(e,t){var i=1,n=0,s=this._settings.dragscroll;"string"==typeof s&&(n=-1!=s.indexOf("x"),i=-1!=s.indexOf("y"));var r=this._body||this.$view,a=webix.html.offset(r),o=a.y,l=o+r.offsetHeight,h=a.x,c=h+r.offsetWidth,s=this.getScrollState(),d=!1,u=Math.max(this.type&&!isNaN(parseFloat(this.type.height))?this.type.height+5:0,40);if(i){var _=this._settings;if(_.topSplit){var f=this._cellPosition(this.getIdByIndex(_.topSplit-1),this.columnId(0));o+=f.top+f.height}e.y<o+u?(this._auto_scrollTo(s.x,s.y-2*u,e),d=!0):e.y>l-u&&(this._auto_scrollTo(s.x,s.y+2*u,e),d=!0)}
n&&(e.x<h+u?(this._auto_scrollTo(s.x-2*u,s.y,e),d=!0):e.x>c-u&&(this._auto_scrollTo(s.x+2*u,s.y,e),d=!0)),d&&(this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[e],100))},_auto_scrollTo:function(e,t,i){this.callEvent("onBeforeAutoScroll",[i])&&this.scrollTo(e,t)}},webix.DragOrder={_do_not_drag_selection:!0,$drag:function(e,t){var i=webix.DragItem.$drag.call(this,e,t);if(i){var n=webix.DragControl.getContext();this.getBranchIndex&&(this._drag_order_stored_left=this._drag_order_complex?16*this.getItem(n.start).$level:0),n.fragile||this.addCss(n.start,"webix_transparent")}return i},_getDragItemPos:function(e,t){return webix.DragItem._getDragItemPos(e,t)},$dragPos:function(e,t,i){var n=webix.html.offset(this.$view),s=n.x+(this._drag_order_complex?1+this._drag_order_stored_left:1),r=e.y,a=this._settings,o="x"==a.layout;o&&(r=n.y+(this._drag_order_complex?+n.height-webix.ui.scrollSize-1:1),s=e.x),i.style.display="none";var l=document.elementFromPoint(s,r);if(l!=this._last_sort_dnd_node){var h=webix.$$(l);if(h&&h==this){var c=this.locate(l,!0);!c&&webix.DragControl._saved_event&&(c=this.locate(webix.DragControl._saved_event,!0));var d=webix.DragControl.getContext().start;if(this._auto_scroll_force=!0,c){if(c!=this._last_sort_dnd_node){if(c!=d){var u,_;this.getBranchIndex?(u={parent:this.getParentId(c)},_=this.getBranchIndex(c)):(u={},_=this.getIndexById(c)),this.callEvent("onBeforeDropOrder",[d,_,t,u])&&(this.move(d,_,this,u),this._last_sort_dnd_node=c)}webix.DragControl._last=this._contentobj}}else if(c="$webix-last",this._last_sort_dnd_node!=c){if(!this.callEvent("onBeforeDropOrder",[d,-1,t,{parent:0}]))return;this._last_sort_dnd_node=c}}}if(i.style.display="block",o)if(e.y=n.y,e.x=e.x-18,e.x<n.x)e.x=n.x;else{var f=n.x+this.$view.offsetWidth-60;e.x>f&&(e.x=f)}else if(n.y+=this._header_height,e.x=this._drag_order_stored_left||n.x,e.y=e.y-18,e.y<n.y)e.y=n.y;else{var f=n.y+this.$view.offsetHeight-60;e.y>f&&(e.y=f)}this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)),this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[webix.html.pos(t),this.locate(t)||null],250),webix.DragControl._skip=!0},$dragIn:function(){return!1},$drop:function(e,t,i){this._auto_scroll_delay&&(this._auto_scroll_force=null,this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));var n=webix.DragControl.getContext(),s=n.start;this.removeCss(s,"webix_transparent");var r=this.getIndexById(s);this.callEvent("onAfterDropOrder",[s,r,i]),n.fragile&&this.refresh()}},webix.DragItem={_initHandlers:function(e,t,i){t||webix.DragControl.addDrop(e._contentobj,e,!0),i||webix.DragControl.addDrag(e._contentobj,e),this.attachEvent("onDragOut",function(e,t){this.$dragMark(e,t)}),this.attachEvent("onBeforeAutoScroll",function(){var e=webix.DragControl.getContext();return!(!webix.DragControl._active||!e||e.to!==this&&!this._auto_scroll_force)})},drag_setter:function(e){return e&&(webix.extend(this,webix.AutoScroll,!0),"order"==e&&webix.extend(this,webix.DragOrder,!0),"inner"==e&&(this._inner_drag_only=!0),this._initHandlers(this,"source"==e,"target"==e),delete this.drag_setter),e},$dragIn:function(e,t,i){var n=this.locate(i)||null,s=webix.DragControl._drag_context;if((this._inner_drag_only||s.from._inner_drag_only)&&s.from!==this)return!1;var r=webix.DragControl.getMaster(t),a=this.getItemNode(n,i)||this._dataobj;return a==webix.DragControl._landing?a:(s.target=n,s.to=r,this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)),this._auto_scroll_delay=webix.delay(function(e,t){this._drag_pause(t),this._auto_scroll(e,t)},this,[webix.html.pos(i),n],250),this.$dropAllow(s,i)&&this.callEvent("onBeforeDragIn",[s,i])?(this.$dragMark(s,i),a):(s.to=s.target=null,this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)),null))},$dropAllow:function(){return!0},_drag_pause:function(e){},_target_to_id:function(e){return e&&"object"==typeof e?e.toString():e},$dragOut:function(e,t,i,n){var s=(this._viewobj.contains(i)?this.locate(n):null)||null,r=webix.DragControl._drag_context;return(r.target||"").toString()==(s||"").toString()?null:(this._auto_scroll_delay&&(this._auto_scroll_force=null,this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)),r.target=r.to=null,this.callEvent("onDragOut",[r,n]),null)},$drop:function(e,t,i){this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));var n=webix.DragControl._drag_context;n.to=this;var s=this._target_to_id(n.target);this.getBranchIndex?s&&(n.parent=this.getParentId(s),n.index=this.getBranchIndex(s)):n.index=s?this.getIndexById(s):this.count(),this.$dragMark({},i),n.from&&n.from!=n.to&&n.from.callEvent&&n.from.callEvent("onBeforeDropOut",[n,i]),this.callEvent("onBeforeDrop",[n,i])&&(this._context_to_move(n,i),this.callEvent("onAfterDrop",[n,i]))},_context_to_move:function(e,t){if(webix.assert(e.from,"Unsopported d-n-d combination"),e.from){var i={parent:e.parent,mode:e.pos};e.from.move(e.source,e.index,e.to,i)}},_getDragItemPos:function(e,t){if(this.getItemNode){var i=this.locate(t,!0),n=i?this.getItemNode(i):null;return n?webix.html.offset(n):n}},$drag:function(e,t){var i=this.locate(t,!0);if(i){var n=[i];if(this.getSelectedId&&!this._do_not_drag_selection){var s=this.getSelectedId(!0,!0);if(s&&s.length>1&&-1!=webix.PowerArray.find.call(s,i)){for(var r={},n=[],a=0;a<s.length;a++)r[s[a]]=!0;for(var a=0;a<this.data.order.length;a++){var o=this.data.order[a];r[o]&&n.push(o)}}}var l=webix.DragControl._drag_context={source:n,start:i};if(l.fragile=this.addRowCss&&webix.env.touch&&(webix.env.isWebKit||webix.env.isFF),l.from=this,this.callEvent("onBeforeDrag",[l,t]))return webix.Touch&&(webix.Touch._start_context=null),l.html||this.$dragHTML(this.getItem(i),t)}return null},$dragHTML:function(e,t){return this._toHTML(e)},$dragMark:function(e,t){var i=null;return e.target&&(i=this._target_to_id(e.target)),this._marked&&this._marked!=i&&(e.fragile||this.removeCss(this._marked,"webix_drag_over"),this._marked=null),!this._marked&&i?(this._marked=i,e.fragile||this.addCss(i,"webix_drag_over"),i):!!e.to}},webix.Group={$init:function(){webix.extend(this.data,webix.GroupStore),this.data.attachEvent("onClearAll",webix.bind(function(){this.data._not_grouped_order=this.data._not_grouped_pull=null,this._group_level_count=0},this))},group:function(e){this.data.ungroup(!0),this.data.group(e)},ungroup:function(e){this.data.ungroup(e)}},webix.GroupMethods={sum:function(e,t){t=t||this;for(var i=0,n=0;n<t.length;n++)i+=1*e(t[n]);return i},min:function(e,t){t=t||this;for(var i=1/0,n=0;n<t.length;n++)1*e(t[n])<i&&(i=1*e(t[n]));return 1*i},max:function(e,t){t=t||this;for(var i=-1/0,n=0;n<t.length;n++)1*e(t[n])>i&&(i=1*e(t[n]));return 1*i},count:function(e,t){for(var i=0,n=0;n<t.length;n++){var s=e(t[n]);null!==s&&void 0!==s&&i++}return i},any:function(e,t){return e(t[0])},string:function(e,t){return e.$name}},webix.GroupStore={$init:function(){this.attachEvent("onClearAll",this._reset_groups)},_reset_groups:function(){this._not_grouped_order=this._not_grouped_pull=null,this._group_level_count=0},ungroup:function(e){if(this.getBranchIndex)return this._ungroup_tree.apply(this,arguments);this._not_grouped_order&&(this.order=this._not_grouped_order,this.pull=this._not_grouped_pull,this._not_grouped_pull=this._not_grouped_order=null,e||this.callEvent("onStoreUpdated",[]))},_group_processing:function(e){this.blockEvent(),this.group(e),this.unblockEvent()},_group_prop_accessor:function(e){if("function"==typeof e)return e;var t=function(t){return t[e]};return t.$name=e,t},group:function(e){if(this.getBranchIndex)return this._group_tree.apply(this,arguments);var t=this._group_prop_accessor(e.by);e.map[t]||(e.map[t]=[t,this._any]);var i={},n=[];this.each(function(s){var r=t(s);i[r]||(n.push({id:r,$group:!0,$row:e.row}),i[r]=webix.toArray()),i[r].push(s)});for(var s in e.map){var r=e.map[s][1]||"any",a=this._group_prop_accessor(e.map[s][0]);"function"!=typeof r&&(webix.assert(webix.GroupMethods[r],"unknown grouping rule: "+r),r=webix.GroupMethods[r]);for(var o=0;o<n.length;o++)n[o][s]=r.call(this,a,i[n[o].id])}this._not_grouped_order=this.order,this._not_grouped_pull=this.pull,this.order=webix.toArray(),this.pull={};for(var o=0;o<n.length;o++){var l=this.id(n[o]);this.pull[l]=n[o],this.order.push(l),this._scheme_init&&this._scheme_init(n[o])}this.callEvent("onStoreUpdated",[])},_group_tree:function(e,t){this._group_level_count=(this._group_level_count||0)+1;var i;"string"==typeof e?(i={by:this._group_prop_accessor(e),map:{}},i.map[e]=[e]):i="function"==typeof e?{by:e,map:{}}:e;var n;t?n=this.getItem(t).$level:(t=0,n=0);for(var s=this.branch[t],r=this._group_prop_accessor(i.by),a=[],o=[],l=0;l<s.length;l++){var h=this.getItem(s[l]),c=r(h),d=n+"$"+c,u=this.branch[d];if(!u){var _=this.pull[d]={id:d,value:c,$group:!0,$row:i.row};this._scheme_init&&this._scheme_init(_),o.push(_),u=this.branch[d]=[],u._formath=[],a.push(d)}u.push(h.id),u._formath.push(h)}this.branch[t]=a;for(var f in i.map){var b=i.map[f][1]||"any",v=this._group_prop_accessor(i.map[f][0]);"function"!=typeof b&&(webix.assert(webix.GroupMethods[b],"unknown grouping rule: "+b),b=webix.GroupMethods[b]);for(var l=0;l<o.length;l++)o[l][f]=b.call(this,v,this.branch[o[l].id]._formath)}for(var l=0;l<o.length;l++){var p=o[l];if(this.hasEvent("onGroupCreated")&&this.callEvent("onGroupCreated",[p.id,p.value,this.branch[p.id]._formath]),i.footer){var g="footer$"+p.id,w=this.pull[g]={id:g,$footer:!0,value:p.value,$level:n,$count:0,$parent:p.id,$row:i.footer.row};for(var f in i.footer){var b=i.footer[f][1]||"any",v=this._group_prop_accessor(i.footer[f][0]);"function"!=typeof b&&(webix.assert(webix.GroupMethods[b],"unknown grouping rule: "+b),b=webix.GroupMethods[b]),w[f]=b.call(this,v,this.branch[o[l].id]._formath)}this.branch[p.id].push(w.id),this.callEvent("onGroupFooter",[w.id,w.value,this.branch[p.id]._formath])}delete this.branch[p.id]._formath}this._fix_group_levels(a,t,n+1),this.callEvent("onStoreUpdated",[])},_ungroup_tree:function(e,t,i){if(i||this._group_level_count){this._group_level_count=Math.max(0,this._group_level_count-1),t=t||0;for(var n=[],s=this.branch[t],r=0;r<s.length;r++){var a=s[r],o=this.branch[a];o&&(n=n.concat(o)),delete this.pull[a],delete this.branch[a]}this.branch[t]=n;for(var r=n.length-1;r>=0;r--)this.pull[n[r]].$footer&&n.splice(r,1);this._fix_group_levels(n,0,1),e||this.callEvent("onStoreUpdated",[])}},_fix_group_levels:function(e,t,i){t&&(this.getItem(t).$count=e.length);for(var n=0;n<e.length;n++){var s=this.pull[e[n]];s.$level=i,s.$parent=t;var r=this.branch[s.id];r&&this._fix_group_levels(r,s.id,i+1)}}},webix.clipbuffer={_area:null,_blur_id:null,_ctrl:0,init:function(){return null!==this._area?this._area:(webix.destructors.push({obj:this}),this._area=document.createElement("textarea"),this._area.className="webix_clipbuffer",this._area.setAttribute("webixignore",1),this._area.setAttribute("spellcheck","false"),this._area.setAttribute("autocapitalize","off"),this._area.setAttribute("autocorrect","off"),this._area.setAttribute("autocomplete","off"),document.body.appendChild(this._area),webix.event(document.body,"keydown",webix.bind(function(e){var t=e.keyCode,i=!(!e.ctrlKey&&!e.metaKey);86===t&&i&&webix.delay(this._paste,this,[e],100)},this)),this._area)},destructor:function(){this._area=null},set:function(e){this.init(),this._area.value=e,this.focus()},focus:function(){this._isSelectRange()||(this.init(),this._area.focus(),this._area.select())},_isSelectRange:function(){var e="";return void 0!==window.getSelection?e=window.getSelection().toString():void 0!==document.selection&&"Text"==document.selection.type&&(e=document.selection.createRange().text),!!e},_paste:function(e){if((e.target||e.srcElement)===this._area){var t=this._area.value,i=webix.UIManager.getFocus();!i||i.getEditor&&i.getEditor()||(i.callEvent("onPaste",[t]),this._area.select())}}},webix.CopyPaste={clipboard_setter:function(e){return!0!==e&&1!==e||(e="modify"),this.attachEvent("onAfterSelect",function(e){if(!this.getEditor||!this.getEditor()){var t=this.getItem(e),i=this.type.templateCopy(t);webix.clipbuffer.set(i,this),webix.clipbuffer.focus(),webix.UIManager.setFocus(this)}}),this.attachEvent("onPaste",function(e){webix.isUndefined(this._paste[this._settings.clipboard])||this._paste[this._settings.clipboard].call(this,e)}),this.attachEvent("onFocus",function(){webix.clipbuffer.focus()}),this.attachEvent("onItemClick",function(e){this._selected&&-1===this._selected.find(e)||(webix.clipbuffer.focus(),webix.UIManager.setFocus(this))}),e},_paste:{insert:function(e){this.add({value:e})},modify:function(e){for(var t=this.getSelectedId(!0),i=0;i<t.length;i++)this.getItem(t[i]).value=e,this.refresh(t[i])},custom:function(e){}},templateCopy_setter:function(e){this.type.templateCopy=webix.template(e)},type:{templateCopy:function(e){return this.template(e)}}},webix.KeysNavigation={$init:function(){this.getSelectedId&&(this.attachEvent("onAfterRender",this._set_focusable_item),this.attachEvent("onAfterSelect",webix.once(function(){if(this.count()>1){var e=this._dataobj.querySelector("["+this._id+"]");e&&e.setAttribute("tabindex","-1")}})))},_set_focusable_item:function(){var e=this.getSelectedId(!0);if(!e.length||!this.getItemNode(e[0])){var t=this._dataobj.querySelector("["+this._id+"]");t&&t.setAttribute("tabindex","0")}},_navigation_helper:function(e){return function(t,i){var n=i.srcElement||i.target;if(!n.getAttribute("webixignore")){var s=n.tagName;if("INPUT"==s||"TEXTAREA"==s||"SELECT"==s)return!0}return!(t&&t.moveSelection&&t.config.navigation&&!t._in_edit_mode)||(webix.html.preventEvent(i),t.moveSelection(e,i.shiftKey))}},moveSelection:function(e,t,i){var n=this._settings;if(!n.disabled){var s=this.getSelectedId(!0),r=this.count&&("x"==n.layout||n.xCount>1);if(("right"==e||"left"==e)&&this._parent_menu){var a=webix.$$(this._parent_menu);return a._hide_sub_menu(!0),void("x"===a.config.layout?a.moveSelection(e):webix.UIManager.setFocus(a))}if(!s.length&&this.count()){if("down"==e||"right"==e&&r)e="top";else{if(!("up"==e||"left"==e&&r))return;e="bottom"}s=[this.getFirstId()]}if(1==s.length){s=s[0];var o=s;if("left"==e&&this.close)return this.close(s);if("right"==e&&this.open)return this.open(s);if("top"==e)s=this.getFirstId();else if("bottom"==e)s=this.getLastId();else if("up"==e||"left"==e||"pgup"==e){var l=this.getIndexById(s),h="pgup"==e?10:1;s=this.getIdByIndex(Math.max(0,l-h))}else{if("down"!=e&&"right"!=e&&"pgdown"!=e)return void webix.assert(!1,"Not supported selection moving mode");var l=this.getIndexById(s),h="pgdown"==e?10:1;s=this.getIdByIndex(Math.min(this.count()-1,l+h))}if(this._skip_item&&(s=this._skip_item(s,o,e)),this.showItem(s),this.select(s),this.getSubMenu&&this.getSubMenu(s)&&this._mouse_move_activation(s,this.getItemNode(s)),!this.config.clipboard&&!1!==i){var c=this.getItemNode(s);c&&c.focus()}}return!1}},navigation_setter:function(e){return e&&!webix.UIManager._global_nav_grid_hotkeys&&(webix.UIManager._global_nav_grid_hotkeys=!0,webix.UIManager.addHotKey("up",this._navigation_helper("up")),webix.UIManager.addHotKey("down",this._navigation_helper("down")),webix.UIManager.addHotKey("shift+up",this._navigation_helper("up")),webix.UIManager.addHotKey("shift+down",this._navigation_helper("down")),webix.UIManager.addHotKey("shift+right",this._navigation_helper("right")),webix.UIManager.addHotKey("shift+left",this._navigation_helper("left")),webix.UIManager.addHotKey("pageup",this._navigation_helper("pgup")),webix.UIManager.addHotKey("pagedown",this._navigation_helper("pgdown")),webix.UIManager.addHotKey("home",this._navigation_helper("top")),webix.UIManager.addHotKey("end",this._navigation_helper("bottom")),webix.UIManager.addHotKey("right",this._navigation_helper("right")),webix.UIManager.addHotKey("left",this._navigation_helper("left"))),e}},webix.TreeStateCheckbox={_init_render_tree_state:function(){if(this._branch_render_supported){var e=this.render;this.render=function(t,i,n){var s=e.apply(this,arguments);this._settings.threeState&&s&&"checkbox"!=i&&this._setThirdState.apply(this,arguments)},this._init_render_tree_state=function(){}}},threeState_setter:function(e){return e&&this._init_render_tree_state(),e},_setThirdState:function(e){var t,i,n,s,r;if(n=[],r=this,e&&!r.data.pull[e]&&(e=0),!e||r.data.pull[e].$count)for(i=this._getAllLeaves(e),i.sort(function(e,t){return r.data.pull[t].$level-r.data.pull[e].$level}),t=0;t<i.length;t++)t&&r.data.pull[i[t]].$parent==r.data.pull[i[t-1]].$parent||(n=n.concat(r._setParentThirdState(i[t])));else n=n.concat(r._setParentThirdState(e));for(s={},t=0;t<n.length;t++)s[n[t]]||(s[n[t]]=1,this._setCheckboxIndeterminate(n[t]));r=null},_setCheckboxIndeterminate:function(e){var t,i;(i=this.getItemNode(e))&&(this.render(e,"checkbox","update"),this.getItem(e).indeterminate&&(i=this.getItemNode(e),(t=i.getElementsByTagName("input")[0])&&(t.indeterminate=this.getItem(e).indeterminate)))},_setParentThirdState:function(e){var t,i,n,s,r,a,o;for(s=this.getParentId(e),this,r=[];s&&"0"!=s;){a=0,i=0,this.data.eachChild(s,function(e){e.indeterminate?a++:e.checked&&i++}),t=n=o=!1;var l=this.getItem(s);i==l.$count?t=!0:(i>0||a>0)&&(n=!0),(n||n!=l.indeterminate)&&(o=!0),l.indeterminate=n,(t||l.checked!=t)&&(o=!0),l.checked=t,o?(r.push(s),s=this.getParentId(s)):s=0}return r},getChecked:function(){var e=[],t=this;return this.data.eachSubItem(0,function(i){t.isChecked(i.id)&&e.push(i.id)}),e},_tree_check_uncheck_3:function(e,t){var i=this.getItem(e);if(i&&(""===t&&(t=!i.checked),i.checked!=t||i.indeterminate)){i.checked=t,this._correctThreeState(e);var n=this._setParentThirdState(e);if(this._branch_render_supported&&n.length<5)for(var s=0;s<n.length;s++)this._setCheckboxIndeterminate(n[s]);else this.refresh();this.callEvent("onItemCheck",[e,t])}},checkItem:function(e){this._tree_check_uncheck(e,!0),this.updateItem(e)},uncheckItem:function(e){this._tree_check_uncheck(e,!1),this.updateItem(e)},_checkUncheckAll:function(e,t,i){var n=t?"checkItem":"uncheckItem";e?this[n](e):e=0,this._settings.threeState?e||this.data.eachChild(0,function(e){this[n](e.id)},this,i):this.data.each(function(e){this[n](e.id)},this,i,e)},checkAll:function(e,t){this._checkUncheckAll(e,!0,t)},uncheckAll:function(e,t){this._checkUncheckAll(e,!1,t)},_correctThreeState:function(e){var t,i=this.getItem(e);i.indeterminate=!1,t=i.checked,this.data.eachSubItem(e,function(e){e.indeterminate=!1,e.checked=t}),this._branch_render_supported&&this.isBranchOpen(i.$parent)&&this.render(e,0,"branch")},isChecked:function(e){return this.getItem(e).checked},_getAllLeaves:function(e){var t=[];return this.data.eachSubItem(e,function(e,i){i||t.push(e.id)}),t}},webix.NavigationButtons={$init:function(){this.$ready.push(function(){this.attachEvent("onKeyPress",this._onKeyPress)})},_moveActive:function(e,t){if(37===e||39===e){webix.html.preventEvent(t),this._showNavItem(37===e?-1:1);var i=this._navPanel.querySelector("[tabindex='0']");i&&i.focus()}},_renderPanel:function(){webix.html.remove(this._navPanel),this._navPanel=webix.html.create("DIV",{class:"webix_nav_panel webix_nav_panel_"+this._settings.navigation.type,role:"tablist"},""),this._viewobj.appendChild(this._navPanel),this._renderNavItems(),this._renderNavButtons(),this._setLinkEventHandler()},_setLinkEventHandler:function(){var e=[];this._navPanel&&(e[0]=webix.event(this._navPanel,"click",webix.bind(function(e){for(var t=e.srcElement||e.target,i=!1;t!=this._navPanel&&!i;){var n=t.getAttribute(this._linkAttr);n&&(i=!0,this._showPanelBind(n)),t=t.parentNode}},this))),this._prevNavButton&&(e[1]=webix.event(this._prevNavButton,"click",webix.bind(function(e){this._showNavItem(-1)},this))),this._nextNavButton&&(e[1]=webix.event(this._nextNavButton,"click",webix.bind(function(e){this._showNavItem(1)},this))),this.attachEvent("onDestruct",function(){for(var t=0;t<e.length;t++)this.detachEvent(e[t]);e=null})},_showNavItem:function(e){if(this._cells){var t=this._active_cell+e;(t>=this._cells.length||t<0)&&(t=t<0?this._cells.length-1:0),this.setActiveIndex(t)}},_showPanelBind:function(e){this._cells&&webix.$$(e).show()},_renderNavItems:function(){var e,t;if(t=this._settings.navigation,t.items){this._linkAttr=t.linkAttr||"bind_id",this._navPanel?this._clearPanel():this._renderPanel();var i=this._cells?this._cells:this.data.order;if(i.length>1)for(var n=0;n<i.length;n++){e=webix.html.create("DIV",{class:"webix_nav_item webix_nav_"+(n==this._active_cell?"active":"inactive"),role:"tab",tabindex:n==this._active_cell?"0":"-1"},"<div></div>");var s=this._cells?this._cells[n]._settings.id:i[n];s&&e.setAttribute(this._linkAttr,s),this._navPanel.appendChild(e)}}},_clearPanel:function(){if(this._navPanel)for(var e=this._navPanel.childNodes,t=e.length-1;t>=0;t--)webix.html.remove(e[t])},_renderNavButtons:function(){var e;e=this._settings.navigation,e.buttons&&(this._prevNavButton&&webix.html.remove(this._prevNavButton),this._prevNavButton&&webix.html.remove(this._nextNavButton),this._prevNavButton=webix.html.create("DIV",{class:"webix_nav_button_"+e.type+" webix_nav_button_prev ",role:"button",tabindex:"0","aria-label":webix.i18n.aria.prevTab},'<div class="webix_nav_button_inner"></div>'),this._viewobj.appendChild(this._prevNavButton),this._nextNavButton=webix.html.create("DIV",{class:"webix_nav_button_"+e.type+" webix_nav_button_next ",role:"button",tabindex:"0","aria-label":webix.i18n.aria.nextTab},'<div class="webix_nav_button_inner"></div>'),this._viewobj.appendChild(this._nextNavButton))}},webix.CustomPrint={$customPrint:function(e,t){if(this._prePrint(e,t))return!0;var i=this._getTableArray(e),n=this._getTableHTML(i,e);if(t)return n;var s=webix.html.create("div",{class:"webix_ui_print"});s.appendChild(n),webix.html.insertBefore(s,e.docFooter,document.body),window.print(),webix.html.remove(s)},_prePrint:function(e,t){if(!t&&("y"==this.config.layout||e.scroll||this.config.prerender||this.config.autoheight))return!0;"x"==this.config.layout&&webix.extend(e||{},{xCount:this.count(),nobreaks:!0},!0)},_getPageWidth:function(e){if("page"==e.fit)return 1/0;var t=e.size,i=t["portrait"==e.mode?"width":"height"];return Math.min(i*webix.env.printPPI-2*webix.env.printMargin)},_getTableArray:function(e,t,i){var n,s,r,a=this._getPageWidth(e),o=e.xCount||this._getVisibleRange()._dx,l=[],h=[],c=0;i=i||0,t=t||[];for(var d=0;d<this.data.order.length;){var u=this.data.pull[this.data.order[d]];if(s=parseInt(d/o),r=d-s*o,u&&r>=i){if((c+=this.type.width)>a&&r>i){n=h.length+i,l.push(h),d+=o-h.length,h=[],c=0;continue}var _=this.type.template(u,this.type),f=this._itemClassName,b={display:"table-cell",height:this.type.height+"px",width:this.type.width+"px"};h.push({txt:_,className:f+" "+(u.$css||""),style:b}),(d+1)%o==0&&(l.push(h),h=[],c=0)}d++}return t.push(l),n&&this._getTableArray(e,t,n),t},_getTableHTML:function(e,t){var i=webix.html.create("div");return e.forEach(webix.bind(function(n,s){var r=webix.html.create("table",{class:"webix_table_print "+this.$view.className,style:"border-collapse:collapse"});if(n.forEach(function(e){var t=webix.html.create("tr");e.forEach(function(e){var i=webix.html.create("td");if(e.txt&&(i.innerHTML=e.txt),e.className&&(i.className=e.className),e.style){Object.keys(e.style).forEach(function(t){e.style[t]&&(i.style[t]=e.style[t])})}e.span&&(e.span.colspan>1&&(i.colSpan=e.span.colspan),e.span.rowspan>1&&(i.rowSpan=e.span.rowspan)),t.appendChild(i)}),r.appendChild(t)}),i.appendChild(r),!t.nobreaks&&s+1<e.length){var a=webix.html.create("DIV",{class:"webix_print_pagebreak"});i.appendChild(a)}},this)),i}},webix.EditAbility={defaults:{editaction:"click"},$init:function(e){this._editors={},this._in_edit_mode=0,this._edit_open_time=0,this._contentobj.style.position="relative",e&&(e.onDblClick=e.onDblClick||{}),this.attachEvent("onAfterRender",this._refocus_inline_editor),this._settings.editable&&this._init_edit_events_once(),webix.extend(this,webix.Undo)},_refocus_try:function(e){try{if("number"==typeof e.selectionStart)e.selectionStart=e.selectionEnd=e.value.length;else if(void 0!==e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}}catch(e){}},_refocus_inline_editor:function(){var e=this.getEditor();if(e&&e.$inline&&!e.getPopup){var t=this._locateInput(e);if(t&&t!=e.node){var i=e.node.value;e.node=t,t.value=i,t.focus(),this._refocus_try(t)}else this.editStop()}},editable_setter:function(e){return e&&this._init_edit_events_once(),e},_init_edit_events_once:function(){webix.attachEvent("onEditEnd",webix.bind(function(){this._in_edit_mode&&this.editStop()},this)),webix.attachEvent("onClick",webix.bind(function(e){this._in_edit_mode&&new Date-this._edit_open_time>200&&(this._last_editor&&!this._last_editor.popupType&&e&&this._last_editor.node&&this._last_editor.node.contains(e.target||e.srcElement)||this.editStop())},this)),this.data.attachEvent&&this.data.attachEvent("onIdChange",webix.bind(function(e,t){this._changeEditorId(e,t)},this)),this.attachEvent("onItemClick",function(e){this._settings.editable&&"click"==this._settings.editaction&&this.edit(e)}),this.attachEvent("onItemDblClick",function(e){this._settings.editable&&"dblclick"==this._settings.editaction&&this.edit(e)}),this._reset_active_editor=webix.bind(function(){this._edit_open_time=new Date},this),this._init_edit_events_once=function(){},this._component_specific_edit_init&&this._component_specific_edit_init()},_handle_live_edits:function(){webix.delay(function(){var e=this.getEditor();if(e&&e.config.liveEdit){var t={value:e.getValue(),old:e.value};if(t.value==t.old)return;e.value=t.value,this._set_new_value(e,t.value,!1),this.callEvent("onLiveEdit",[t,e])}},this)},_show_editor_form:function(e){var t=this._settings.form;"string"!=typeof t&&(this._settings.form=t=webix.ui(t).config.id);var t=webix.$$(t),i=t.setValues?t:t.getChildViews()[0];i.setValues(this.getItem(e.row||e)),t.config.master=this.config.id,t.show(this.getItemNode(e));var n=i.getChildViews()[0];n.focus&&n.focus()},edit:function(e,t,i){if(this.callEvent("onBeforeEditStart",[e])){if(this._settings.form)return this._show_editor_form(e);var n=this._get_editor_type(e);if(n){if(this.getEditor(e))return;t||this.editStop(),webix.assert(webix.editors[n],"Invalid editor type: "+n);var s=webix.extend({},webix.editors[n]),r=this._init_editor(e,s,i);s.config.liveEdit&&(this._live_edits_handler=this.attachEvent("onKeyPress",this._handle_live_edits));var a=s.getPopup?s.getPopup(r)._viewobj:r;return a&&webix._event(a,"click",this._reset_active_editor),r&&webix._event(r,"change",this._on_editor_change,{bind:{view:this,id:e}}),!1!==i&&s.focus(),this.$fixEditor&&this.$fixEditor(s),this._edit_open_time=webix.edit_open_time=new Date,webix.UIManager.setFocus(this,!0),this.callEvent("onAfterEditStart",[e]),s}return null}},getEditor:function(e){return e?this._editors[e]:this._last_editor},_changeEditorId:function(e,t){var i=this._editors[e];i&&(this._editors[t]=i,i.id=t,delete this._editors[e])},_on_editor_change:function(e){this.view.hasEvent("onEditorChange")&&this.view.callEvent("onEditorChange",[this.id,this.view.getEditorValue(this.id)])},_get_edit_config:function(e){return this._settings},_init_editor:function(e,t,i){var n=(t.config=this._get_edit_config(e),t.render());t.$inline&&(n=this._locateInput(e)),t.node=n;var s=this.getItem(e),r=s[this._settings.editValue||"value"];return webix.isUndefined(r)&&(r=""),t.setValue(r,s),t.value=r,this._addEditor(e,t),!1!==i&&this.showItem(e),t.$inline||this._sizeToCell(e,n,!0),t.afterRender&&t.afterRender(),n},_locate_cell:function(e){return this.getItemNode(e)},_locateInput:function(e){var t=this._locate_cell(e);return t&&(t=t.getElementsByTagName("input")[0]||t),t},_get_editor_type:function(e){return this._settings.editor},_addEditor:function(e,t){t.id=e,this._editors[e]=this._last_editor=t,this._in_edit_mode++},_removeEditor:function(e){this._last_editor==e&&(this._last_editor=0),e.destroy&&e.destroy(),delete e.popup,delete e.node,delete this._editors[e.id],this._in_edit_mode--},focusEditor:function(e){var t=this.getEditor.apply(this,arguments);t&&t.focus&&t.focus()},editCancel:function(){this.editStop(null,null,!0)},_applyChanges:function(e){if(e){var t=this.getEditor();if(t&&t.getPopup&&t.getPopup()==e.getTopParentView())return}this.editStop()},editStop:function(e){if(!this._edit_stop){this._edit_stop=1;var t=arguments[2],i=1;return e?i=this._editStop(this._editors[e],t):this._for_each_editor(function(e){i*=this._editStop(e,t)}),this._edit_stop=0,i}},_cellPosition:function(e){var t=this.getItemNode(e);return{left:t.offsetLeft,top:t.offsetTop,height:t.offsetHeight,width:t.offsetWidth,parent:this._contentobj}},_sizeToCell:function(e,t,i){if(t.style){var n=this._cellPosition(e);t.style.top=n.top+"px",t.style.left=n.left+"px",t.style.width=n.width-1+"px",t.style.height=n.height-1+"px",t.top=n.top,i&&n.parent.appendChild(t)}},_for_each_editor:function(e){for(var t in this._editors)e.call(this,this._editors[t])},_editStop:function(e,t){if(e){var i={value:e.getValue(),old:e.value};if(this.callEvent("onBeforeEditStop",[i,e,t])){if(!t){var n=i.old;if("string"==typeof i.value&&(n+=""),n!=i.value||e.config.liveEdit){var s=this._set_new_value(e,i.value,!0);this.updateItem(e.row||e.id,s)}}e.$inline?e.node=null:webix.html.remove(e.node);var r=e.config.suggest;return r&&"string"==typeof r&&webix.$$(r).hide(),this._removeEditor(e),this._live_edits_handler&&this.detachEvent(this._live_edits_handler),this.callEvent("onAfterEditStop",[i,e,t]),1}return 0}},validateEditor:function(e){var t=!0;if(this._settings.rules){var i=this.getEditor(e),n=i.column||this._settings.editValue||"value",s=this._settings.rules[n],r=this._settings.rules.$all;if(s||r){var a=this.data.getItem(i.row||i.id),o=i.getValue(),l=i.getInputNode();s&&(t=s.call(this,o,a,n)),r&&(t=r.call(this,o,a,n)&&t),t?webix.html.removeCss(l,"webix_invalid"):webix.html.addCss(l,"webix_invalid"),webix.callEvent("onLiveValidation",[i,t,a,o])}}return t},getEditorValue:function(e){var t;if(t=0===arguments.length?this._last_editor:this.getEditor(e))return t.getValue()},getEditState:function(){return this._last_editor||!1},editNext:function(e,t){if(e=!1!==e,1==this._in_edit_mode||t){var i=this._find_cell_next(this._last_editor||t,function(e){return!!this._get_editor_type(e)},e);if(this.editStop())return i&&(this.edit(i),this._after_edit_next(i)),!1}},_after_edit_next:function(){},_find_cell_next:function(e,t,i){var n=this.getIndexById(e.id),s=this.data.order;if(i){for(var r=n+1;r<s.length;r++)if(t.call(this,s[r]))return s[r]}else for(var r=n-1;r>=0;r--)if(t.call(this,s[r]))return s[r];return null},_set_new_value:function(e,t,i){var n=i?{}:this.getItem(e.id);return n[this._settings.editValue||"value"]=t,n}},function(){function e(e,i){var n=e.config.suggest;if(n){var s=e.config.suggest=t(n),r=webix.$$(s);r&&i&&r.linkInput(i)}}function t(e){return"string"==typeof e?e:e.linkInput?e._settings.id:("object"==typeof e?(webix.isArray(e)&&(e={data:e}),e.view=e.view||"suggest"):!0===e&&(e={view:"suggest"}),webix.ui(e).config.id)}function i(e){return((e.header&&e.header[0]?e.header[0].text:e.editValue||e.label)||"").toString().replace(/<[^>]*>/g,"")}webix.editors={text:{focus:function(){this.getInputNode(this.node).focus(),this.getInputNode(this.node).select()},getValue:function(){return this.getInputNode(this.node).value},setValue:function(t){var i=this.getInputNode(this.node);i.value=t,e(this,i)},getInputNode:function(){return this.node.firstChild},render:function(){return webix.html.create("div",{class:"webix_dt_editor"},"<input type='text' aria-label='"+i(this.config)+"'>")}},"inline-checkbox":{render:function(){return{}},getValue:function(){return this.node.checked},setValue:function(){},focus:function(){this.node.focus()},getInputNode:function(){},$inline:!0},"inline-text":{render:function(){return{}},getValue:function(){return this.node.value},setValue:function(){},focus:function(){try{
this.node.select(),this.node.focus()}catch(e){}},getInputNode:function(){},$inline:!0},checkbox:{focus:function(){this.getInputNode().focus()},getValue:function(){return this.getInputNode().checked},setValue:function(e){this.getInputNode().checked=!!e},getInputNode:function(){return this.node.firstChild.firstChild},render:function(){return webix.html.create("div",{class:"webix_dt_editor"},"<div><input type='checkbox' aria-label='"+i(this.config)+"'></div>")}},select:{focus:function(){this.getInputNode().focus()},getValue:function(){return this.getInputNode().value},setValue:function(e){this.getInputNode().value=e},getInputNode:function(){return this.node.firstChild},render:function(){var e="",t=this.config.options||this.config.collection;if(webix.assert(t,"options not defined for select editor"),t.data&&t.data.each)t.data.each(function(t){e+="<option value='"+t.id+"'>"+t.value+"</option>"});else if(webix.isArray(t))for(var n=0;n<t.length;n++){var s=t[n],r=webix.isUndefined(s.id),a=r?s:s.id,o=r?s:s.value;e+="<option value='"+a+"'>"+o+"</option>"}else for(var l in t)e+="<option value='"+l+"'>"+t[l]+"</option>";return webix.html.create("div",{class:"webix_dt_editor"},"<select aria-label='"+i(this.config)+"'>"+e+"</select>")}},popup:{focus:function(){this.getInputNode().focus()},destroy:function(){this.getPopup().hide()},getValue:function(){return this.getInputNode().getValue()||""},setValue:function(e){this.getPopup().show(this.node),this.getInputNode().setValue(e)},getInputNode:function(){return this.getPopup().getChildViews()[0]},getPopup:function(){return this.config.popup||(this.config.popup=this.createPopup()),webix.$$(this.config.popup)},createPopup:function(){var e=this.config.popup||this.config.suggest;if(e){var t;return"object"!=typeof e||e.name?t=webix.$$(e):(e.view=e.view||"suggest",t=webix.ui(e)),t.linkInput?t.linkInput(document.body):this.linkInput&&this.linkInput(document.body),t}var i=webix.editors.$popup[this.popupType];return"string"!=typeof i&&(i=webix.editors.$popup[this.popupType]=webix.ui(i),this.popupInit(i),i.linkInput||this.linkInput(document.body)),i._settings.id},linkInput:function(e){webix._event(webix.toNode(e),"keydown",webix.bind(function(e){var t=e.which||e.keyCode,i=this.getInputNode();i.isVisible()&&(40===t?(i.moveSelection&&i.moveSelection("down"),webix.UIManager.setFocus(i)):13!==t||"TEXTAREA"===e.target.nodeName&&e.shiftKey||webix.callEvent("onEditEnd",[]))},this))},popupInit:function(e){},popupType:"text",render:function(){return{}},$inline:!0}},webix.editors.color=webix.extend({focus:function(){},popupType:"color",popupInit:function(e){e.getChildViews()[0].attachEvent("onSelect",function(e){webix.callEvent("onEditEnd",[e])})}},webix.editors.popup),webix.editors.date=webix.extend({focus:function(){},popupType:"date",setValue:function(e){this._is_string=this.config.stringResult||e&&"string"==typeof e,webix.editors.popup.setValue.call(this,e)},getValue:function(){return this.getInputNode().getValue(this._is_string?webix.i18n.parseFormatStr:"")||""},popupInit:function(e){e.getChildViews()[0].attachEvent("onDateSelect",function(e){webix.callEvent("onEditEnd",[e])})}},webix.editors.popup),webix.editors.combo=webix.extend({_create_suggest:function(e){return this.config.popup?this.config.popup.config.id:e?t(e):this._shared_suggest(e)},_shared_suggest:function(){var e=webix.editors.combo;return e._suggest=e._suggest||this._create_suggest(!0)},render:function(){var e=webix.html.create("div",{class:"webix_dt_editor"},"<input type='text' role='combobox' aria-label='"+i(this.config)+"'>"),t=this.config.suggest=this._create_suggest(this.config.suggest);return t&&(webix.$$(t).linkInput(e.firstChild,!0),webix._event(e.firstChild,"click",webix.bind(this.showPopup,this))),e},getPopup:function(){return webix.$$(this.config.suggest)},showPopup:function(){var e=this.getPopup(),t=e.getList(),i=this.getInputNode(),n=this.getValue();e.show(i),i.setAttribute("aria-expanded","true"),n?(webix.assert(t.exists(n),"Option with ID "+n+" doesn't exist"),t.exists(n)&&(t.select(n),t.showItem(n))):(t.unselect(),t.showItem(t.getFirstId())),e._last_input_target=i},afterRender:function(){this.showPopup()},setValue:function(e){if(this._initial_value=e,this.config.suggest){var t=webix.$$(this.config.suggest),i=this.config.collection||this.config.options;i&&t.getList().data.importData(i),this._initial_text=this.getInputNode(this.node).value=t.getItemText(e)}},getValue:function(){var e=this.getInputNode().value;return this.config.suggest?e==this._initial_text?this._initial_value:webix.$$(this.config.suggest).getSuggestion():e}},webix.editors.text),webix.editors.richselect=webix.extend({focus:function(){},getValue:function(){return this.getPopup().getValue()},setValue:function(e){var t=this.config.collection||this.config.options;this.getInputNode();t&&this.getPopup().getList().data.importData(t),this.getPopup().show(this.node),this.getPopup().setValue(e)},getInputNode:function(){return this.getPopup().getList()},popupInit:function(e){e.linkInput(document.body)},popupType:"richselect"},webix.editors.popup),webix.editors.password=webix.extend({render:function(){return webix.html.create("div",{class:"webix_dt_editor"},"<input type='password' aria-label='"+i(this.config)+"'>")}},webix.editors.text),webix.editors.$popup={text:{view:"popup",width:250,height:150,body:{view:"textarea"}},color:{view:"popup",body:{view:"colorboard"}},date:{view:"popup",width:250,height:250,padding:0,body:{view:"calendar",icons:!0,borderless:!0}},richselect:{view:"suggest",body:{view:"list",select:!0}}}}(),webix.VirtualRenderStack={$init:function(){webix.assert(this.render,"VirtualRenderStack :: Object must use RenderStack first"),this._htmlmap={},webix._event(this._viewobj,"scroll",webix.bind(this._render_visible_rows,this)),webix.env.touch&&this.attachEvent("onAfterScroll",webix.bind(this._render_visible_rows,this)),this._unrendered_area=[]},getItemNode:function(e){return this._htmlmap[e]},showItem:function(e){var t=this._getVisibleRange(),i=this.data.getIndexById(e),n=Math.floor(i/t._dx)*t._y,s=this.getScrollState();(n<s.y||n+this._settings.height>=s.y+this._content_height)&&this.scrollTo(0,n)},render:function(e,t,i){if(this.isVisible(this._settings.id)&&!this.$blockRender)if(webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id),e){var n=this.getItemNode(e);switch(i){case"update":if(!n)return;var s=this._htmlmap[e]=this._toHTMLObject(t);webix.html.insertBefore(s,n),webix.html.remove(n);break;default:this._render_delayed()}}else this.callEvent("onBeforeRender",[this.data])&&(this._htmlmap={},this._render_visible_rows(null,!0),this._wait_for_render=!1,this.callEvent("onAfterRender",[]))},_render_delayed:function(){this._wait_for_render||(this._wait_for_render=!0,window.setTimeout(webix.bind(function(){this.render()},this),1))},_create_placeholder:function(e){webix.env.maxHTMLElementSize&&(e=Math.min(webix.env.maxHTMLElementSize,e));var t=document.createElement("DIV");return t.style.cssText="height:"+e+"px; width:100%; overflow:hidden;",t},_render_visible_rows:function(e,t){this._unrendered_area=[];var i=this._getVisibleRange();this._dataobj.firstChild&&!t||(this._dataobj.innerHTML="",this._dataobj.appendChild(this._create_placeholder(i._max)),this._htmlrows=[this._dataobj.firstChild]);for(var n=i._from;n<=i._height;){for(;this._htmlrows[n]&&this._htmlrows[n]._filled&&n<=i._height;)n++;if(n>i._height)break;for(var s=n;!this._htmlrows[s];)s--;var r=this._htmlrows[s],a=n*i._dx+(this.data.$min||0);if(a>(this.data.$max||1/0))break;var o=Math.min(a+i._dx-1,this.data.$max?this.data.$max-1:1/0),l=this._create_placeholder(i._y),h=this.data.getIndexRange(a,o);if(!h.length)break;for(var c={$template:"Loading"},d=0;d<h.length;d++)h[d]||this._unrendered_area.push(a+d),h[d]=this._toHTML(h[d]||c);l.innerHTML=h.join("");for(var d=0;d<h.length;d++)this._htmlmap[this.data.getIdByIndex(a+d)]=l.childNodes[d];var u=parseFloat(r.style.height,10),_=(n-s)*i._y,f=u-_-i._y;if(webix.html.insertBefore(l,_?r.nextSibling:r,this._dataobj),this._htmlrows[n]=l,l._filled=!0,_<=0&&f>0)r.style.height=f+"px",this._htmlrows[n+1]=r;else if(_<0?webix.html.remove(r):r.style.height=_+"px",f>0){var b=this._htmlrows[n+1]=this._create_placeholder(f);webix.html.insertBefore(b,l.nextSibling,this._dataobj)}n++}if(this._unrendered_area.length){var v=this._unrendered_area[0],p=this._unrendered_area.pop()+1;if(p>v){var g=p-v;if(this._maybe_loading_already(g,v))return;g=Math.max(g,this._settings.datafetch||this._settings.loadahead||0),this.loadNext(g,v)}}},_getVisibleRange:function(){var e=this.getScrollState(),t=e.y,i=this._content_width,n=this._content_height,s=this.type,r=Math.floor(i/s.width)||1,a=Math.floor(t/s.height),o=Math.ceil((n+t)/s.height)-1,l=this.data.$max?this.data.$max-this.data.$min:this.data.count();return{_from:a,_height:o,_top:t,_max:Math.ceil(l/r)*s.height,_y:s.height,_dx:r}},_cellPosition:function(e){var t=this.getItemNode(e);return t||(this.showItem(e),this._render_visible_rows(),t=this.getItemNode(e)),{left:t.offsetLeft,top:t.offsetTop,height:t.offsetHeight,width:t.offsetWidth,parent:this._contentobj}}},webix.DataDriver.htmltable={toObject:function(e){e=webix.toNode(e),webix.assert(e,"table is not found"),webix.assert("table"===e.tagName.toLowerCase(),"Incorrect table object");var t=e.rows;return webix.html.remove(e),t},getRecords:function(e){for(var t=[],i=e[0]&&e[0]._webix_skip?1:0;i<e.length;i++)t.push(e[i]);return t},getDetails:function(e){var t=e.getElementsByTagName("td");e={};for(var i=0;i<t.length;i++)e["data"+i]=t[i].innerHTML;return e},getInfo:function(e){return{size:0,from:0}},getOptions:function(){},getConfig:function(e){var t=[],i=e[0].getElementsByTagName("th");i.length&&(e[0]._webix_skip=!0);for(var n=0;n<i.length;n++){var s={id:"data"+n,header:this._de_json(i[n].innerHTML)},r=this._get_attrs(i[n]);s=webix.extend(s,r),t.push(s)}return t},_de_json:function(e){var t=e.indexOf("json://");return-1!=t&&(e=JSON.parse(e.substr(t+7))),e},_get_attrs:function(e){for(var t=e.attributes,i={},n=0;n<t.length;n++)i[t[n].nodeName]=this._de_json(t[n].nodeValue);return i.width=parseInt(i.width,10),i}},webix.Number={format:function(e,t){if(""===e||void 0===e)return e;t=t||webix.i18n,e=parseFloat(e);var i=e<0?"-":"";e=Math.abs(e);var n=e.toFixed(t.decimalSize).toString();n=n.split(".");var s="";if(t.groupSize){var r=t.groupSize,a=n[0].length;do{a-=r;s=(a>0?n[0].substr(a,r):n[0].substr(0,r+a))+(s?t.groupDelimiter+s:"")}while(a>0)}else s=n[0];return t.decimalSize?i+s+t.decimalDelimiter+n[1]:i+s},numToStr:function(e){return function(t){return webix.Number.format(t,e)}}},webix.Date={startOnMonday:!1,toFixed:function(e){return e<10?"0"+e:e},weekStart:function(e){e=this.copy(e);var t=e.getDay();return this.startOnMonday&&(0===t?t=6:t--),this.datePart(this.add(e,-1*t,"day"))},monthStart:function(e){return e=this.copy(e),e.setDate(1),this.datePart(e)},yearStart:function(e){return e=this.copy(e),e.setMonth(0),this.monthStart(e)},dayStart:function(e){return this.datePart(e,!0)},dateToStr:function(e,t){return"function"==typeof e?e:webix.env.strict?function(t){var i="",n=0;return e.replace(/%[a-zA-Z]/g,function(s,r){i+=e.slice(n,r);i+=function(e){if("%d"==s)return webix.Date.toFixed(e.getDate());if("%m"==s)return webix.Date.toFixed(e.getMonth()+1);if("%j"==s)return e.getDate();if("%n"==s)return e.getMonth()+1;if("%y"==s)return webix.Date.toFixed(e.getFullYear()%100);if("%Y"==s)return e.getFullYear();if("%D"==s)return webix.i18n.calendar.dayShort[e.getDay()];if("%l"==s)return webix.i18n.calendar.dayFull[e.getDay()];if("%M"==s)return webix.i18n.calendar.monthShort[e.getMonth()];if("%F"==s)return webix.i18n.calendar.monthFull[e.getMonth()];if("%h"==s)return webix.Date.toFixed((e.getHours()+11)%12+1);if("%g"==s)return(e.getHours()+11)%12+1;if("%G"==s)return e.getHours();if("%H"==s)return webix.Date.toFixed(e.getHours());if("%i"==s)return webix.Date.toFixed(e.getMinutes());if("%a"==s)return e.getHours()>11?webix.i18n.pm[0]:webix.i18n.am[0];if("%A"==s)return e.getHours()>11?webix.i18n.pm[1]:webix.i18n.am[1];if("%s"==s)return webix.Date.toFixed(e.getSeconds());if("%S"==s)return webix.Date.toFixed(e.getMilliseconds());if("%W"==s)return webix.Date.toFixed(webix.Date.getISOWeek(e));if("%c"==s){var t=e.getFullYear();return t+="-"+webix.Date.toFixed(e.getMonth()+1),t+="-"+webix.Date.toFixed(e.getDate()),t+="T",t+=webix.Date.toFixed(e.getHours()),t+=":"+webix.Date.toFixed(e.getMinutes()),t+=":"+webix.Date.toFixed(e.getSeconds())}return s}(t),n=r+2}),i+=e.slice(n,e.length)}:(e=e.replace(/%[a-zA-Z]/g,function(e){switch(e){case"%d":return'"+webix.Date.toFixed(date.getDate())+"';case"%m":return'"+webix.Date.toFixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+webix.Date.toFixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+webix.i18n.calendar.dayShort[date.getDay()]+"';case"%l":return'"+webix.i18n.calendar.dayFull[date.getDay()]+"';case"%M":return'"+webix.i18n.calendar.monthShort[date.getMonth()]+"';case"%F":return'"+webix.i18n.calendar.monthFull[date.getMonth()]+"';case"%h":return'"+webix.Date.toFixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+webix.Date.toFixed(date.getHours())+"';case"%i":return'"+webix.Date.toFixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?webix.i18n.pm[0]:webix.i18n.am[0])+"';case"%A":return'"+(date.getHours()>11?webix.i18n.pm[1]:webix.i18n.am[1])+"';case"%s":return'"+webix.Date.toFixed(date.getSeconds())+"';case"%S":return'"+webix.Date.toFixed(date.getMilliseconds())+"';case"%W":return'"+webix.Date.toFixed(webix.Date.getISOWeek(date))+"';case"%c":var i='"+date.getFullYear()+"';return i+='-"+webix.Date.toFixed((date.getMonth()+1))+"',i+='-"+webix.Date.toFixed(date.getDate())+"',i+="T",i+='"+webix.Date.toFixed(date.getHours())+"',i+=':"+webix.Date.toFixed(date.getMinutes())+"',i+=':"+webix.Date.toFixed(date.getSeconds())+"',!0===t&&(i+="Z"),i;default:return e}}),!0===t&&(e=e.replace(/date\.get/g,"date.getUTC")),new Function("date","if (!date) return ''; if (!date.getMonth) date=webix.i18n.parseFormatDate(date);  return \""+e+'";'))},strToDate:function(e,t){if("function"==typeof e)return e;var i,n,s,r=e.match(/%[a-zA-Z]/g),a="var temp=date.split(/[^0-9a-zA-Z]+/g);";if(!webix.i18n.calendar.monthShort_hash){for(s=webix.i18n.calendar.monthShort,n=webix.i18n.calendar.monthShort_hash={},i=0;i<s.length;i++)n[s[i]]=i;for(s=webix.i18n.calendar.monthFull,n=webix.i18n.calendar.monthFull_hash={},i=0;i<s.length;i++)n[s[i]]=i}if(webix.env.strict)return function(e){if(!e)return"";if("object"==typeof e)return e;var n=e.split(/[^0-9a-zA-Z]+/g),s=[0,0,1,0,0,0,0];for(i=0;i<r.length;i++){var a=r[i];if("%y"==a)s[0]=1*n[i]+(n[i]>30?1900:2e3);else if("%Y"==a)s[0]=1*(n[i]||0),s[0]<30&&(s[0]+=2e3);else if("%n"==a||"%m"==a)s[1]=(n[i]||1)-1;else if("%M"==a)s[1]=webix.i18n.calendar.monthShort_hash[n[i]]||0;else if("%F"==a)s[1]=webix.i18n.calendar.monthFull_hash[n[i]]||0;else if("%j"==a||"%d"==a)s[2]=n[i]||1;else if("%g"==a||"%G"==a||"%h"==a||"%H"==a)s[3]=n[i]||0;else if("%a"==a)s[3]=s[3]%12+((n[i]||"")==webix.i18n.am[0]?0:12);else if("%A"==a)s[3]=s[3]%12+((n[i]||"")==webix.i18n.am[1]?0:12);else if("%i"==a)s[4]=n[i]||0;else if("%s"==a)s[5]=n[i]||0;else if("%S"==a)s[6]=n[i]||0;else if("%c"==a){var o=/(\d+)-(\d+)-(\d+)T(\d+):(\d+):(\d+)(\+.*|)/g,l=o.exec(e);s[0]=1*(l[1]||0),s[0]<30&&(s[0]+=2e3),s[1]=(l[2]||1)-1,s[2]=l[3]||1,s[3]=l[4]||0,s[4]=l[5]||0,s[5]=l[6]||0}}return t?new Date(Date.UTC(s[0],s[1],s[2],s[3],s[4],s[5],s[6])):new Date(s[0],s[1],s[2],s[3],s[4],s[5],s[6])};for(i=0;i<r.length;i++)switch(r[i]){case"%j":case"%d":a+="set[2]=temp["+i+"]||1;";break;case"%n":case"%m":a+="set[1]=(temp["+i+"]||1)-1;";break;case"%y":a+="set[0]=temp["+i+"]*1+(temp["+i+"]>30?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":a+="set[3]=temp["+i+"]||0;";break;case"%i":a+="set[4]=temp["+i+"]||0;";break;case"%Y":a+="set[0]=(temp["+i+"]||0)*1; if (set[0]<30) set[0]+=2000;";break;case"%a":a+="set[3]=set[3]%12+(temp["+i+"]==webix.i18n.am[0]?0:12);";break;case"%A":a+="set[3]=set[3]%12+(temp["+i+"]==webix.i18n.am[1]?0:12);";break;case"%s":a+="set[5]=temp["+i+"]||0;";break;case"%S":a+="set[6]=temp["+i+"]||0;";break;case"%M":a+="set[1]=webix.i18n.calendar.monthShort_hash[temp["+i+"]]||0;";break;case"%F":a+="set[1]=webix.i18n.calendar.monthFull_hash[temp["+i+"]]||0;";break;case"%c":a+="var res = date.split('T');",a+="if(res[0]){ var d = res[0].split('-');",a+="set[0]= (d[0]||0)*1; if (set[0]<30) set[0]+=2000;",a+="set[1]= (d[1]||1)-1;",a+="set[2]= d[2]||1;}",a+="if(res[1]){ var t = res[1].split(':');",a+="set[3]= t[0]||0;",a+="set[4]= t[1]||0;",a+="set[5]= parseInt(t[2])||0;}"}var o="set[0],set[1],set[2],set[3],set[4],set[5], set[6]";return t&&(o=" Date.UTC("+o+")"),new Function("date","if (!date) return ''; if (typeof date == 'object') return date; var set=[0,0,1,0,0,0,0]; "+a+" return new Date("+o+");")},getISOWeek:function(e){if(!e)return!1;var t=e.getDay();0===t&&(t=7);var i=new Date(e.valueOf());i.setDate(e.getDate()+(4-t));var n=i.getFullYear(),s=Math.floor((i.getTime()-new Date(n,0,1).getTime())/864e5);return 1+Math.floor(s/7)},getUTCISOWeek:function(e){return this.getISOWeek(e)},_correctDate:function(e,t,i,n){if(i){var s=n(e,t);if(s)for(var r=i>0?1:-1;s;)e.setHours(e.getHours()+r),s=n(e,t),r+=i>0?1:-1}},add:function(e,t,i,n){n&&(e=this.copy(e));var s=webix.Date.copy(e);switch(i){case"day":e.setDate(e.getDate()+t),this._correctDate(e,s,t,function(e,t){return webix.Date.datePart(t,!0).valueOf()==webix.Date.datePart(e,!0).valueOf()});break;case"week":e.setDate(e.getDate()+7*t),this._correctDate(e,s,7*t,function(e,t){return webix.Date.datePart(t,!0).valueOf()==webix.Date.datePart(e,!0).valueOf()});break;case"month":e.setMonth(e.getMonth()+t),this._correctDate(e,s,t,function(e,t){return t.getMonth()==e.getMonth()&&t.getYear()==e.getYear()});break;case"year":e.setYear(e.getFullYear()+t),this._correctDate(e,s,t,function(e,t){return t.getFullYear()==e.getFullYear()});break;case"hour":e.setHours(e.getHours()+t),this._correctDate(e,s,t,function(e,t){return t.getHours()==e.getHours()&&webix.Date.datePart(t,!0)==webix.Date.datePart(e,!0)});break;case"minute":e.setMinutes(e.getMinutes()+t);break;default:webix.Date.add[i](e,t,i)}return e},datePart:function(e,t){t&&(e=this.copy(e));var i=this.copy(e);return i.setHours(0),i.getDate()!=e.getDate()?e.setHours(1):e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},timePart:function(e,t){return t&&(e=this.copy(e)),(e.valueOf()/1e3-60*e.getTimezoneOffset())%86400},copy:function(e){return new Date(e.valueOf())},equal:function(e,t){return!(!e||!t)&&e.valueOf()===t.valueOf()},isHoliday:function(e){if(0===(e=e.getDay())||6==e)return"webix_cal_event"}},webix.i18n={_dateMethods:["fullDateFormat","timeFormat","dateFormat","longDateFormat","parseFormat","parseTimeFormat"],parseFormat:"%Y-%m-%d %H:%i",parseTimeFormat:"%H:%i",numberFormat:webix.Number.format,priceFormat:function(e){return webix.i18n._price_format(webix.i18n.numberFormat(e,webix.i18n._price_settings))},setLocale:function(e){var t=function(e,i){for(var n in i)"object"!=typeof i[n]||webix.isArray(i[n])?e[n]=i[n]:(e[n]||(e[n]={}),t(e[n],i[n]))};"string"==typeof e&&(e=this.locales[e]),e&&t(this,e);for(var i=webix.i18n._dateMethods,n=0;n<i.length;n++){var s=i[n],r=webix.i18n[s+"UTC"];webix.i18n[s+"Str"]=webix.Date.dateToStr(webix.i18n[s],r),webix.i18n[s+"Date"]=webix.Date.strToDate(webix.i18n[s],r)}this._price_format=webix.template(this.price),this._price_settings=this.priceSettings||this,this.intFormat=webix.Number.numToStr({groupSize:this.groupSize,groupDelimiter:this.groupDelimiter,decimalSize:0})}},webix.i18n.locales={},webix.i18n.locales["en-US"]={groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2,dateFormat:"%m/%d/%Y",timeFormat:"%h:%i %A",longDateFormat:"%d %F %Y",fullDateFormat:"%m/%d/%Y %h:%i %A",am:["am","AM"],pm:["pm","PM"],price:"${obj}",priceSettings:{groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2},fileSize:["b","Kb","Mb","Gb","Tb","Pb","Eb"],calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today"},controls:{select:"Select",invalidMessage:"Invalid input value"},dataExport:{page:"Page",of:"of"},PDFviewer:{of:"of",automaticZoom:"Automatic Zoom",actualSize:"Actual Size",pageFit:"Page Fit",pageWidth:"Page Width",pageHeight:"Page Height"},aria:{calendar:"Calendar",increaseValue:"Increase value",decreaseValue:"Decrease value",navMonth:["Previous month","Next month"],navYear:["Previous year","Next year"],navDecade:["Previous decade","Next decade"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Hours: %h %A",minuteFormat:"Minutes: %i",removeItem:"Remove item",pages:["First page","Previous page","Next page","Last page"],page:"Page",headermenu:"Header menu",openGroup:"Open column group",closeGroup:"Close column group",closeTab:"Close tab",showTabs:"Show more tabs",resetTreeMap:"Reset tree map",navTreeMap:"Level up",nextTab:"Next tab",prevTab:"Previous tab",multitextSection:"Add section",multitextextraSection:"Remove section",showChart:"Show chart",hideChart:"Hide chart",resizeChart:"Resize chart"},richtext:{underline:"Underline",bold:"Bold",italic:"Italic"}},webix.i18n.setLocale("en-US"),webix.ui.datafilter={textWaitDelay:500,summColumn:{getValue:function(e){return e.firstChild.innerHTML},setValue:function(){},refresh:function(e,t,i){var n=0;e.mapCells(null,i.columnId,null,1,function(e){e*=1,isNaN(e)||(n+=e)},!0),i.format&&(n=i.format(n)),i.template&&(n=i.template({value:n})),t.firstChild.innerHTML=n},trackCells:!0,render:function(e,t){return t.template&&(t.template=webix.template(t.template)),""}},masterCheckbox:{getValue:function(){},setValue:function(){},getHelper:function(e,t){return{check:function(){t.checked=!1,e.onclick()},uncheck:function(){t.checked=!0,e.onclick()},isChecked:function(){return t.checked}}},refresh:function(e,t,i){t.onclick=function(){this.getElementsByTagName("input")[0].checked=i.checked=!i.checked;var t=e.getColumnConfig(i.columnId),n=i.checked?t.checkValue:t.uncheckValue;e.data.each(function(t){t&&(t[i.columnId]=n,e.callEvent("onCheck",[t.id,i.columnId,n]),this.callEvent("onStoreUpdated",[t.id,t,"save"]))}),e.refresh()}},render:function(e,t){return"<input type='checkbox' "+(t.checked?"checked='1'":"")+">"}},textFilter:{getInputNode:function(e){return e.firstChild?e.firstChild.firstChild:{value:null}},getValue:function(e){return this.getInputNode(e).value},setValue:function(e,t){this.getInputNode(e).value=t},refresh:function(e,t,i){t.component=e._settings.id,e.registerFilter(t,i,this),t._comp_id=e._settings.id,i.value&&this.getValue(t)!=i.value&&this.setValue(t,i.value),t.onclick=webix.html.preventEvent,webix._event(t,"keydown",this._on_key_down)},render:function(e,t){return this.init&&this.init(t),t.css="webix_ss_filter","<input "+(t.placeholder?'placeholder="'+t.placeholder+'" ':"")+"type='text'>"},_on_key_down:function(e,t,i){var n=this._comp_id;9!=(e.which||e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=webix.$$(n);e&&e.filterByAll()},webix.ui.datafilter.textWaitDelay))}},selectFilter:{getInputNode:function(e){return e.firstChild?e.firstChild.firstChild:{value:null}},getValue:function(e){return this.getInputNode(e).value},setValue:function(e,t){this.getInputNode(e).value=t},refresh:function(e,t,i){i.compare=i.compare||function(e,t){return e==t},t.component=e._settings.id,e.registerFilter(t,i,this);var n,s=i.options;s?"string"==typeof s?(n=i.options=[],webix.ajax(s).then(webix.bind(function(n){i.options=n.json(),this.refresh(e,t,i)},this))):n=s:(n=e.collectValues(i.columnId),n.unshift({id:"",value:""}));var r=webix.$$(s);r&&r.data&&r.data.getRange&&(n=r.data.getRange());for(var a=document.createElement("select"),o=0;o<n.length;o++){var l=document.createElement("option");l.value=n[o].id,l.text=n[o].value,a.add(l)}t.firstChild.innerHTML="",t.firstChild.appendChild(a),i.value&&this.setValue(t,i.value),t.onclick=webix.html.preventEvent,a._comp_id=e._settings.id,webix._event(a,"change",this._on_change)},render:function(e,t){return this.init&&this.init(t),t.css="webix_ss_filter",""},_on_change:function(e,t,i){webix.$$(this._comp_id).filterByAll()}}},webix.ui.datafilter.serverFilter=webix.extend({$server:!0,_on_key_down:function(e,t,i){var n=this._comp_id,s=e.which||e.keyCode;e.target||e.srcElement,9==s||s>=33&&s<=40||(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){webix.$$(n).filterByAll()},webix.ui.datafilter.textWaitDelay))}},webix.ui.datafilter.textFilter),webix.ui.datafilter.serverSelectFilter=webix.extend({$server:!0,_on_change:function(e,t,i){var n=this._comp_id;webix.$$(n).filterByAll()}},webix.ui.datafilter.selectFilter),webix.ui.datafilter.numberFilter=webix.extend({init:function(e){e.prepare=function(t,i){var n=-1!=t.indexOf("=")?1:0,s=this.format(t);return""===s?"":(-1!=t.indexOf(">")?e.compare=this._greater:-1!=t.indexOf("<")?(e.compare=this._lesser,n*=-1):(e.compare=this._equal,n=0),s-n)}},format:function(e){return e.replace(/[^\-\.0-9]/g,"")},_greater:function(e,t){return 1*e>t},_lesser:function(e,t){return""!==e&&1*e<t},_equal:function(e,t){return 1*e==t}},webix.ui.datafilter.textFilter),webix.ui.datafilter.dateFilter=webix.extend({format:function(e){if(""===e)return"";var t=new Date;if(-1!=e.indexOf("today"))t=webix.Date.dayStart(t);else if(-1==e.indexOf("now")){var i=e.match(/[0-9]+/g);if(!i||!i.length)return"";i.length<3?(i.reverse(),t=new Date(i[0],(i[1]||1)-1,1)):t=webix.i18n.dateFormatDate(e.replace(/^[>< =]+/,""))}return t.valueOf()}},webix.ui.datafilter.numberFilter),webix.csv={escape:!0,delimiter:{rows:"\n",cols:"\t"},parse:function(e,t){if(t=t||this.delimiter,!this.escape)return this._split_clip_data(e,t);for(var i=e.replace(/\n$/,"").split(t.rows),n=0;n<i.length-1;)this._substr_count(i[n],'"')%2==1&&(i[n]+=t.rows+i[n+1],delete i[n+1],n++),n++;var s=[];for(n=0;n<i.length;n++)if(void 0!==i[n]){for(var r=i[n].split(t.cols),a=0;a<r.length;a++)0===r[a].indexOf('"')&&(r[a]=r[a].substr(1,r[a].length-2)),r[a]=r[a].replace('""','"');s.push(r)}return s},_split_clip_data:function(e,t){for(var i=e.split(t.rows),n=0;n<i.length;n++)i[n]=i[n].split(t.cols);return i},_substr_count:function(e,t){return e.split(t).length-1},stringify:function(e,t){if(t=t||this.delimiter,!this.escape){for(var i=0;i<e.length;i++)e[i]=e[i].join(t.cols);return e.join(t.rows)}for(var n=/\n|\"|;|,/,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)n.test(e[i][s])&&(e[i][s]=e[i][s].replace(/"/g,'""'),e[i][s]='"'+e[i][s]+'"');e[i]=e[i].join(t.cols)}return e=e.join(t.rows)}},webix.TablePaste={clipboard_setter:function(e){return!0!==e&&1!==e||(this._settings.clipboard="block"),webix.clipbuffer.init(),this.attachEvent("onSelectChange",this._sel_to_clip),this.attachEvent("onItemClick",function(e,t,i){document.activeElement&&this.$view.contains(document.activeElement)&&(webix.clipbuffer.focus(),webix.UIManager.setFocus(this))}),this.attachEvent("onPaste",this._clip_to_sel),e},templateCopy_setter:webix.template,_sel_to_clip:function(){if(!this.getEditor||!this.getEditor()){var e=this._get_sel_text();webix.clipbuffer.set(e),webix.UIManager.setFocus(this)}},_get_sel_text:function(){var e=[],t=this._settings.templateCopy;return this.mapSelection(function(i,n,s,r,a){e[r]||(e[r]=[]);var o=t?t(i,n,s):i;return e[r].push(o),i}),webix.csv.stringify(e,this._settings.delimiter)},_clip_to_sel:function(e){if(!webix.isUndefined(this._paste[this._settings.clipboard])){var t=webix.csv.parse(e,this._settings.delimiter);this._paste[this._settings.clipboard].call(this,t)}},_paste:{block:function(e){var t=this.mapSelection(null);t&&(this.mapCells(t.row,t.column,e.length,null,function(t,i,n,s,r){return e[s]&&e[s].length>r?e[s][r]:t}),this.render())},selection:function(e){this.mapSelection(function(t,i,n,s,r){return e[s]&&e[s].length>r?e[s][r]:t}),this.render()},repeat:function(e){this.mapSelection(function(t,i,n,s,r){return i=e[s%e.length],i[r%i.length]}),this.render()},custom:function(e){}}},webix.storage||(webix.storage={}),webix.storage.local={put:function(e,t){e&&window.JSON&&window.localStorage&&window.localStorage.setItem(e,webix.stringify(t))},get:function(e){if(e&&window.JSON&&window.localStorage){var t=window.localStorage.getItem(e);return t?webix.DataDriver.json.toObject(t):null}return null},remove:function(e){e&&window.JSON&&window.localStorage&&window.localStorage.removeItem(e)},clear:function(){window.localStorage.clear()}},webix.storage.session={put:function(e,t){e&&window.JSON&&window.sessionStorage&&window.sessionStorage.setItem(e,webix.stringify(t))},get:function(e){if(e&&window.JSON&&window.sessionStorage){var t=window.sessionStorage.getItem(e);return t?webix.DataDriver.json.toObject(t):null}return null},remove:function(e){e&&window.JSON&&window.sessionStorage&&window.sessionStorage.removeItem(e)},clear:function(){window.sessionStorage.clear()}},webix.storage.cookie={put:function(e,t,i,n){e&&window.JSON&&(document.cookie=e+"="+escape(webix.stringify(t))+(n&&n instanceof Date?";expires="+n.toUTCString():"")+(i?";domain="+i:"")+(webix.env.https?";secure":""))},getRaw:function(e){for(var t=document.cookie.split(";"),i="",n="",s=0;s<t.length;s++){if(i=t[s].split("="),i[0].replace(/^\s+|\s+$/g,"")==e)return!0,i.length>1&&(n=unescape(i[1].replace(/^\s+|\s+$/g,""))),n;i=null,""}return null},get:function(e){if(e&&window.JSON){var t=this.getRaw(e);return t?webix.DataDriver.json.toObject(unescape(t)):null}return null},remove:function(e,t){e&&this.getRaw(e)&&(document.cookie=e+"="+(t?";domain="+t:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT")},clear:function(e){for(var t=document.cookie.split(";"),i=0;i<t.length;i++)document.cookie=/^[^=]+/.exec(t[i])[0]+"="+(e?";domain="+e:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},webix.DataState={getState:function(){for(var e=this.config.columns.length,t=this.config.columns,i={ids:[],size:[],select:this.getSelectedId(!0),scroll:this.getScrollState()},n=0;n<e;n++){var s=t[n];i.ids.push(s.id),i.size.push(s.fillspace||s.adjust?-1:s.width)}if(i.order=[].concat(this._hidden_column_order.length?this._hidden_column_order:i.ids),this._last_sorted&&(i.sort={id:this._last_sorted,dir:this._last_order}),this._filter_elements&&this._dtable_fully_ready){var r={},a=0;for(var o in this._filter_elements)if(!this._hidden_column_hash[o]){var l=this._filter_elements[o];l[1].value=r[o]=l[2].getValue(l[0]),a=1}a&&(i.filter=r)}i.hidden=[];for(var o in this._hidden_column_hash)i.hidden.push(o);return i},setState:function(e){var t=this.config.columns;if(e){if(this._last_sorted=null,this.blockEvent(),e.hidden){for(var i={},n=0;n<e.hidden.length;n++)i[e.hidden[n]]=!0,this._hidden_column_order.length||this.hideColumn(e.hidden[n]);if(this._hidden_column_order.length)for(var n=0;n<this._hidden_column_order.length;n++){var s=this._hidden_column_order[n];!!i[s]==!this._hidden_column_hash[s]&&this.hideColumn(s,!!i[s])}}if(e.ids){for(var r=!1,a=this.config.columns,n=0;n<a.length;n++)a[n].id!=e.ids[n]&&(r=!0);if(r){for(var n=0;n<e.ids.length;n++)a[n]=this.getColumnConfig(e.ids[n])||a[n];this.refreshColumns()}}if(e.size)for(var o=Math.min(e.size.length,t.length),n=0;n<o;n++){var l=t[n];l&&e.size[n]>0&&l.width!=e.size[n]&&(delete l.fillspace,delete l.adjust,this._setColumnWidth(n,e.size[n],!0))}this.unblockEvent();var h=!(this._settings.leftSplit||this._settings.rightSplit);if(this._updateColsSizeSettings(h),
this.callEvent("onStructureUpdate",[]),e.sort){var c=t[this.getColumnIndex(e.sort.id)];c&&this._sort(e.sort.id,e.sort.dir,c.sort)}if(e.filter){var d=this.filterByAll;this.filterByAll=function(){};for(var u in e.filter){var _=e.filter[u];if(_&&this._filter_elements[u]){var f=this._filter_elements[u];f[2].setValue(f[0],_);var b=f[1].contentId;b&&(this._active_headers[b].value=_)}}for(var u in this._filter_elements)if(!e.filter[u]){var f=this._filter_elements[u];f[2].setValue(f[0],"")}this.filterByAll=d,this.filterByAll()}if(e.select&&this.select){var v=e.select;this.unselect();for(var n=0;n<v.length;n++)v[n].row&&!this.exists(v[n].row)||this._select(v[n],!0)}e.scroll&&this.scrollTo(e.scroll.x,e.scroll.y)}}},function(){function e(){if(webix.env.touch)i.$init(),-1==document.body.className.indexOf("webix_full_screen")&&i.limit(!0),window.MSCSSMatrix&&webix.html.addStyle(".webix_view{ -ms-touch-action: none; }");else var s=webix.event(document.body,"touchstart",function(i){if(i.touches.length&&i.touches[0].radiusX>4){webix.env.touch=!0,t(n),e();for(var r in webix.ui.views){var a=webix.ui.views[r];a&&a.$touch&&a.$touch()}}webix.eventRemove(s)},{capture:!0})}function t(e){e.down="touchstart",e.move="touchmove",e.up="touchend",e.context=i._get_context}var i=webix.Touch={config:{longTouchDelay:1e3,scrollDelay:150,gravity:500,deltaStep:30,speed:"0ms",finish:1500,ellastic:!0},limit:function(e){i._limited=!1!==e},disable:function(){i._disabled=!0},enable:function(){i._disabled=!1},$init:function(){i.$init=function(){},webix.event(document.body,n.down,i._touchstart),webix.event(document.body,n.move,i._touchmove),webix.event(document.body,n.up,i._touchend),webix.event(document.body,"dragstart",function(e){return webix.html.preventEvent(e)}),webix.event(document.body,"touchstart",function(e){if(!i._disabled&&!i._limited&&webix.env.isSafari){var t=e.srcElement.tagName.toLowerCase();return"input"==t||"textarea"==t||"select"==t||"label"==t||(i._fire_fast_event=!0,webix.html.preventEvent(e))}}),i._clear_artefacts(),i._scroll=[null,null],i.$active=!0},_clear_artefacts:function(){i._start_context=i._current_context=i._prev_context=i._scroll_context=null,i._scroll_mode=i._scroll_node=i._scroll_stat=this._long_touched=null,i._delta={_x_moment:0,_y_moment:0,_time:0},i._css_button_remove&&(webix.html.removeCss(i._css_button_remove,"webix_touch"),i._css_button_remove=null),window.clearTimeout(i._long_touch_timer),i._was_not_moved=!0,i._axis_x=!0,i._axis_y=!0,i._active_transion||i._scroll_end()},_touchend:function(e){if(i._start_context){if(i._scroll_mode){var t=i._get_matrix(i._scroll_node),n=t.e,s=t.f,r=i.config.finish,a=i._get_delta(e,!0),o=webix.$$(i._scroll_node),l=o&&o.$scroll?o.$scroll.gravity:i.config.gravity;if(a._time){var h=n+l*a._x_moment/a._time,c=s+l*a._y_moment/a._time,d=i._scroll[0]?i._correct_minmax(h,!1,!1,i._scroll_stat.dx,i._scroll_stat.px):n,u=i._scroll[1]?i._correct_minmax(c,!1,!1,i._scroll_stat.dy,i._scroll_stat.py):s,_=Math.max(Math.abs(d-n),Math.abs(u-s));_<150&&(r=r*_/150),d==n&&u==s||(r=Math.round(r*Math.max((d-n)/(h-n),(u-s)/(c-s))));var f={e:d,f:u},o=webix.$$(i._scroll_node);o&&o.adjustScroll&&o.adjustScroll(f),r=Math.max(100,r),n!=f.e||s!=f.f?(i._set_matrix(i._scroll_node,f.e,f.f,r+"ms"),i._scroll_master&&i._scroll_master._sync_scroll(f.e,f.f,r+"ms"),i._set_scroll(f.e,f.f,r+"ms")):i._scroll_end()}else i._scroll_end()}else if(!this._long_touched)if(i._axis_y&&!i._axis_x)i._translate_event("onSwipeX");else if(i._axis_x&&!i._axis_y)i._translate_event("onSwipeY");else if(webix.env.isSafari&&i._fire_fast_event){i._fire_fast_event=!1;var b=i._start_context.target;webix.delay(function(){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),b.dispatchEvent(e)})}i._translate_event("onTouchEnd"),i._clear_artefacts()}},_touchmove:function(e){if(i._scroll_context&&i._start_context){var t=i._get_delta(e);if(i._translate_event("onTouchMove"),i._scroll_mode)i._set_scroll_pos(t);else if(i._axis_x=i._axis_check(t._x,"x",i._axis_x),i._axis_y=i._axis_check(t._y,"y",i._axis_y),i._scroll_mode){var n=i._get_event_view("onBeforeScroll",!0);if(n){var s={};n.callEvent("onBeforeScroll",[s]),s.update&&(i.config.speed=s.speed,i.config.scale=s.scale)}i._init_scroller(t)}return webix.html.preventEvent(e)}},_set_scroll_pos:function(){if(i._scroll_node){var e=i._get_matrix(i._scroll_node),t=(e.e,e.f,i._prev_context||i._start_context),n=webix.$$(i._scroll_node),s=n&&n.$scroll?n.$scroll.ellastic:i.config.ellastic;i._scroll[0]&&(e.e=i._correct_minmax(e.e-t.x+i._current_context.x,s,e.e,i._scroll_stat.dx,i._scroll_stat.px)),i._scroll[1]&&(e.f=i._correct_minmax(e.f-t.y+i._current_context.y,s,e.f,i._scroll_stat.dy,i._scroll_stat.py)),i._set_matrix(i._scroll_node,e.e,e.f,"0ms"),i._scroll_master&&i._scroll_master._sync_scroll(e.e,e.f,"0ms"),i._set_scroll(e.e,e.f,"0ms")}},_set_scroll:function(e,t,n){var s=i._scroll_stat.px/i._scroll_stat.dx*-e,r=i._scroll_stat.py/i._scroll_stat.dy*-t;i._scroll[0]&&i._set_matrix(i._scroll[0],s,0,n),i._scroll[1]&&i._set_matrix(i._scroll[1],0,r,n)},scrollTo:function(e,t,n,s){i._set_matrix(e,t,n,s)},_set_matrix:function(e,t,n,s){if(!i._in_anim_frame&&window.setAnimationFrame&&window.setAnimationFrame(function(){return i._in_anim_frame=!0,i._set_matrix(e,t,n,s)}),i._in_anim_frame=null,i._active_transion=!0,e){var r=i.config.translate||webix.env.translate;e.style[webix.env.transform]=r+"("+Math.round(t)+"px, "+Math.round(n)+"px"+("translate3d"==r?", 0":"")+")",e.style[webix.env.transitionDuration]=s}},_get_matrix:function(e){var t,n=window.getComputedStyle(e)[webix.env.transform];if("none"==n)t={e:0,f:0};else if(window.WebKitCSSMatrix)t=new WebKitCSSMatrix(n);else if(window.MSCSSMatrix)t=new MSCSSMatrix(n);else{var s=n.replace(/(matrix\()(.*)(\))/gi,"$2");s=s.replace(/\s/gi,""),s=s.split(",");for(var t={},r=["a","b","c","d","e","f"],a=0;a<r.length;a++)t[r[a]]=parseInt(s[a],10)}return i._scroll_master&&i._scroll_master._sync_pos(t),t},_correct_minmax:function(e,t,i,n,s){if(e===i)return e;var r=Math.abs(e-i),a=r/(e-i);if(e>0)return t?i+a*Math.sqrt(r):0;var o=n-s;return o+e<0?t?i-Math.sqrt(-(e-i)):-o:e},_init_scroll_node:function(e){if(!e.scroll_enabled){e.scroll_enabled=!0,e.parentNode.style.position="relative";var t=webix.env.cssPrefix;e.style.cssText+=t+"transition: "+t+"transform; "+t+"user-select:none; "+t+"transform-style:flat;",e.addEventListener(webix.env.transitionEnd,i._scroll_end,!1)}},_init_scroller:function(e){-1!=i._scroll_mode.indexOf("x")&&(i._scroll[0]=i._create_scroll("x",i._scroll_stat.dx,i._scroll_stat.px,"width")),-1!=i._scroll_mode.indexOf("y")&&(i._scroll[1]=i._create_scroll("y",i._scroll_stat.dy,i._scroll_stat.py,"height")),i._init_scroll_node(i._scroll_node),window.setTimeout(i._set_scroll_pos,1)},_create_scroll:function(e,t,n,s){if(t-n<2){var r=i._get_matrix(i._scroll_node),a="y"==e?r.e:0,o="y"==e?0:r.f;return i._scroll_master||i._set_matrix(i._scroll_node,a,o,"0ms"),i._scroll_mode=i._scroll_mode.replace(e,""),""}var l=webix.html.create("DIV",{class:"webix_scroll_"+e},"");return l.style[s]=Math.max(n*n/t-7,10)+"px",i._scroll_stat.left&&("x"===e?l.style.left=i._scroll_stat.left+"px":l.style.right=-i._scroll_stat.left+"px"),i._scroll_stat.hidden&&(l.style.visibility="hidden"),i._scroll_node.parentNode.appendChild(l),l},_axis_check:function(e,t,n){return e>i.config.deltaStep?(i._was_not_moved&&(i._long_move(t),i._locate(t),-1==(i._scroll_mode||"").indexOf(t)&&(i._scroll_mode="")),!1):n},_scroll_end:function(){var e,t,n;n=webix.$$(i._scroll_node||this),n&&(i._scroll_node?e=i._get_matrix(i._scroll_node):n.getScrollState&&(t=n.getScrollState(),e={e:t.x,f:t.y}),webix.callEvent("onAfterScroll",[e]),n.callEvent&&n.callEvent("onAfterScroll",[e])),i._scroll_mode||(webix.html.remove(i._scroll),i._scroll=[null,null]),i._active_transion=!1},_long_move:function(e){window.clearTimeout(i._long_touch_timer),i._was_not_moved=!1},_stop_old_scroll:function(e){if(!i._scroll[0]&&!i._scroll[1])return!0;i._stop_scroll(e,i._scroll[0]?"x":"y")},_touchstart:function(e){var t=e.target||event.srcElement;if(!(i._disabled||t.tagName&&"textarea"==t.tagName.toLowerCase()&&t.offsetHeight<t.scrollHeight)){i._long_touched=null,i._scroll_context=i._start_context=n.context(e);var s=webix.$$(e);!i._limited||i._is_scroll()||s&&s.$touchCapture||(i._scroll_context=null),i._translate_event("onTouchStart"),i._stop_old_scroll(e)&&(i._long_touch_timer=window.setTimeout(i._long_touch,i.config.longTouchDelay)),!s||!s.touchable||t.className&&0===t.className.indexOf("webix_view")||(i._css_button_remove=s.getNode(e),webix.html.addCss(i._css_button_remove,"webix_touch"))}},_long_touch:function(e){i._start_context&&(i._translate_event("onLongTouch"),webix.callEvent("onClick",[i._start_context]),i._long_touched=!0)},_stop_scroll:function(e,t){i._locate(t);var s=i._scroll[0]||i._scroll[1];if(s){var r=i._get_event_view("onBeforeScroll",!0);r&&r.callEvent("onBeforeScroll",[i._start_context,i._current_context])}!s||i._scroll_node&&s.parentNode==i._scroll_node.parentNode||(i._clear_artefacts(),i._scroll_end(),i._start_context=n.context(e)),i._touchmove(e)},_get_delta:function(e,t){return i._prev_context=i._current_context,i._current_context=n.context(e),i._delta._x=Math.abs(i._start_context.x-i._current_context.x),i._delta._y=Math.abs(i._start_context.y-i._current_context.y),i._prev_context&&(i._current_context.time-i._prev_context.time<i.config.scrollDelay?(i._delta._x_moment=i._delta._x_moment/1.3+i._current_context.x-i._prev_context.x,i._delta._y_moment=i._delta._y_moment/1.3+i._current_context.y-i._prev_context.y):i._delta._y_moment=i._delta._x_moment=0,i._delta._time=i._delta._time/1.3+(i._current_context.time-i._prev_context.time)),i._delta},_get_sizes:function(e){i._scroll_stat={dx:e.offsetWidth,dy:e.offsetHeight,px:e.parentNode.offsetWidth,py:e.parentNode.offsetHeight}},_is_scroll:function(e){var t=i._start_context.target;if(!webix.env.touch&&!webix.env.transition&&!webix.env.transform)return null;for(;t&&"BODY"!=t.tagName;){if(t.getAttribute){var n=t.getAttribute("touch_scroll");if(n&&(!e||-1!=n.indexOf(e)))return[t,n]}t=t.parentNode}return null},_locate:function(e){var t=this._is_scroll(e);return t&&(i._scroll_mode=t[1],i._scroll_node=t[0],i._get_sizes(t[0])),t},_translate_event:function(e){webix.callEvent(e,[i._start_context,i._current_context]);var t=i._get_event_view(e);t&&t.callEvent(e,[i._start_context,i._current_context])},_get_event_view:function(e,t){var n=webix.$$(t?i._scroll_node:i._start_context);if(!n)return null;for(;n;){if(n.hasEvent&&n.hasEvent(e))return n;n=n.getParentView()}return null},_get_context:function(e){if(!e.touches[0]){var t=i._current_context;return t.time=new Date,t}return{target:e.target,x:e.touches[0].pageX,y:e.touches[0].pageY,time:new Date}},_get_context_m:function(e){return{target:e.target||e.srcElement,x:e.pageX,y:e.pageY,time:new Date}}};webix.ready(e);var n=webix.env.mouse={down:"mousedown",up:"mouseup",move:"mousemove",context:i._get_context_m};window.navigator.pointerEnabled?(n.down="pointerdown",n.move="pointermove",n.up="pointerup"):window.navigator.msPointerEnabled?(n.down="MSPointerDown",n.move="MSPointerMove",n.up="MSPointerUp"):webix.env.touch&&t(n)}(),webix.attachEvent("onDataTable",function(e,t){webix.env.touch&&(webix.Touch.$init(),t.scrollSize=0,webix.Touch._disabled&&webix.Touch.limit(),e.$ready.push(e.$touch))}),webix.ui.datafilter.headerMenu={getValue:function(){},setValue:function(){},refresh:function(e,t,i){e._settings.headermenu||(e.define("headermenu",!0),e._generate_menu_columns()),t.onclick=function(){webix.$$(e.config.headermenu).show(t)}},render:function(e,t){return"<span class='webix_icon fa-columns' role='button' tabindex='0' aria-label='"+webix.i18n.aria.headermenu+"'>"}},webix.ui.datafilter.richSelectFilter={getInputNode:function(e){return webix.$$(e.$webix)||null},getValue:function(e){var t=this.getInputNode(e);return t?t.getValue():""},setValue:function(e,t){var i=this.getInputNode(e);return i?i.setValue(t):""},compare:function(e,t){return e==t},refresh:function(e,t,i){if(!e.$destructed){var n=webix.$$(i.richselect);if(!n.$view.parentNode){webix.html.create("div",{class:"webix_richfilter"}).appendChild(n.$view)}t.$webix=i.richselect,t.style.marginLeft="-10px",i.compare=i.compare||this.compare,i.prepare=i.prepare||this.prepare,e.registerFilter(t,i,this);var s,r=i.options;r?"string"==typeof r?(s=i.options=[],webix.ajax(r).then(webix.bind(function(t){i.options=t.json();var n=document.body.contains(n)?n:document.body.querySelector('[active_id="'+i.contentId+'"]');this.refresh(e,n,i)},this))):s=r:s=e.collectValues(i.columnId);var a=n.getPopup().getList(),o=webix.$$(r);if(o&&o.data&&o.data.getRange&&(s=o.data.getRange()),t.firstChild.appendChild(n.$view.parentNode),a.parse&&(a.clearAll(),a.parse(s),!this.$noEmptyOption&&!1!==i.emptyOption||i.emptyOption)){var l={id:"",value:i.emptyOption||"",$empty:!0};a.add(l,0)}i.value&&this.setValue(t,i.value),n.render(),webix.delay(n.resize,n)}},render:function(e,t){if(!t.richselect){var i=webix.html.create("div",{class:"webix_richfilter"}),n={container:i,view:this.inputtype,options:[]},s=webix.extend(this.inputConfig||{},t.inputConfig||{},!0);webix.extend(n,s),t.separator&&(n.separator=t.separator),t.suggest&&(n.suggest=t.suggest);var r=webix.ui(n);r.attachEvent("onChange",function(){e.filterByAll()}),t.richselect=r._settings.id,e._destroy_with_me.push(r)}return t.css="webix_div_filter"," "},inputtype:"richselect"},webix.ui.datafilter.multiSelectFilter=webix.extend({$noEmptyOption:!0,inputtype:"multiselect",prepare:function(e,t){if(!e)return e;for(var i={},n=e.toString().split(t.separator||","),s=0;s<n.length;s++)i[n[s]]=1;return i},compare:function(e,t){return!t||t[e]}},webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.serverMultiSelectFilter=webix.extend({$server:!0,_on_change:function(e,t,i){var n=this._comp_id;webix.$$(n).filterByAll()}},webix.ui.datafilter.multiSelectFilter),webix.ui.datafilter.multiComboFilter=webix.extend({inputtype:"multicombo",inputConfig:{tagMode:!1}},webix.ui.datafilter.multiSelectFilter),webix.ui.datafilter.serverMultiComboFilter=webix.extend({inputtype:"multicombo",inputConfig:{tagMode:!1}},webix.ui.datafilter.serverMultiSelectFilter),webix.ui.datafilter.datepickerFilter=webix.extend({prepare:function(e){return e||""},compare:function(e,t){return 1*e==1*t},inputtype:"datepicker"},webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.columnGroup={getValue:function(){},setValue:function(){},getHelper:function(e,t){return{open:function(){t.closed=!0,e.onclick()},close:function(){t.closed=!1,e.onclick()},isOpened:function(){return t.closed}}},refresh:function(e,t,i){t.onclick=function(t){webix.html.stopEvent(t);var n=this.firstChild.firstChild;i.closed?(i.closed=!1,n.className="webix_tree_open"):(i.closed=!0,n.className="webix_tree_close"),webix.delay(function(){e.callEvent("onColumnGroupCollapse",[i.columnId,i.batch,!i.closed]),e.showColumnBatch(i.batch,!i.closed)})},i.firstRun||(i.firstRun=1,i.closed&&e.showColumnBatch(i.batch,!1))},render:function(e,t){return"<div role='button' tabindex='0' aria-label='"+webix.i18n.aria[t.closed?"openGroup":"closeGroup"]+"' class='"+(t.closed?"webix_tree_close":"webix_tree_open")+"'></div>&nbsp;"+(t.groupText||"")}},webix.ui.datafilter.dateRangeFilter=webix.extend({prepare:function(e){return webix.ui.daterange.prototype._correct_value(e)},compare:function(e,t){return(!t.start||e>=t.start)&&(!t.end||e<=t.end)},inputtype:"daterangepicker"},webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.serverDateRangeFilter=webix.extend({$server:!0},webix.ui.datafilter.dateRangeFilter),webix.editors.$popup.multiselect={view:"multisuggest",suggest:{button:!0}},webix.Canvas=webix.proto({$init:function(e){this._canvas_labels=[],this._canvas_series=webix.isUndefined(e.series)?e.name:e.series,this._obj=webix.toNode(e.container||e);var t=e.width*(window.devicePixelRatio||1),i=e.height*(window.devicePixelRatio||1),n=e.style||"";n+=";width:"+e.width+"px;height:"+e.height+"px;",this._prepareCanvas(e.name,n,t,i)},_prepareCanvas:function(e,t,i,n){return this._canvas=webix.html.create("canvas",{title:e,width:i,height:n,canvas_id:e,style:t||""}),this._obj.appendChild(this._canvas),this._canvas.getContext||(webix.env.isIE?(webix.require("legacy/excanvas/excanvas.js",!0),G_vmlCanvasManager.init_(document),G_vmlCanvasManager.initElement(this._canvas)):webix.assert(this._canvas.getContext,"Canvas is not supported in the browser")),this._canvas},getCanvas:function(e){var t=(this._canvas||this._prepareCanvas(this._contentobj)).getContext(e||"2d");return this._webixDevicePixelRatio||(this._webixDevicePixelRatio=!0,t.scale(window.devicePixelRatio||1,window.devicePixelRatio||1)),t},_resizeCanvas:function(e,t){this._canvas&&(this._canvas.setAttribute("width",e*(window.devicePixelRatio||1)),this._canvas.setAttribute("height",t*(window.devicePixelRatio||1)),this._canvas.style.width=e+"px",this._canvas.style.height=t+"px",this._webixDevicePixelRatio=!1)},renderText:function(e,t,i,n,s){if(i){s&&(s=Math.max(s,0)),t&&(t=Math.max(t,0));var r=webix.html.create("DIV",{class:"webix_canvas_text"+(n?" "+n:""),style:"left:"+e+"px; top:"+t+"px;","aria-hidden":"true"},i);return this._obj.appendChild(r),this._canvas_labels.push(r),s&&(r.style.width=s+"px"),r}},renderTextAt:function(e,t,i,n,s,r,a){var o=this.renderText.call(this,i,n,s,r,a);return o&&(e&&(o.style.top="middle"==e?parseInt(n-o.offsetHeight/2,10)+"px":n-o.offsetHeight+"px"),t&&(o.style.left="left"==t?i-o.offsetWidth+"px":parseInt(i-o.offsetWidth/2,10)+"px")),o},clearCanvas:function(e){var t=[];if(webix.html.remove(this._canvas_labels),this._canvas_labels=[],!e&&this._obj._htmlmap){for(t=this._getMapAreas();t.length;)t[0].parentNode.removeChild(t[0]),t.splice(0,1);t=null,this._obj._htmlmap.getElementsByTagName("AREA").length||(this._obj._htmlmap.parentNode.removeChild(this._obj._htmlmap),this._obj._htmlmap=null)}this.getCanvas().clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight)},toggleCanvas:function(){this._toggleCanvas("none"==this._canvas.style.display)},showCanvas:function(){this._toggleCanvas(!0)},hideCanvas:function(){this._toggleCanvas(!1)},_toggleCanvas:function(e){var t,i;for(i=0;i<this._canvas_labels.length;i++)this._canvas_labels[i].style.display=e?"":"none";if(this._obj._htmlmap)for(t=this._getMapAreas(),i=0;i<t.length;i++)e?t[i].removeAttribute("disabled"):t[i].setAttribute("disabled","true");this._canvas.style.display=e?"":"none"},_getMapAreas:function(){var e,t,i=[];for(e=this._obj._htmlmap.getElementsByTagName("AREA"),t=0;t<e.length;t++)e[t].getAttribute("userdata")==this._canvas_series&&i.push(e[t]);return i}}),webix.color={_toHex:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],toHex:function(e,t){e=parseInt(e,10);for(var i="";e>0;)i=this._toHex[e%16]+i,e=Math.floor(e/16);for(;i.length<t;)i="0"+i;return i},hexToDec:function(e){return parseInt(e,16)},toRgb:function(e){var t,i,n,s;return"string"!=typeof e?(t=e[0],i=e[1],n=e[2]):-1!=e.indexOf("rgb")?(s=e.substr(e.indexOf("(")+1,e.lastIndexOf(")")-e.indexOf("(")-1).split(","),t=s[0],i=s[1],n=s[2]):("#"==e.substr(0,1)&&(e=e.substr(1)),t=this.hexToDec(e.substr(0,2)),i=this.hexToDec(e.substr(2,2)),n=this.hexToDec(e.substr(4,2))),t=parseInt(t,10)||0,i=parseInt(i,10)||0,n=parseInt(n,10)||0,(t<0||t>255)&&(t=0),(i<0||i>255)&&(i=0),(n<0||n>255)&&(n=0),[t,i,n]},hsvToRgb:function(e,t,i){var n,s,r,a,o,l,h,c;switch(n=Math.floor(e/60)%6,s=e/60-n,r=i*(1-t),a=i*(1-s*t),o=i*(1-(1-s)*t),l=0,h=0,c=0,n){case 0:l=i,h=o,c=r;break;case 1:l=a,h=i,c=r;break;case 2:l=r,h=i,c=o;break;case 3:l=r,h=a,c=i;break;case 4:l=o,h=r,c=i;break;case 5:l=i,h=r,c=a}return l=Math.floor(255*l),h=Math.floor(255*h),c=Math.floor(255*c),[l,h,c]},rgbToHsv:function(e,t,i){var n,s,r,a,o,l,h,c;return n=e/255,s=t/255,r=i/255,a=Math.min(n,s,r),o=Math.max(n,s,r),h=0,l=0===o?0:1-a/o,c=o,o==a?h=0:o==n&&s>=r?h=60*(s-r)/(o-a)+0:o==n&&s<r?h=60*(s-r)/(o-a)+360:o==s?h=60*(r-n)/(o-a)+120:o==r&&(h=60*(n-s)/(o-a)+240),[h,l,c]}},webix.HtmlMap=webix.proto({$init:function(e){this._id="map_"+webix.uid(),this._key=e,this._map=[],this._areas=[]},addRect:function(e,t,i){this._createMapArea(e,"RECT",t,i)},addPoly:function(e,t,i){this._createMapArea(e,"POLY",t,i)},_createMapArea:function(e,t,i,n){var s="";4==arguments.length&&(s="userdata='"+n+"'"),this._map.push("<area "+this._key+"='"+e+"' shape='"+t+"' coords='"+i.join()+"' "+s+"></area>"),this._areas.push({index:n,points:i})},addSector:function(e,t,i,n,s,r,a,o){var l=[];l.push(n),l.push(Math.floor(s*a));for(var h=t;h<i;h+=Math.PI/18)l.push(Math.floor(n+r*Math.cos(h))),l.push(Math.floor((s+r*Math.sin(h))*a));return l.push(Math.floor(n+r*Math.cos(i))),l.push(Math.floor((s+r*Math.sin(i))*a)),l.push(n),l.push(Math.floor(s*a)),this.addPoly(e,l,o)},hide:function(e,t,i){if(e.querySelectorAll)for(var n=e.querySelectorAll('area[userdata="'+t+'"]'),s=0;s<n.length;s++)n[s].style.display=i?"none":""},render:function(e){var t=webix.html.create("DIV");t.style.cssText="position:absolute; width:100%; height:100%; top:0px; left:0px;",e.appendChild(t);var i=webix.env.isIE?"":"src='data:image/gif;base64,R0lGODlhEgASAIAAAP///////yH5BAUUAAEALAAAAAASABIAAAIPjI+py+0Po5y02ouz3pwXADs='";t.innerHTML="<map id='"+this._id+"' name='"+this._id+"'>"+this._map.join("\n")+"</map><img "+i+" class='webix_map_img' usemap='#"+this._id+"'>",e._htmlmap=t,this._map=[]}}),webix.editors.multiselect=webix.extend({popupType:"multiselect"},webix.editors.richselect),webix.ContextHelper={defaults:{padding:"4",hidden:!0},body_setter:function(e){return e=webix.ui.window.prototype.body_setter.call(this,e),this._body_cell._viewobj.style.borderWidth="0px",e},attachTo:function(e){webix.assert(e,"Invalid target for Context::attach");var t;t=e.on_context?e.attachEvent("onAfterContextMenu",webix.bind(this._show_at_ui,this)):webix.event(e,"contextmenu",this._show_at_node,{bind:this}),this.attachEvent("onDestruct",function(){e.detachEvent?e.detachEvent(t):webix.eventRemove(t),e=null})},getContext:function(){return this._area},setContext:function(e){this._area=e},_show_at_node:function(e){return this._area=webix.toNode(e||event),this._show_at(e)},_show_at_ui:function(e,t,i){return this._area={obj:webix.$$(t),id:e},this._show_at(t)},_show_at:function(e){var t=this.show(e,null,!0);return!1===t?t:(webix.callEvent("onClick",[]),webix.html.preventEvent(e))},_show_on_mouse_out:!0,master_setter:function(e){return this.attachTo(e),null}},webix.i18n.dbllist={selectAll:"<span class='webix_icon fa-angle-double-right'></span>",selectOne:"<span class='webix_icon fa-angle-right'></span>",deselectAll:"<span class='webix_icon fa-angle-double-left'></span>",deselectOne:"<span class='webix_icon fa-angle-left'></span>"},webix.dp=function(e,t){if("object"==typeof e&&e._settings&&(e=e._settings.id),webix.dp._pull[e]||t)return webix.dp._pull[e];"string"!=typeof e&&"number"!=typeof e||(e={master:webix.$$(e)});var i=new webix.DataProcessor(e),n=i._settings.master._settings.id;return webix.dp._pull[n]=i,webix.$$(n).attachEvent("onDestruct",function(){webix.dp._pull[this._settings.id]=null,delete webix.dp._pull[this._settings.id]}),i},webix.dp._pull={},webix.dp.$$=function(e){return webix.dp._pull[e]},webix.DataProcessor=webix.proto({defaults:{autoupdate:!0,updateFromResponse:!1,mode:"post",operationName:"webix_operation",trackMove:!1},$init:function(){this.reset(),this._ignore=!1,this.name="DataProcessor",this.$ready.push(this._after_init_call)},reset:function(){this._updates=[]},url_setter:function(e){var t="";if("string"==typeof e){var i=e.split("->");i.length>1&&(e=i[1],t=i[0])}else e&&e.mode&&(t=e.mode,e=e.url);return t?webix.proxy(t,e):e},master_setter:function(e){var t=e;return"DataStore"!=e.name&&(t=e.data),this._settings.store=t,e},_after_init_call:function(){webix.assert(this._settings.store,"store or master need to be defined for the dataprocessor"),this._settings.store.attachEvent("onStoreUpdated",webix.bind(this._onStoreUpdated,this)),this._settings.store.attachEvent("onDataMove",webix.bind(this._onDataMove,this))},ignore:function(e,t){var i=this._ignore;this._ignore=!0,e.call(t||this),this._ignore=i},off:function(){this._ignore=!0},on:function(){this._ignore=!1},_copy_data:function(e){var t={};for(var i in e)0!==i.indexOf("$")&&(t[i]=e[i]);return t},save:function(e,t,i){t=t||"update",this._save_inner(e,i||this._settings.store.getItem(e),t)},_save_inner:function(e,t,i){if("object"==typeof e&&(e=e.toString()),!e||!0===this._ignore||!i||"paint"==i)return!0;var n=this._settings.store;n&&n._scheme_serialize&&(t=n._scheme_serialize(t));var s={id:e,data:this._copy_data(t),operation:i};if(webix.isUndefined(t.$parent)||(s.data.parent=t.$parent),"delete"!=s.operation){var r=this._settings.master;r&&r.data&&r.data.getMark&&r.data.getMark(e,"webix_invalid")&&(s._invalid=!0),this.validate(null,s.data)||(s._invalid=!0)}return this._check_unique(s)&&this._updates.push(s),this._settings.autoupdate&&this.send(),!0},_onDataMove:function(e,t,i,n){if(this._settings.trackMove){var s=webix.copy(this._settings.store.getItem(e));this._settings.store.order;s.webix_move_index=t,s.webix_move_id=n,s.webix_move_parent=i,this._save_inner(e,s,"order")}},_onStoreUpdated:function(e,t,i){switch(i){case"save":case"update":i="update";break;case"add":i="insert";break;case"delete":i="delete";break;default:return!0}return this._save_inner(e,t,i)},_check_unique:function(e){for(var t=0;t<this._updates.length;t++){var i=this._updates[t];if(i.id==e.id)return"delete"==e.operation&&("insert"==i.operation?this._updates.splice(t,1):i.operation="delete"),i.data=e.data,i._invalid=e._invalid,!1}return!0},send:function(){this._sendData()},_sendData:function(){if(this._settings.url){for(var e=this._updates,t=[],i=this._settings.url,n=0;n<e.length;n++){var s=e[n];if(!s._in_progress&&!s._invalid){var r=s.id,a=s.operation,o="object"!=typeof i||i.$proxy?i:i[a],l=o&&(o.$proxy||"function"==typeof o);if(o&&(this._settings.store._scheme_save&&this._settings.store._scheme_save(s.data),this.callEvent("onBefore"+a,[r,s]))){if(s._in_progress=!0,!this.callEvent("onBeforeDataSend",[s]))return;s.data=this._updatesData(s.data);var h=this._send_callback({id:s.id,status:s.operation});o.$proxy?o.save?o.save(this.config.master,s,this,h):t.push(s):("insert"==a&&delete s.data.id,l?o(s.id,s.operation,s.data).then(function(e){e&&"function"==typeof e.json&&(e=e.json()),h.success("",e,-1)},function(e){h.error("",null,e)}):(s.data[this._settings.operationName]=a,this._send(o,s.data,this._settings.mode,a,h))),this.callEvent("onAfterDataSend",[s])}}}i.$proxy&&i.saveAll&&t.length&&i.saveAll(this.config.master,t,this,this._send_callback({}))}},_updatesData:function(e){var t={};for(var i in e)0!==i.indexOf("$")&&(t[i]=e[i]);return t},_send:function(e,t,i,n,s){if(webix.assert(e,"url was not set for DataProcessor"),"function"==typeof e)return e(t,n,s);webix.ajax()[i](e,t,s)},_send_callback:function(e){var t=this;return{success:function(i,n,s){return t._processResult(e,i,n,s)},error:function(i,n,s){return t._processError(e,i,n,s)}}},attachProgress:function(e,t,i){this.attachEvent("onBeforeDataSend",e),this.attachEvent("onAfterSync",t),this.attachEvent("onAfterSaveError",i),this.attachEvent("onLoadError",i)},_processError:function(e,t,i,n){e?this._innerProcessResult(!0,e.id,!1,e.status,!1,{text:t,data:i,loader:n}):(this.callEvent("onLoadError",arguments),webix.callEvent("onLoadError",[t,i,n,this]))},_innerProcessResult:function(e,t,i,n,s,r){var a=this._settings.master,o=this.getItemState(t);if(o._in_progress=!1,e){if(this.callEvent("onBeforeSaveError",[t,n,s,r]))return o._invalid=!0,this._settings.undoOnError&&a._settings.undo&&a.undo(t),void this.callEvent("onAfterSaveError",[t,n,s,r])}else this.setItemState(t,!1);i&&t!=i&&this._settings.store.changeId(t,i),s&&"delete"!=n&&this._settings.updateFromResponse&&this.ignore(function(){this._settings.store.updateItem(i||t,s)}),this._settings.undoOnError&&a._settings.undo&&a.removeUndo(i||t),this.callEvent("onAfterSave",[s,t,r]),this.callEvent("onAfter"+n,[s,t,r])},processResult:function(e,t,i){var n=t&&("error"==t.status||"invalid"==t.status),s=!!t&&(t.newid||t.id);this._innerProcessResult(n,e.id,s,e.status,t,i)},_processResult:function(e,t,i,n){if(this.callEvent("onBeforeSync",[e,t,i,n]),-1===n)this.processResult(e,i,{});else{var s=this._settings.url;if(s.$proxy&&s.result)s.result(e,this._settings.master,this,t,i,n);else{var r;t&&(r=i.json(),t&&void 0===r&&(r={status:"error"})),this.processResult(e,r,{text:t,data:i,loader:n})}}this.callEvent("onAfterSync",[e,t,i,n])},escape:function(e){return this._settings.escape?this._settings.escape(e):encodeURIComponent(e)},getState:function(){if(!this._updates.length)return!1;for(var e=this._updates.length-1;e>=0;e--)if(this._updates[e]._in_progress)return"saving";return!0},getItemState:function(e){var t=this._get_stack_index(e);return this._updates[t]||null},setItemState:function(e,t){if(t)this.save(e,t);else{var i=this._get_stack_index(e);i>-1&&this._updates.splice(i,1)}},_get_stack_index:function(e){for(var t=-1,i=0;i<this._updates.length;i++)if(this._updates[i].id==e){t=i;break}return t}},webix.Settings,webix.EventSystem,webix.ValidateData),function(){function e(e,t){var n=e.callback;i(!1),e.box.parentNode.removeChild(e.box),u=e.box=null,n&&n(t,e.details)}function t(t){if(u){t=t||event;var i=t.which||event.keyCode;if(webix.message.keyboard)return 13!=i&&32!=i||e(u,!0),27==i&&e(u,!1),t.preventDefault&&t.preventDefault(),!(t.cancelBubble=!0)}}function i(e){i.cover&&i.cover.parentNode||(i.cover=document.createElement("DIV"),i.cover.onkeydown=t,i.cover.className="webix_modal_cover",document.body.appendChild(i.cover)),i.cover.style.display=e?"inline-block":"none"}function n(e,t,i){return"<div role='button' tabindex='0' aria-label='"+e+"' class='webix_popup_button"+(i?" "+i:"")+"' result='"+t+"' ><div>"+e+"</div></div>"}function s(e){_.area||(_.area=document.createElement("DIV"),_.area.className="webix_message_area",_.area.style[_.position]="5px",document.body.appendChild(_.area)),_.area.setAttribute("role","alert"),_.area.setAttribute("aria-atomic",!0),_.hide(e.id);var t=document.createElement("DIV");return t.innerHTML="<div>"+e.text+"</div>",t.className="webix_info webix_"+e.type,t.onclick=function(){_.hide(e.id),e=null},webix.$testmode&&(t.className+=" webix_no_transition"),"bottom"==_.position&&_.area.firstChild?_.area.insertBefore(t,_.area.firstChild):_.area.appendChild(t),e.expire>0&&(_.timers[e.id]=window.setTimeout(function(){_.hide(e.id)},e.expire)),t.style.height=t.offsetHeight-2+"px",_.pull[e.id]=t,t=null,e.id}function r(t,i,s){var r=document.createElement("DIV");r.className=" webix_modal_box webix_"+t.type,r.setAttribute("webixbox",1),r.setAttribute("role","alertdialog"),r.setAttribute("aria-label",t.title||""),r.setAttribute("tabindex","0");var a="";if(t.width&&(r.style.width=t.width+(webix.rules.isNumber(t.width)?"px":"")),t.height&&(r.style.height=t.height+(webix.rules.isNumber(t.height)?"px":"")),t.title&&(a+='<div class="webix_popup_title">'+t.title+"</div>"),a+='<div class="webix_popup_text"><span>'+(t.content?"":t.text)+'</span></div><div  class="webix_popup_controls">',(i||t.ok)&&(a+=n(t.ok||"OK",!0,"confirm")),(s||t.cancel)&&(a+=n(t.cancel||"Cancel",!1)),t.buttons)for(var o=0;o<t.buttons.length;o++)a+=n(t.buttons[o],o);if(a+="</div>",r.innerHTML=a,t.content){var l=t.content;"string"==typeof l&&(l=document.getElementById(l)),"none"==l.style.display&&(l.style.display=""),r.childNodes[t.title?1:0].appendChild(l)}return r.onclick=function(i){i=i||event;var n=i.target||i.srcElement;if(n.className||(n=n.parentNode),-1!=n.className.indexOf("webix_popup_button")){var s=n.getAttribute("result");s="true"==s||"false"!=s&&s,e(t,s)}i.cancelBubble=!0},t.box=r,(i||s||t.buttons)&&(u=t),r}function a(e,n,s){var a=e.tagName?e:r(e,n,s);e.hidden||i(!0),webix.toNode(e.container||document.body).appendChild(a)
;var o=e.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-a.offsetWidth)/2)),l=e.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-a.offsetHeight)/2));return"top"==e.position?a.style.top="-3px":a.style.top=l+"px",a.style.left=o+"px",a.onkeydown=t,a.focus(),e.hidden&&webix.modalbox.hide(a),a}function o(e){return a(e,!0,!1)}function l(e){return a(e,!0,!0)}function h(e){return a(e)}function c(e,t,i){return"object"!=typeof e&&("function"==typeof t&&(i=t,t=""),e={text:e,type:t,callback:i}),e}function d(e,t,i,n){return"object"!=typeof e&&(e={text:e,type:t,expire:i,id:n}),e.id=e.id||_.uid(),e.expire=e.expire||_.expire,e}var u=null;webix.event(document,"keydown",t,{capture:!0}),webix.alert=function(){var e=c.apply(this,arguments);return e.type=e.type||"confirm",o(e)},webix.confirm=function(){var e=c.apply(this,arguments);return e.type=e.type||"alert",l(e)},webix.modalbox=function(){var e=c.apply(this,arguments);return e.type=e.type||"alert",h(e)},webix.modalbox.hide=function(e){if(e){for(;e&&e.getAttribute&&!e.getAttribute("webixbox");)e=e.parentNode;e&&e.parentNode.removeChild(e)}i(!1),u=null};var _=webix.message=function(e,t,i,n){switch(e=d.apply(this,arguments),e.type=e.type||"info",e.type.split("-")[0]){case"alert":return o(e);case"confirm":return l(e);case"modalbox":return h(e);default:return s(e)}};_.seed=(new Date).valueOf(),_.uid=function(){return _.seed++},_.expire=4e3,_.keyboard=!0,_.position="top",_.pull={},_.timers={},_.hideAll=function(){for(var e in _.pull)_.hide(e)},_.hide=function(e){var t=_.pull[e];t&&t.parentNode&&(window.setTimeout(function(){t.parentNode.removeChild(t),t=null},2e3),t.style.height=0,t.className+=" hidden",_.area.removeAttribute("role"),_.timers[e]&&window.clearTimeout(_.timers[e]),delete _.pull[e])}}(),webix.UploadDriver={flash:{$render:function(e){window.swfobject||webix.require("legacy/swfobject.js",!0);var t=this._settings;t.swfId=t.swfId||"webix_swf_"+webix.uid(),this._getBox().innerHTML+="<div class='webix_upload_flash'><div id='"+t.swfId+"'></div></div>",this._upload_area=this._getBox().lastChild,swfobject.embedSWF(webix.codebase+"/legacy/uploader.swf",t.swfId,"100%","100%","9",null,{uploaderId:t.id,ID:t.swfId,enableLogs:t.enableLogs?"1":"",paramName:t.inputName,multiple:t.multiple?"Y":""},{wmode:"transparent"});swfobject.getFlashPlayerVersion();webix._event(this._viewobj,"click",webix.bind(function(){new Date-(this._upload_timer_click||0)>250&&this.fileDialog()},this)),this.files.attachEvent("onBeforeDelete",webix.bind(this._stop_file,this))},$applyFlash:function(e,t){return this[e].apply(this,t)},getSwfObject:function(){return swfobject.getObjectById(this._settings.swfId)},fileDialog:function(){this.getSwfObject()&&this.getSwfObject().showDialog()},send:function(e){if("function"==typeof e&&(this._last_assigned_upload_callback=e,e=0),!e){var t=this.files.data.order,i=!0;if(t.length)for(var n=0;n<t.length;n++)i=this.send(t[n])&&i;return void(i&&this._upload_complete())}var s=this.files.getItem(e);if("client"!==s.status)return!1;if(s.status="transfer",this.getSwfObject()){var r=this._get_active_url(s),a=webix.extend(s.formData||{},this._settings.formData||{});this.getSwfObject().upload(e,r,a)}return!0},$beforeAddFileToQueue:function(e,t,i){var n=t.split(".").pop(),s=this._format_size(i);return this.callEvent("onBeforeFileAdd",[{id:e,name:t,size:i,sizetext:s,type:n}])},$addFileToQueue:function(e,t,i){if(this.files.exists(e))return!1;this._settings.multiple||this.files.clearAll();var n=t.split(".").pop(),s=this._format_size(i),r={name:t,id:e,size:i,sizetext:s,type:n,status:"client"};this.files.add(r),this.callEvent("onAfterFileAdd",[r]),e&&this._settings.autosend&&this.send(e)},stopUpload:function(e){this._stop_file(e)},_stop_file:function(e){var t=this.files.getItem(e);"transfer"==t.status&&(this.getSwfObject().uploadStop(e),t.status="client")},$onUploadComplete:function(){this._settings.autosend&&this._upload_complete()},$onUploadSuccess:function(e,t,i){var n=this.files.getItem(e);n&&(n.status="server",n.progress=100,i.text&&"string"==typeof i.text&&(webix.DataDriver.json.toObject(i.text),webix.extend(n,i,!0)),this.callEvent("onFileUpload",[n,i]),this.callEvent("onChange",[]),this.files.updateItem(e))},$onUploadFail:function(e){var t=this.files.getItem(e);t.status="error",delete t.percent,this.files.updateItem(e),this.callEvent("onFileUploadError",[t,""])}},html5:{$render:function(e){if(this._upload_area)return void this._contentobj.firstChild.appendChild(this._upload_area);this.files.attachEvent("onBeforeDelete",this._stop_file);var t={type:"file",class:"webix_hidden_upload",tabindex:-1};this._settings.accept&&(t.accept=this._settings.accept),this._settings.multiple&&(t.multiple="true"),this._settings.directory&&(t.webkitdirectory="true",t.mozdirectory="true",t.directory="true");var i=webix.html.create("input",t);this._upload_area=this._contentobj.firstChild.appendChild(i),webix._event(this._viewobj,"drop",webix.bind(function(e){this._drop(e),webix.html.preventEvent(e)},this)),webix._event(i,"change",webix.bind(function(){if(this._add_files(i.files),webix.env.isIE){var e=document.createElement("form");e.appendChild(this._upload_area),e.reset(),this._contentobj.firstChild.appendChild(i)}else i.value=""},this)),webix._event(this._viewobj,"click",webix.bind(function(){new Date-(this._upload_timer_click||0)>250&&this.fileDialog()},this)),webix._event(this._viewobj,"dragenter",webix.html.preventEvent),webix._event(this._viewobj,"dragexit",webix.html.preventEvent),webix._event(this._viewobj,"dragover",webix.html.preventEvent)},_directoryEntry:function(e){return e.isDirectory},_directoryDrop:function(e,t,i){if(e.isFile)e.file(function(e){t.addFile(e,null,null,{name:i+"/"+e.name})});else if(e.isDirectory){var n=e.createReader();n.readEntries(function(n){for(var s=0;s<n.length;s++)t._directoryDrop(n[s],t,(i?i+"/":"")+e.name)})}},_drop:function(e){var t=e.dataTransfer.files,i=e.dataTransfer.items;if(this.callEvent("onBeforeFileDrop",[t,e]))for(var n=0;n<i.length;n++){var s=i[n];this._settings.directory&&s.webkitGetAsEntry&&(s=s.webkitGetAsEntry(),s.isDirectory)?this._directoryDrop(s,this,""):this.addFile(t[n])}this.callEvent("onAfterFileDrop",[t,e])},fileDialog:function(e){this._upload_timer_click=new Date,this._last_file_context=e;var t=this._viewobj.getElementsByTagName("INPUT");t[t.length-1].click()},send:function(e){if("function"==typeof e&&(this._last_assigned_upload_callback=e,e=0),!e){var t=this.files.data.order,i=!0;if(t.length)for(var n=0;n<t.length;n++)i=!this.send(t[n])&&i;return void(i&&this._upload_complete())}var s=this.files.getItem(e);if("client"!==s.status)return!1;webix.assert(this._settings.upload,"You need to define upload url for uploader component"),s.status="transfer";var r=new FormData;if(s.folder)for(var n=0;n<s.folder.length;n++)r.append(this.config.inputName+n,s.folder[n],s.folder[n].webkitRelativePath);else r.append(this.config.inputName,s.file,s.name),this._settings.directory&&r.append(this.config.inputName+"_fullpath",s.name);var a={},o=webix.extend(s.formData||{},this._settings.formData||{}),l=new XMLHttpRequest,h=this._get_active_url(s);if(webix.callEvent("onBeforeAjax",["POST",h,o,l,a,r])){for(var c in o)r.append(c,o[c]);s.xhr=l,l.upload.addEventListener("progress",webix.bind(function(t){this.$updateProgress(e,t.loaded/t.total*100)},this),!1),l.onload=webix.bind(function(t){l.aborted||this._file_complete(e)},this),l.open("POST",h,!0);for(var c in a)l.setRequestHeader(c,a[c]);l.send(r)}return this.$updateProgress(e,0),!0},_file_complete:function(e){var t=this.files.getItem(e);if(t){var i=null;t.xhr.status<400&&(i=webix.DataDriver[this._settings.datatype||"json"].toObject(t.xhr.responseText)),i&&"error"!=i.status?this._complete(e,i):(t.status="error",delete t.percent,this.files.updateItem(e),this.callEvent("onFileUploadError",[t,i])),delete t.xhr}},stopUpload:function(e){webix.bind(this._stop_file,this.files)(e)},_stop_file:function(e){var t=this.getItem(e);void 0!==t.xhr&&(t.xhr.aborted=!0,t.xhr.abort(),delete t.xhr,t.status="client")}}},webix.html.addMeta=function(e,t){document.getElementsByTagName("head").item(0).appendChild(webix.html.create("meta",{name:e,content:t}))},function(){var e=function(){var e=!!(window.orientation%180);webix.ui.orientation!==e&&(webix.ui.orientation=e,webix.callEvent("onRotate",[e]))};webix.env.touch&&(webix.ui.orientation=!!((webix.isUndefined(window.orientation)?90:window.orientation)%180),webix.event(window,"onorientationchange"in window?"orientationchange":"resize",e)),webix.env.isFF&&window.matchMedia&&(window.matchMedia("(orientation: portrait)").addListener(function(){webix.ui.orientation=!1}),window.matchMedia("(orientation: landscape)").addListener(function(){webix.ui.orientation=!0})),webix.ui.fullScreen=function(){if(webix.env.touch){webix.html.addMeta("apple-mobile-web-app-capable","yes"),webix.html.addMeta("viewport","initial-scale=1, maximum-scale=1, user-scalable=no");var t=document.body.offsetHeight||document.body.scrollHeight,i=-1!=navigator.userAgent.indexOf("iPhone"),n=(navigator.userAgent.indexOf("iPad"),navigator.userAgent.match(/iPhone OS (\d+)/)),s=n&&n[1]>=7,r=i&&(356==t||208==t||306==t||158==t||444==t),a=568==window.screen.height,o=function(){var e=0,t=0;if(i&&!s)webix.ui.orientation?(e=a?568:480,t=r?268:300):(e=320,t=a?r?504:548:r?416:460);else if(webix.env.isAndroid){if(!webix.env.isFF){document.body.style.width=document.body.style.height="1px",document.body.style.overflow="hidden";var n=window.outerWidth/window.innerWidth;e=window.outerWidth/n,t=window.outerHeight/n}}else webix.env.isIEMobile||(e=window.innerWidth,t=window.innerHeight);t&&(document.body.style.height=t+"px",document.body.style.width=e+"px"),webix.ui.$freeze=!1,webix.ui.resize()},l=function(){webix.ui.$freeze=!0,webix.env.isSafari?o():webix.delay(o,null,[],500)};webix.attachEvent("onRotate",l),e(),webix.delay(l)}}}(),webix.ActiveContent={$init:function(e){if(e.activeContent){this.$ready.push(this._init_active_content_list),this._active_holders={},this._active_holders_item={},this._active_holders_values={},this._active_references={};for(var t in e.activeContent)if(this[t]=this._bind_active_content(t),e.activeContent[t].earlyInit){var i=webix._parent_cell;webix._parent_cell=null,this[t].call(this,{},this,e.activeContent),webix._parent_cell=i}}},_destructActiveContent:function(){for(var e in this._active_references){var t=this._active_references[e];t.destructor&&t.destructor()}},_init_active_content_list:function(){if(this.attachEvent("onDestruct",webix.bind(this._destructActiveContent,this)),webix._event(this.$view,"blur",function(e){if("BUTTON"!=(e.target||e.srcElement).tagName){var t=webix.$$(e);if(t&&t!==this&&t.getValue&&t.setValue){t.getNode(e);var i=t.getValue();i!=t._settings.value&&t.setValue(i)}}},{bind:this,capture:!0}),this.filter){for(var e in this._settings.activeContent)this.type[e]=this[e],this[e]=this._locate_active_content_by_id(e);this.attachEvent("onBeforeRender",function(){this.type.masterUI=this}),this.type.masterUI=this}},_locate_active_content_by_id:function(e){return function(t){for(var i=this._active_references[e],n=i._settings.id,s=this.getItemNode(t).getElementsByTagName("DIV"),r=0;r<s.length;r++)if(s[r].getAttribute("view_id")==n){i._viewobj=i._dataobj=s[r];break}return i}},_get_active_node:function(e,t,i){return function(n){if(n)for(var s=n.target||n.srcElement;s;){if(s.getAttribute&&s.getAttribute("view_id")){if(i._setActiveContentView(e,s),i.locate){var r=i.locate(s.parentNode),a=i._active_holders_values[t][r];e._settings.value=a,e._settings.$masterId=r}return s}s=s.parentNode}return e._viewobj}},_set_new_active_value:function(e,t){return function(i){var n=t.data;if(t.filter){var s=t.locate(this._viewobj.parentNode);n=t.getItem(s),this.refresh(),t._active_holders_item[e][s]=this._viewobj.outerHTML||(new XMLSerializer).serializeToString(this._viewobj),t._active_holders_values[e][s]=i}n&&(n[e]=i)}},_bind_active_content:function(e){return function(t,i,n){var s=i._active_holders?i:i.masterUI;if(!s._active_holders[e]){var r=document.createElement("DIV");n=n||s._settings.activeContent;var a=webix.ui(n[e],r);r.firstChild.setAttribute("onclick","event.processed = true; if (webix.env.isIE8) event.srcElement.w_view = '"+a._settings.id+"';"),a.getNode=s._get_active_node(a,e,s),a.attachEvent("onChange",s._set_new_active_value(e,s)),s._active_references[e]=a,s._active_holders[e]=r.innerHTML,s._active_holders_item[e]={},s._active_holders_values[e]={},a.$activeEl=a.$view}if(s.filter&&t[e]!=s._active_holders_values[e]&&!webix.isUndefined(t[e])){var a=s._active_references[e];a.blockEvent(),s._setActiveContentView(a,a.$activeEl),a.$view.firstChild||a.refresh(),a.setValue(t[e]),a.refresh(),a.unblockEvent(),s._active_holders_values[e][t.id]=t[e],s._active_holders_item[e][t.id]=a._viewobj.outerHTML||(new XMLSerializer).serializeToString(a._viewobj)}return s._active_holders_item[e][t.id]||s._active_holders[e]}},_setActiveContentView:function(e,t){e._dataobj=e._viewobj=e.$view=t}},webix.ProgressBar={$init:function(){webix.isUndefined(this._progress)&&this.attachEvent&&(this.attachEvent("onBeforeLoad",this.showProgress),this.attachEvent("onAfterLoad",this.hideProgress),this._progress=null)},showProgress:function(e){if(!this._progress){e=webix.extend({position:0,delay:2e3,type:"icon",icon:"refresh",hide:!1},e||{},!0);var t="icon"==e.type?"fa-"+e.icon+" fa-spin":"";if(this._progress=webix.html.create("DIV",{class:"webix_progress_"+e.type,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100",tabindex:"0"},"<div class='webix_progress_state "+t+"'></div>"),this.setPosition||(this._viewobj.style.position="relative"),webix.html.insertBefore(this._progress,this._viewobj.firstChild,this._viewobj),this._viewobj.setAttribute("aria-busy","true"),!webix.Touch.$active&&this.getScrollState){var i=this.getScrollState();this._viewobj.scrollWidth!=this.$width&&(this._progress.style.left=i.x+"px"),this._viewobj.scrollHeight!=this.$height&&("bottom"!=e.type?this._progress.style.top=i.y+"px":this._progress.style.top=i.y+this.$height-this._progress.offsetHeight+"px")}this._progress_delay=1}e&&"icon"!=e.type?webix.delay(function(){if(this._progress){var t=e.position||1;if(this._progress.style[webix.env.transitionDuration]===webix.undefined&&e.delay){var i=0,n=0,s=t/e.delay*30,r=this;this._progressTimer&&(window.clearInterval(this._progressTimer),n=this._progress.firstChild.offsetWidth/this._progress.offsetWidth*100),this._progressTimer=window.setInterval(function(){30*i==e.delay?window.clearInterval(r._progressTimer):(r._progress&&r._progress.firstChild&&(r._progress.firstChild.style.width=n+i*s*t*100+"%"),i++)},30)}else this._progress.firstChild.style.width=100*t+"%",e.delay&&(this._progress.firstChild.style[webix.env.transitionDuration]=e.delay+"ms");e.hide&&webix.delay(this.hideProgress,this,[1],e.delay)}this._progress_delay=0},this):e&&"icon"==e.type&&e.hide&&webix.delay(this.hideProgress,this,[1],e.delay)},hideProgress:function(e){this._progress_delay&&(e=!0),this._progress&&(e?(this._progressTimer&&window.clearInterval(this._progressTimer),webix.html.remove(this._progress),this._progress=null,this._viewobj.removeAttribute("aria-busy")):this.showProgress({position:1.1,delay:300,hide:!0}))}},webix.UIManager.getState=function(e,t){t=t||!1,e=webix.$$(e);var i={id:e.config.id,width:e.config.width,height:e.config.height,gravity:e.config.gravity};if(webix.isUndefined(e.config.collapsed)||(i.collapsed=e.config.collapsed),"tabs"!==e.name&&"tabbar"!==e.name||(i.activeCell=e.getValue()),t&&(i=[i],e._cells))for(var n=0;n<e._cells.length;n++)i=i.concat(this.getState(e._cells[n],t));return i},webix.UIManager.setState=function(e){webix.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[t],n=webix.$$(i.id);n&&(webix.isUndefined(i.collapsed)||n.define("collapsed",i.collapsed),webix.isUndefined(i.activeCell)||n.setValue(i.activeCell),n.define("width",i.width),n.define("height",i.height),n.define("gravity",i.gravity))}var s=webix.$$(e[0].id);s&&s.resize()},webix.DataDriver.excel=webix.extend({toObject:function(e){if(!e.excel){var t=e.options||{};t.dataurl&&webix.extend(t,this._urlToOptions(t.dataurl)),e=e.data||e;var i=webix.promise.defer();if(e.name){t.ext=e.name.split(".").pop();var n=new FileReader;n.onload=webix.bind(function(e){i.resolve(this.parseData(e.target.result,t))},this),n.readAsArrayBuffer(e)}else i.resolve(this.parseData(e,t));return i}return e},parseData:function(e,t){e=new Uint8Array(e);for(var i=[],n=0;n!=e.length;++n)i[n]=String.fromCharCode(e[n]);var s=(t.ext||t).toLowerCase();return"xls"!=s&&(s="xlsx"),webix.require(webix.cdn+"/extras/"+s+".core.min.js").then(webix.bind(function(){var e="xls"==s?XLS.read(i.join(""),{type:"binary"}):XLSX.read(i.join(""),{type:"binary"}),n={sheets:e.Sheets,names:e.SheetNames,options:t};return webix.extend(this.getSheet(n,t),n)},this))},getSheet:function(e,t){var i=t.name||e.names[0];return e=this.sheetToArray(e.sheets[i],t),t.rows&&t.rows.length&&(e.data=e.data.splice(t.rows[0],Math.min(t.rows[1],e.data.length)-t.rows[0])),e},sheetToArray:function(e,t){var i=[],n=[];if(e["!ref"]){var s,r,a,o,l=XLS.utils.decode_range(e["!ref"]);for(s=l.s.r;s<=l.e.r;s++){var h=[];for(r=l.s.c;r<=l.e.c;r++)if(a=XLS.utils.encode_cell({r:s,c:r}),o=e[a]){var c="";c=t.math&&o.f?"="==o.f.charAt(0)?o.f:"="+o.f:"n"==o.t&&o.w&&o.v!=o.w?o.w:o.v,h.push(c)}else h.push("");i.push(h)}}if(e["!merges"])for(var d=e["!merges"],u=0;u<d.length;u++){var _=d[u].s,f=d[u].e,b=t.rows?t.rows[0]:0;n.push([_.r+b,_.c,f.c-_.c+1,f.r-_.r+1])}return{data:i,spans:n,excel:!0}},_urlToOptions:function(e){var t=e.split("["),i={};if(i.name=t[0],t[1]){var n=t[1].split(/[^0-9]+/g);n[0]=1*n[0]||0,n[1]=n[1]||9999999,i.rows=n}return i}},webix.DataDriver.jsarray),webix});